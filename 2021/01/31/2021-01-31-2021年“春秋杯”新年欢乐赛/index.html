<!DOCTYPE html>
<html>
<head hexo-theme='https://volantis.js.org/#blog'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
    <title>2021年“春秋杯”新年欢乐赛 - My Tiny Ideas</title>
  
  
    <meta name="description" content="这次的赛制是第一次见到的沙漏赛制，对我这种不急不忙佛系做题的不是很友好，最后的名次也还行，前排观赏前面的神仙打架">
  

  <!-- feed -->
  

  <!-- import meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13/css/all.min.css">
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  
  <link rel="shortcut icon" type='image/x-icon' href="https://cdn.jsdelivr.net/gh/xaoxuu/assets@master/favicon/favicon.ico">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
  

  

  <!-- import link -->
  

  
    
      
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.18.1/styles/solarized-light.css">

    
  
  
    
<link rel="stylesheet" href="/css/style.css">

  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128484503-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-128484503-1');
    </script>
  
  
</head>

<body>
  
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<header class="l_header shadow blur">
  <div class='container'>
  <div class='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h'>
        <li><a class="s-comment fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a class="s-toc fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
          
          
          
            RYCBAR'S <b><sup style='color:#3AA757'>blog</sup></b>
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h'>
          
          
          
            
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>

			<ul class='switcher nav-list-h'>
				
					<li><a class="s-search fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li>
          <a class="s-menu fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>
		</div>
	</div>
  </div>
</header>

<script>setLoadingBarProgress(40);</script>



  <div class="l_body nocover">
    <div class='body-wrapper'>
      

<div class='l_main'>
  

  
    <article id="post" class="post white-box reveal shadow article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h1 class="title">
    <a href="/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/">
      2021年“春秋杯”新年欢乐赛
    </a>
  </h1>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a href="" rel="nofollow">
    <img src="">
    <p></p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/ctf/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>ctf</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2021年1月31日</p>
  </a>
</div>

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <p>这次的赛制是第一次见到的沙漏赛制，对我这种不急不忙佛系做题的不是很友好，最后的名次也还行，前排观赏前面的神仙打架<br><img src="/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/2769833766.png" alt="result2.png"></p>
<span id="more"></span>
<h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p>程序是python打包出来的，解包找到主程序checkin，补上pyc头文件，反编译得到python代码</p>
<pre><code class="python">import cv2, re, sys
from aip import AipOcr
from apii import APP_ID, API_KEY, SECRECT_KEY, flag
client = AipOcr(APP_ID, API_KEY, SECRECT_KEY)
cap = cv2.VideoCapture(0)
i = 0
x = 1
print(&#39;\n⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀\n⠀⠀⠀⠀⠀⠀⣀⣄⣀⢀⣀⣀⡀⠀⠀⠀⢀⣄⣀⣀⣀⣀⡀⠀⠀⠀⢠⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣀⣀⣀⡤⠀⠀⠀⠀⠀⠀⠀⠀\n⠀⠀⠀⠀⠀⢀⣹⣉⣝⢸⡇⠀⠀⠀⠀⢀⡞⠉⠉⣹⠉⠉⠁⠀⠀⢠⢼⢦⠐⢺⠓⢲⠀⠀⠀⠀⣾⠀⠀⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀\n⠀⠀⠀⠀⠀⠀⡤⣤⠤⢸⡏⢹⠉⠀⠀⠀⢸⡏⠉⢹⠉⠉⠁⠀⠀⠘⢸⠠⠤⢼⡤⠼⠤⠀⠀⠀⠛⡒⠒⡗⢒⠒⠂⠀⠀⠀⠀⠀⠀⠀\n⠀⠀⠀⠀⠀⢀⠇⠀⠰⣸⠀⢸⠀⠀⠀⠈⠉⠉⠉⢻⠉⠉⠉⠀⠀⠀⢸⠀⣠⠏⠱⣄⠀⠀⠀⢀⡴⠁⠀⡇⠈⠳⡄⠀⠀⠀⠀⠀⠀⠀\n⠀⠀⠀⠀⠀⠀⠉⠁⠀⠁⠀⠘⠀⠀⠀⠀⠀⠀⠀⠘⠀⠀⠀⠀⠀⠀⠘⠘⠁⠀⠀⠈⠃⠀⠀⠈⠀⠈⠉⠁⠀⠀⠀⠀⠀\n&#39;)
while True:
    ret, frame = cap.read()
    cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)
    cv2.imshow(&#39;capture&#39;, frame)
    cv2.imwrite(&#39;.\\i&#39; + str(i) + &#39;.png&#39;, frame)
    i = i + 1
    if i - 1 &gt; x:
        z = open(&#39;.\\i&#39; + str(x) + &#39;.png&#39;, &#39;rb&#39;)
        img = z.read()
        message = client.basicGeneral(img)
        for j in message.get(&#39;words_result&#39;):
            words = message[&#39;words_result&#39;]
            num_list = []
            for s in words:
                num_list.append(s[&#39;words&#39;])
                final = num_list
                final = &#39;&#39;.join(final)
                if &#39;FUN&#39; in final:
                    print(flag)
                    f = open(&#39;flag.txt&#39;, &#39;w&#39;, encoding=&#39;utf-8&#39;)
                    f.write(flag)
                    f.close()
                    sys.exit(0)
                else:
                    print(&#39;识别失败&#39;)
                    sys.exit(0)

        else:
            x = x + 1

    if cv2.waitKey(1) &amp; 255 == ord(&#39;q&#39;):
        break

cap.release()
cv2.destroyAllWindows()
</code></pre>
<p>看了一下代码，有OCR，发现真的和题目描述一样对着电脑摄像头扫“FUN”就可以了，然后放弃继续逆向写了个大大的FUN扫出来得到flag<code>flag&#123;ju5t_f0r_FUN&#125;</code></p>
<h2 id="evilMem"><a href="#evilMem" class="headerlink" title="evilMem"></a>evilMem</h2><p>拿到vmem文件先用volatility查一下imageinfo</p>
<p><img src="/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/3172205591.png" alt="evilMem-1.png"></p>
<p>Win7SP1x86</p>
<p>然后查一下进程列表</p>
<pre><code class="bash">vol.py -f image.vmem --profile=Win7SP1x86 pslist
</code></pre>
<p>发现进程</p>
<pre><code class="bash">0x858e1030 EvilImage.exe          1884   3516      1        7      1      0 2021-01-17 16:33:41 UTC+0000
</code></pre>
<p>把进程内存dump出来</p>
<pre><code class="bash">vol.py -f image.vmem --profile=Win7SP1x86 memdump -p 1884 -D evilimage/
</code></pre>
<p>dump出来的内存用foremost恢复一下，恢复出来的文件太多，大多是系统进程，没什么太大的研究价值，根据时间找到两个可疑文件</p>
<pre><code>28:    00000608.exe           16 KB          311296      01/17/2021 16:28:19
29:    00000672.dll           13 KB          344064      01/17/2021 16:28:19
</code></pre>
<p>修复一下程序segment的raw offset，反编译一下，发现exe文件时主程序EvilImage.exe，dll文件是调用的evil.dll</p>
<p><img src="/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/1172812708.png" alt="evilMem-2.png"></p>
<p>没有修复IAT，但是并不影响理解程序，这里没有太多的内容，只是调用一下Evil.dll里面的checkflag函数判断一下输入的flag是否正确就可以了</p>
<p><img src="/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/4170854745.png" alt="evilMem-3.png"></p>
<p>加密过程中出现了很明显的特征“expand 32-byte k”，很容易判断出来是chacha20，v8-v14进行密钥初始化，iv经过if判断条件的计算也可以很轻松地算出来，最后的加密结果也在内存中可以直接读取，解这个密码没有什么难度</p>
<pre><code class="python">import binascii
from Crypto.Cipher import ChaCha20
import struct

keys = [0xAA0F37A3, 0x214FF178, 0x6FF0CC56, 0x4B65E511, 0x2F60906D, 0xCA638692, 0xA001E464, 0x2BE81780]
key = b&#39;&#39;
for i in keys:
    key += struct.pack(&#39;&lt;I&#39;, i)
secret = key

iv = struct.pack(&#39;&lt;I&#39;, 0x6E7568D7 - 0x74) + struct.pack(&#39;&lt;I&#39;, (0x217569D6 - 0x65))
print(iv)

msg = &#39;EE2AC08F12AF33C5D1133E75C88AADBC3D0200246522037E72623311FC838FB6&#39;
msg = binascii.unhexlify(msg)
msg_nonce = iv
ciphertext = msg
cipher = ChaCha20.new(key=secret, nonce=msg_nonce)
plaintext = cipher.decrypt(ciphertext)
print(plaintext)

# b&#39;chunqiu!&#39;
# b&#39;flag&#123;R3im@aging_1ndir3ctly_LoL&#125;\x00&#39;
</code></pre>
<h2 id="十二宫的挑衅"><a href="#十二宫的挑衅" class="headerlink" title="十二宫的挑衅"></a>十二宫的挑衅</h2><p>密码本身有点难度，但是因为和zodiac密码的解码方法完全相同，所以只要照着步骤做就很容易解出来</p>
<p>先对密文进行一个简单的换位</p>
<pre><code class="python">s = &#39;&#39;&#39;^#@$@#()/&gt;@?==%1(
!)&gt;(*+3&lt;#86@-7$^.
4&amp;)8%#5&amp;6!=%1#$-$
+5&amp;?#!.03!%=@=101
0?(*~#??.+)%&amp;.7^8
=1%*^=$5$7@@8&gt;&amp;*9
9@0185(+7)&lt;%3#@^4
&amp;@@&lt;.)$3*#%%&lt;&lt;*++
.@.?=~**+!==65^@&amp;&#39;&#39;&#39;
a = s.split(&#39;\n&#39;)
# print(a)
i = 0
j = 0
cc = []
for z in range(9 * 17):
    cc.append(a[j % 9][i % 17])
    if (z + 1) % 17 == 0:
        cc.append(&#39;\n&#39;)
    i += 2
    j += 1
print(&quot;&quot;.join(cc))
</code></pre>
<p>然后放到AZdecrypt里面跑一下就出来了</p>
<pre><code>IKILLED A LOT OF PEOPLE AND THE PEOPLE I 
KILLED WILL BECOME SLAVES TO SERVE ME THIS 
IS FLAG WUUHUU TAKE OFF I HOPE YOU CAN DECRYPT 
IT AS SOON AS POSSIBLE OR I WILL CONTINUE 
TO COMMIT THE CRIME
</code></pre>
<p><del>就是flag确实不太好认</del></p>
<h2 id="snowww"><a href="#snowww" class="headerlink" title="snowww"></a>snowww</h2><p>盲水印，binwalk跑出结果有一个matlab脚本，在<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/50735753/answer/122593277">这里</a>找到讲解和提取水印的脚本</p>
<pre><code class="matlab">clc;clear;close all;
alpha = 1;

im = double(imread(&#39;original.jpg&#39;))/255;
FA=fft2(im);
ori=double(imread(&#39;attack.jpg&#39;))/255;
FB=fft2(ori);
imsize = size(im);
load(&#39;encode.mat&#39;);
FAO=ifft2(FB);
RI = FAO-double(im);
xl = 1:imsize(2);
yl = 1:imsize(1);
[xx,yy] = meshgrid(xl,yl);

FA2=fft2(FAO);
G=(FA2-FA)/alpha;
GG=G;
for i=1:imsize(1)*0.5
    for j=1:imsize(2)
        GG(M(i),N(j),:)=G(i,j,:);
    end
end
for i=1:imsize(1)*0.5
    for j=1:imsize(2)
        GG(imsize(1)+1-i,imsize(2)+1-j,:)=GG(i,j,:);
    end
end
figure,imshow(GG);title(&#39;extracted watermark&#39;);
</code></pre>
<p>跑出结果</p>
<p><img src="/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/3133848147.png" alt="snow-1.png"></p>
<p><del>我当时以为这已经是对我眼睛最大的考验了</del></p>
<h2 id="SuperBrain"><a href="#SuperBrain" class="headerlink" title="SuperBrain"></a>SuperBrain</h2><p>似乎是一个开发板的程序，进行一系列初始化之后运行主程序</p>
<p><img src="/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/253024555.png" alt="superbrain-1.png"></p>
<p>首先会进行通信，接收地图数据和答案数据</p>
<p><img src="/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/3289130296.png" alt="superbrain-2.png"></p>
<p><img src="/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/3801641259.png" alt="superbrain-3.png"></p>
<p>可以看到一共接收了36组地图和36个答案，然后执行程序判断答案是否正确</p>
<p><img src="/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/1411425325.png" alt="superbrain-4.png"></p>
<p>每次执行传入一个地图和对应的答案</p>
<p>执行的程序主要算法如下</p>
<pre><code class="cpp">answer = (char)answer;
LABEL_10:
  line = &amp;map[7 * answer + 1];
  while ( index &lt; 7 &amp;&amp; answer &gt;= 0 &amp;&amp; answer &lt; 7 )
  &#123;
    addr = &amp;line[index];
    ele = line[index];
    if ( answer % 2 )
    &#123;
      if ( line[index] )
      &#123;
        if ( ele == 1 )
        &#123;
          *addr = 0;
          v8 = 0;
          --answer;
          goto LABEL_10;
        &#125;
        if ( ele != 2 )
        &#123;
          if ( ele != 3 )
            return v8 == 1;
          *addr = 2;
          v8 = 2;
          ++answer;
          goto LABEL_10;
        &#125;
        *addr = 1;
        v8 = 1;
        if ( ++index &gt;= 0 )
          goto LABEL_10;
      &#125;
      else
      &#123;
        *addr = 3;
        v8 = 3;
        if ( --index &gt;= 0 )
          goto LABEL_10;
      &#125;
      return v8 == 1;
    &#125;
    if ( line[index] )
    &#123;
      if ( ele == 1 )
      &#123;
        *addr = 2;
        v8 = 2;
        ++answer;
        goto LABEL_10;
      &#125;
      if ( ele != 2 )
      &#123;
        if ( ele != 3 )
          return v8 == 1;
        *addr = 0;
        v8 = 0;
        --answer;
        goto LABEL_10;
      &#125;
      *addr = 3;
      v8 = 3;
      if ( --index &gt;= 0 )
        goto LABEL_10;
      return v8 == 1;
    &#125;
    *addr = 1;
    v8 = 1;
    if ( ++index &lt; 0 )
      return v8 == 1;
  &#125;
  return v8 == 1;
</code></pre>
<p>可以看到类似于走迷宫的算法，分奇偶行执行不同的操作，然后发现答案只传入0-6这7种数字，直接遍历就可以跑出答案</p>
<p>最后一部分输出flag，需要一些数据在内存里都找的到</p>
<p><img src="/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/1235013662.png" alt="superbrain-5.png"></p>
<p>很容易可以解出来</p>
<pre><code class="cpp">#include &lt;iostream&gt;

int runGame(char (*gamemap)[7], uint8_t startPoint) &#123;
    char answer; // r18
    int v8; // r17
    int v9; // r6
    int index; // r19
    char *v11; // r5
    char *v12; // r4
    char *v13; // r4
    char *v14; // r5
    char *line; // r20
    char *addr; // r3
    int ele; // r6
    char map[61]; // [sp+7h] [-79h] BYREF
    index = 0;
    answer = startPoint;
    v8 = -1;
    v9 = 0;
    do &#123;
        v11 = &amp;map[7 * v9];
        v12 = &amp;(*gamemap)[7 * v9 - 1];
        do &#123;
            *++v11 = *++v12;
            ++index;
        &#125; while (((index - 7) &amp; 1) != 0);
        for (; index &lt; 7; index += 2) &#123;
            v13 = v12 + 1;
            v14 = v11 + 1;
            *v14 = *v13;
            v12 = v13 + 1;
            v11 = v14 + 1;
            *v11 = *v12;
        &#125;
        ++v9;
        index = 0;
    &#125; while (v9 &lt; 7);
    answer = (char) answer;
    LABEL_10:
    line = &amp;map[7 * answer + 1];
    while (index &lt; 7 &amp;&amp; answer &gt;= 0 &amp;&amp; answer &lt; 7) &#123;
        addr = &amp;line[index];
        ele = line[index];
        if (answer % 2) &#123;
            if (line[index]) &#123;
                if (ele == 1) &#123;
                    *addr = 0;
                    v8 = 0;
                    --answer;
                    goto LABEL_10;
                &#125;
                if (ele != 2) &#123;
                    if (ele != 3)
                        return v8 == 1;
                    *addr = 2;
                    v8 = 2;
                    ++answer;
                    goto LABEL_10;
                &#125;
                *addr = 1;
                v8 = 1;
                if (++index &gt;= 0)
                    goto LABEL_10;
            &#125; else &#123;
                *addr = 3;
                v8 = 3;
                if (--index &gt;= 0)
                    goto LABEL_10;
            &#125;
            return v8 == 1;
        &#125;
        if (line[index]) &#123;
            if (ele == 1) &#123;
                *addr = 2;
                v8 = 2;
                ++answer;
                goto LABEL_10;
            &#125;
            if (ele != 2) &#123;
                if (ele != 3)
                    return v8 == 1;
                *addr = 0;
                v8 = 0;
                --answer;
                goto LABEL_10;
            &#125;
            *addr = 3;
            v8 = 3;
            if (--index &gt;= 0)
                goto LABEL_10;
            return v8 == 1;
        &#125;
        *addr = 1;
        v8 = 1;
        if (++index &lt; 0)
            return v8 == 1;
    &#125;
    return v8 == 1;
&#125;


int main() &#123;
    char gameMap[36][11][7] = &#123;&#123;
                                      &#123;1, 0, 0, 0, 0, 0, 0,&#125;,
                                      &#123;3, 0, 2, 2, 3, 1, 3,&#125;,
                                      &#123;1, 3, 2, 1, 2, 2, 1,&#125;,
                                      &#123;3, 2, 3, 1, 0, 1, 0,&#125;,
                                      &#123;3, 3, 0, 1, 2, 1, 0,&#125;,
                                      &#123;0, 3, 2, 2, 2, 1, 3,&#125;,
                                      &#123;2, 2, 2, 2, 1, 2, 3,&#125;,
                              &#125;,
                              &#123;
                                      &#123;0, 0, 0, 0, 0, 1, 0,&#125;,
                                      &#123;0, 2, 2, 2, 1, 1, 1,&#125;,
                                      &#123;0, 2, 3, 2, 2, 0, 1,&#125;,
                                      &#123;0, 3, 1, 0, 2, 0, 1,&#125;,
                                      &#123;0, 0, 2, 1, 3, 1, 1,&#125;,
                                      &#123;3, 0, 1, 2, 2, 0, 2,&#125;,
                                      &#123;3, 3, 3, 0, 2, 3, 3,&#125;,
                              &#125;,
                              ……………………………………
                              &#123;
                                      &#123;3, 3, 1, 3, 3, 0, 2,&#125;,
                                      &#123;1, 2, 1, 3, 0, 2, 3,&#125;,
                                      &#123;0, 1, 2, 3, 1, 1, 2,&#125;,
                                      &#123;2, 1, 0, 3, 0, 2, 1,&#125;,
                                      &#123;3, 3, 0, 2, 3, 1, 2,&#125;,
                                      &#123;2, 2, 3, 3, 2, 3, 1,&#125;,
                                      &#123;3, 2, 2, 3, 0, 2, 3,&#125;,
                              &#125;,
                              &#123;
                                      &#123;1, 0, 2, 0, 2, 3, 0,&#125;,
                                      &#123;2, 1, 3, 0, 0, 3, 0,&#125;,
                                      &#123;2, 3, 0, 0, 1, 2, 0,&#125;,
                                      &#123;3, 3, 0, 2, 0, 1, 1,&#125;,
                                      &#123;3, 0, 3, 2, 1, 2, 0,&#125;,
                                      &#123;0, 3, 2, 1, 0, 2, 2,&#125;,
                                      &#123;2, 3, 2, 2, 2, 0, 1,&#125;,
                              &#125;,
    &#125;;
    int res[36];
    for (int i = 0; i &lt; 36; i++) &#123;
        for (int j = 0; j &lt; 7; j++) &#123;
            if (runGame(gameMap[i], j)) &#123;
                res[i] = j;
                break;
            &#125;
        &#125;
    &#125;

    std::string charDic = &quot;0123456789abcdef-&quot;;
    int base[] = &#123;0x17, 0x06, 0x0A, 0x20, 0x2D, 0x0B, 0x39, 0x01, 0x0A, 0x10,
                  0x5E, 0x01, 0x1A, 0x0F, 0x51, 0x59, 0x06, 0x1F, 0x0E, 0x09,
                  0x23, 0x47, 0x03, 0x0A, 0x38, 0x05, 0x48, 0x23, 0x02, 0x0A,
                  0x12, 0x33, 0x1D, 0x1F, 0x48, 0x15&#125;;

    std::cout &lt;&lt; &quot;flag&#123;&quot;;
    for (int i = 0; i &lt; 36; i++)
        std::cout &lt;&lt; charDic[(res[i] + base[i]) % 17];
    std::cout &lt;&lt; &quot;&#125;&quot; &lt;&lt; std::endl;
    return 0;
&#125;

//flag&#123;ace40f94-1b3d-d97f-f256-bb726e611fa7&#125;
</code></pre>
<h2 id="puzzle"><a href="#puzzle" class="headerlink" title="puzzle"></a>puzzle</h2><p>每个碎片都加了噪声，还有很多碎片有很大部分重复内容，就算是拼出来图片也看不清楚是什么字符……</p>
<p>但是又太菜了写不出脚本识别，就只能手动拼图+ps识图</p>
<pre><code>flag&#123;w9w45my6x8kk4e8gp9nqm6j2c154wad49&#125;
</code></pre>
<h2 id="2019-nCoV"><a href="#2019-nCoV" class="headerlink" title="2019-nCoV"></a>2019-nCoV</h2><p>有三个文件，mp3，wav和一个压缩包，然后题目新增了一个hint，很容易看出来base32编码</p>
<pre><code>http://www.merrybio.com.cn/blog/SARS-CoV-2-genomic-analysis.html
https://www.ncbi.nlm.nih.gov/orffinder/
http://www.merrybio.com.cn/blog/coronavirus-introduction.html

Please notice The largest structural protein
the password is the md5(it&#39;s gene sequence) and do not let the ‘\n’ in md5()
</code></pre>
<p>给的文章有新冠病毒的介绍和基因查询页面，根据提示要算S蛋白质的基因序列的md5得到密码，这个密码是mp3隐写的密码，用MP3Stego解出来又一个密码“2019-nCoV”，试了一下是压缩包密码</p>
<pre><code class="python">m = hashlib.md5()
m.update(&quot;MFLLTTKRTMFVFLVLLPLVSSQCVNLTTRTQLPPAYTNSFTRGVYYPDKVFRSSVLHSTQDLFLPFFSNVTWFHAIHVSGTNGTKRFDNPVLPFNDGVYFASTEKSNIIRGWIFGTTLDSKTQSLLIVNNATNVVIKVCEFQFCNDPFLGVYYHKNNKSWMESEFRVYSSANNCTFEYVSQPFLMDLEGKQGNFKNLREFVFKNIDGYFKIYSKHTPINLVRDLPQGFSALEPLVDLPIGINITRFQTLLALHRSYLTPGDSSSGWTAGAAAYYVGYLQPRTFLLKYNENGTITDAVDCALDPLSETKCTLKSFTVEKGIYQTSNFRVQPTESIVRFPNITNLCPFGEVFNATRFASVYAWNRKRISNCVADYSVLYNSASFSTFKCYGVSPTKLNDLCFTNVYADSFVIRGDEVRQIAPGQTGKIADYNYKLPDDFTGCVIAWNSNNLDSKVGGNYNYLYRLFRKSNLKPFERDISTEIYQAGSTPCNGVEGFNCYFPLQSYGFQPTNGVGYQPYRVVVLSFELLHAPATVCGPKKSTNLVKNKCVNFNFNGLTGTGVLTESNKKFLPFQQFGRDIADTTDAVRDPQTLEILDITPCSFGGVSVITPGTNTSNQVAVLYQDVNCTEVPVAIHADQLTPTWRVYSTGSNVFQTRAGCLIGAEHVNNSYECDIPIGAGICASYQTQTNSPRRARSVASQSIIAYTMSLGAENSVAYSNNSIAIPTNFTISVTTEILPVSMTKTSVDCTMYICGDSTECSNLLLQYGSFCTQLNRALTGIAVEQDKNTQEVFAQVKQIYKTPPIKDFGGFNFSQILPDPSKPSKRSFIEDLLFNKVTLADAGFIKQYGDCLGDIAARDLICAQKFNGLTVLPPLLTDEMIAQYTSALLAGTITSGWTFGAGAALQIPFAMQMAYRFNGIGVTQNVLYENQKLIANQFNSAIGKIQDSLSSTASALGKLQDVVNQNAQALNTLVKQLSSNFGAISSVLNDILSRLDKVEAEVQIDRLITGRLQSLQTYVTQQLIRAAEIRASANLAATKMSECVLGQSKRVDFCGKGYHLMSFPQSAPHGVVFLHVTYVPAQEKNFTTAPAICHDGKAHFPREGVFVSNGTHWFVTQRNFYEPQIITTDNTFVSGNCDVVIGIVNNTVYDPLQPELDSFKEELDKYFKNHTSPDVDLGDISGINASVVNIQKEIDRLNEVAKNLNESLIDLQELGKYEQYIKWPWYIWLGFIAGLIAIVMVTIMLCCMTSCCSCLKGCCSCGSCCKFDEDDSEPVLKGVKLHYT&quot;.encode())
print(m.hexdigest())
# 98eb1b1760bcc837934c8695a1cee923
</code></pre>
<p>wav是lsb隐写，直接用SilentEye解码得到一串没什么意义的字符“priebeijoarkjpxmdkucxwdus”</p>
<p>压缩包得到一张图片和hint2</p>
<p>hint2 16进制转ascii码得到第二个提示</p>
<pre><code>you must pay attention to N protein ,How do that get into the viral capsid?
do you know steghide?
the password is encrypt by VigenÃ¨re Cipher
the screct key is The top 20 characters with the most occurrences are counted+COMBAT&#39;
</code></pre>
<p>图片应该是用steghide做的隐写，隐写的密码是刚刚wav隐写得到的字符经过维吉尼亚密码解码之后的结果，但是维吉尼亚密码的密钥就跟第一句不明不白的话有关系，卡了很久，后来仔细看一下文章，有这么一句话</p>
<pre><code>核衣壳蛋白（nucleoprotein，N）位于囊膜内部，呈螺旋状，包裹着病毒单股正链的RNA基因组。病毒在进行装配时，N蛋白先和病毒RNA相互作用形成复合体形式，然后再结合M蛋白、E蛋白，最后被包装进入病毒衣壳内。
</code></pre>
<p>猜测是对N蛋白质、M蛋白质、E蛋白质的基因序列进行词频统计</p>
<pre><code class="python">dic = &#123;&#125;
N=&quot;MSDNGPQNQRNAPRITFGGPSDSTGSNQNGERSGARSKQRRPQGLPNNTASWFTALTQHGKEDLKFPRGQGVPINTNSSPDDQIGYYRRATRRIRGGDGKMKDLSPRWYFYYLGTGPEAGLPYGANKDGIIWVATEGALNTPKDHIGTRNPANNAAIVLQLPQGTTLPKGFYAEGSRGGSQASSRSSSRSRNSSRNSTPGSSRGTSPARMAGNGGDAALALLLLDRLNQLESKMSGKGQQQQGQTVTKKSAAEASKKPRQKRTATKAYNVTQAFGRRGPEQTQGNFGDQELIRQGTDYKHWPQIAQFAPSASAFFGMSRIGMEVTPSGTWLTYTGAIKLDDKDPNFKDQVILLNKHIDAYKTFPPTEPKKDKKKKADETQALPQRQKKQQTVTLLPAADLDDFSKQLQQSMSSADSTQAMFHLVDFQVTIAEILLIIMRTFKVSIWNLDYIINLIIKNLSKSLTENKYSQLDEEQPMEIDMADSNGTITVEELKKLLEQWNLVIGFLFLTWICLLQFAYANRNRFLYIIKLIFLWLLWPVTLACFVLAAVYRINWITGGIAIAMACLVGLMWLSYFIASFRLFARTRSMWSFNPETNILLNVPLHGTILTRPLLESELVIGAVILRGHLRIAGHHLGRCDIKDLPKEITVATSRTLSYYKLGASQRVAGDSGFAAYSRYRIGNYKLNTDHSSSSDNIALLVQ&quot;
for word in N:
    if word not in dic:
        dic[word] = 1
    else:
        dic[word] = dic[word] + 1

swd = sorted(dic.items(), key=lambda asd: asd[1], reverse=True)
print(swd)

# LGASTRIQKNDPFEVYMWHC
</code></pre>
<p>一共20个字符按照频次从高到低的顺序排列，在后面添加COMBAT得到密钥<code>LGASTRIQKNDPFEVYMWHCCOMBAT</code></p>
<p>解维吉尼亚密码得到隐写的密码<code>eliminatenovelcoronavirts</code></p>
<p>用steghide解出flag</p>
<pre><code>flag&#123;we_will_over_come_SARS-COV&#125;
</code></pre>

          
            <div class='article_footer'>
              
                
  
    
    



  

  
    
    



  

  
    
    

<section class="widget copyright  desktop mobile">
  <div class='content'>
    
      <blockquote>
        
          
            <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

          
        
          
            <p>本文永久链接是：<a href=http://blog.rycbar.club/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/>http://blog.rycbar.club/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/</a></p>
          
        
      </blockquote>
    
  </div>
</section>

  

  


              
            </div>
          
        </div>
        
          


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2021-03-09T11:47:45+08:00">
  <a class='notlink'>
    <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：2021年3月9日</p>
  </a>
</div>

        
      
        
          

        
      
        
          

        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.rycbar.club/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/&title=2021年“春秋杯”新年欢乐赛 - My Tiny Ideas&summary=这次的赛制是第一次见到的沙漏赛制，对我这种不急不忙佛系做题的不是很友好，最后的名次也还行，前排观赏前面的神仙打架"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://blog.rycbar.club/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/&title=2021年“春秋杯”新年欢乐赛 - My Tiny Ideas&summary=这次的赛制是第一次见到的沙漏赛制，对我这种不急不忙佛系做题的不是很友好，最后的名次也还行，前排观赏前面的神仙打架"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.rycbar.club/2021/01/31/2021-01-31-2021%E5%B9%B4%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/&title=2021年“春秋杯”新年欢乐赛 - My Tiny Ideas&summary=这次的赛制是第一次见到的沙漏赛制，对我这种不急不忙佛系做题的不是很友好，最后的名次也还行，前排观赏前面的神仙打架"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
          <div class="prev-next">
            
              <a class='prev' href='/2021/05/16/2021-05-16-2021_ciscn_Re%E9%83%A8%E5%88%86wp/'>
                <p class='title'><i class="fas fa-chevron-left" aria-hidden="true"></i>2021 ciscn Re部分wp</p>
                <p class='content'>2021 ciscn Re部分wp


glassjava层没什么多余的调用，直接native调用checkflag
bool __fastcall Java_com_ciscn_glass_M...</p>
              </a>
            
            
              <a class='next' href='/2020/10/24/2020-10-24-2020-%E5%85%A8%E5%9B%BD%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E6%8A%80%E6%9C%AF%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/'>
                <p class='title'>2020-全国工业互联网安全技术技能大赛<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
                <p class='content'>2020-全国工业互联网安全技术技能大赛


5G考查polar编码
sub_401FD0();
  v3 = time(0);
  srand(v3);
  memset(&amp;v32, ...</p>
              </a>
            
          </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  <article class="post white-box reveal comments shadow">
    <section class="article typo">
      <p ct><i class='fas fa-comments'></i> 评论</p>
      
      
      
      
        <section id="comments">
          <div id="gitalk-container"></div>
        </section>
      
      
      
      
    </section>
  </article>


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: '2021年“春秋杯”新年欢乐赛',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
  

  
    
    


  <section class="widget toc-wrapper shadow desktop mobile">
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-text">签到</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#evilMem"><span class="toc-text">evilMem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E5%AE%AB%E7%9A%84%E6%8C%91%E8%A1%85"><span class="toc-text">十二宫的挑衅</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#snowww"><span class="toc-text">snowww</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SuperBrain"><span class="toc-text">SuperBrain</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#puzzle"><span class="toc-text">puzzle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019-nCoV"><span class="toc-text">2019-nCoV</span></a></li></ol>
    </div>
  </section>


  


</aside>


  
  <footer class="clearfix">
    <br><br>
    
      
        <div class="aplayer-container">
          

  
    <meting-js
      theme='#1BCDFC'
      autoplay='false'
      volume='0.7'
      loop='all'
      order='random'
      fixed='false'
      list-max-height='340px'
      server='netease'
      type='playlist'
      id='555017395'
      list-folded='true'>
    </meting-js>
  


        </div>
      
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="/rycbar17th@gmail.com"
                class="social fas fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://github.com/schrodinger17"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://music.163.com/#/user/home?id=391265665"
                class="social fas fa-headphones-alt flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        <div class='copyright'>
        <p><a href="https://blog.rycbar.club/">Copyright © 2017-2020 rycbar</a></p>

        </div>
      
    
  </footer>

<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script>


  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>


  <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.6/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      ScrollReveal().reveal('.l_main .reveal', {
        distance: '8px',
        duration: '800',
        interval: '100',
        scale: '1'
      });
    });
  </script>


  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/BBC19066-E176-47C2-9D22-48C81EE5DF6B.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/35F12181-F0E9-45BD-B134-37E4B4A660CF.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/00E0F0ED-9F1C-407A-9AA6-545649D919F4.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/67239FBB-E15D-4F4F-8EE8-0F1C9F3C4E7C.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B951AE18-D431-417F-B3FE-A382403FF21B.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/AEB33F9D-7294-4CF1-B8C5-3020748A9D45.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/2884F904-F1F3-479E-AE27-5EBC291B63B0.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/10A0FCE5-36A1-4AD0-8CF0-019259A89E03.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/250662D4-5A21-4AAA-BB63-CD25CF97CFF1.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/298468D7-E388-44A8-8CC5-8213BDC33CED.jpeg"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('.cover') {
          $('.cover').backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        }
      });
    </script>
  



  
    
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>

  
    
<script src="https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js"></script>

  






  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
  <script type="text/javascript">
    var gitalk = new Gitalk({
      clientID: "6dbe0fb891585031b176",
      clientSecret: "4407fec5af8e37150b5a4cb82821318d91c07769",
      repo: "comments",
      owner: "schrodinger17",
      admin: "schrodinger17",
      
        id: location.pathname,      // Ensure uniqueness and length less than 50
      
      distractionFreeMode: false  // Facebook-like distraction free mode
    });
    gitalk.render('gitalk-container');
  </script>








  
<script src="/js/app.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.6.5/js/search.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script>




  
    
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
  



<!-- 复制 -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-check-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-check-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-times-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-times-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>




<!-- fancybox -->

  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("div.fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>






  <script>setLoadingBarProgress(100);</script>
</body>
</html>
