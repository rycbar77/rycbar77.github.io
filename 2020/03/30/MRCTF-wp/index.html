<!DOCTYPE html>
<html>
<head hexo-theme='https://volantis.js.org/#blog'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
    <title>MRCTF-wp - My Tiny Ideas</title>
  
    <meta name="keywords" content="ctf,writeup,MRCTF">
  
  
    <meta name="description" content="最近招新事情实在是有点多，这比赛只打了半天，做了几道re和简单的pwn，随便写一下">
  

  <!-- feed -->
  

  <!-- import meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13/css/all.min.css">
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  
  <link rel="shortcut icon" type='image/x-icon' href="https://cdn.jsdelivr.net/gh/xaoxuu/assets@master/favicon/favicon.ico">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
  

  

  <!-- import link -->
  

  
    
      
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.18.1/styles/solarized-light.css">

    
  
  
    
<link rel="stylesheet" href="/css/style.css">

  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128484503-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-128484503-1');
    </script>
  
  
</head>

<body>
  
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<header class="l_header shadow blur">
  <div class='container'>
  <div class='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h'>
        <li><a class="s-comment fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a class="s-toc fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
          
          
          
            RYCBAR'S <b><sup style='color:#3AA757'>blog</sup></b>
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h'>
          
          
          
            
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>

			<ul class='switcher nav-list-h'>
				
					<li><a class="s-search fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li>
          <a class="s-menu fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>
		</div>
	</div>
  </div>
</header>

<script>setLoadingBarProgress(40);</script>



  <div class="l_body nocover">
    <div class='body-wrapper'>
      

<div class='l_main'>
  

  
    <article id="post" class="post white-box reveal shadow article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h1 class="title">
    <a href="/2020/03/30/MRCTF-wp/">
      MRCTF-wp
    </a>
  </h1>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a href="http://blog.rycbar.club" rel="nofollow">
    <img src="https://q2.qlogo.cn/headimg_dl?dst_uin=595371936&spec=100">
    <p>rycbar</p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/ctf/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>ctf</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2020年3月30日</p>
  </a>
</div>

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <p>最近招新事情实在是有点多，这比赛只打了半天，做了几道re和简单的pwn，随便写一下</p>
<span id="more"></span>

<h3 id="re"><a href="#re" class="headerlink" title="re"></a>re</h3><h4 id="transform"><a href="#transform" class="headerlink" title="transform"></a>transform</h4><p>太简单了没什么好说的，直接上代码</p>
<pre><code class="c++">#include&lt;iostream&gt;
#include &quot;ida.h&quot;
using namespace std;

int main()
&#123;
    signed int dword_40F040[33] =
            &#123;
                    9,
                    10,
                    15,
                    23,
                    7,
                    24,
                    12,
                    6,
                    1,
                    16,
                    3,
                    17,
                    32,
                    29,
                    11,
                    30,
                    27,
                    22,
                    4,
                    13,
                    19,
                    20,
                    21,
                    2,
                    25,
                    5,
                    31,
                    8,
                    18,
                    26,
                    28,
                    14,
                    0
            &#125;;
    char target[33] =
            &#123;
                    103,
                    121,
                    123,
                    127,
                    117,
                    43,
                    60,
                    82,
                    83,
                    121,
                    87,
                    94,
                    93,
                    66,
                    123,
                    45,
                    42,
                    102,
                    66,
                    126,
                    76,
                    87,
                    121,
                    65,
                    107,
                    126,
                    101,
                    60,
                    92,
                    69,
                    111,
                    98,
                    77
            &#125;;
    char tmp[33];
    char flag[33];
    for(int i=0;i&lt;=32;i++)
    &#123;
        tmp[i]=target[i]^LOBYTE(dword_40F040[i]);
        flag[dword_40F040[i]]=tmp[i];
    &#125;
    cout&lt;&lt;flag&lt;&lt;endl;
    return 0;
&#125;
</code></pre>
<h4 id="撸啊撸"><a href="#撸啊撸" class="headerlink" title="撸啊撸"></a>撸啊撸</h4><p>简单的<code>lua</code>，用了<code>smc</code>，但是调试可以之间看到执行的代码，复制出来即可</p>
<pre><code class="lua">cmps=&#123;&#123;83,80,73,80,76,125,61,96,107,85,62,63,121,122,101,33,123,82,101,114,54,100,101,97,85,111,39,97&#125;&#125;
print(\&quot;Give Me Your Flag LOL!:\&quot;)
flag=io.read()
if string.len(flag)~=28 then
    print(\&quot;Wrong flag!\&quot;)
    os.exit()
end
for i=1,string.len(flag) do
    local x=string.byte(flag,i)
    if i%2==0 then
        x=x~i
    else
        x=x+6
    end
    if x~=cmps[i] then
        print(\&quot;Wrong flag!\&quot;)
        os.exit()
    end
end
print(\&quot;Right flag!\&quot;)
os.exit()
</code></pre>
<p>判断的逻辑也很简单，分奇偶进行不同的操作，用python跑一遍就可以出来flag</p>
<pre><code class="python">cmps = [83, 80, 73, 80, 76, 125, 61, 96, 107, 85, 62, 63, 121, 122, 101, 33, 123, 82, 101, 114, 54, 100, 101, 97, 85,
        111, 39, 97]
flag=&#39;&#39;
for i in range(28):
    x = cmps[i]
    if (i + 1) % 2 == 0:
        x ^= (i + 1)
    else:
        x -= 6
    flag+=chr(x)
print(flag)
</code></pre>
<h4 id="PixelShooter"><a href="#PixelShooter" class="headerlink" title="PixelShooter"></a>PixelShooter</h4><p>游戏我是一点都不会打，直接解包找到<code>dll</code>在字符串视图可以直接看到<code>flag</code></p>
<h4 id="hello-world-go"><a href="#hello-world-go" class="headerlink" title="hello_world_go"></a>hello_world_go</h4><p>乱七八糟看了就觉得头疼的<code>go</code></p>
<p>找到主函数</p>
<pre><code class="c++">__int64 __fastcall main_main(__int64 a1, __int64 a2)
&#123;
  __int64 v2; // r8
  __int64 v3; // r9
  __int64 v4; // r8
  __int64 v5; // r9
  __int64 v6; // rdx
  __int64 v7; // r8
  __int64 v8; // rcx
  __int64 v9; // rdx
  __int64 v10; // r9
  signed __int64 v11; // rax
  __int64 result; // rax
  __int64 v13; // ST58_8
  __int64 *v14; // [rsp+8h] [rbp-A8h]
  char v15; // [rsp+18h] [rbp-98h]
  __int64 *v16; // [rsp+60h] [rbp-50h]
  __int128 v17; // [rsp+68h] [rbp-48h]
  void *v18; // [rsp+78h] [rbp-38h]
  void **v19; // [rsp+80h] [rbp-30h]
  __int128 v20; // [rsp+88h] [rbp-28h]
  __int128 v21; // [rsp+98h] [rbp-18h]

  if ( (unsigned __int64)&amp;v19 &lt;= *(_QWORD *)(__readfsqword(0xFFFFFFF8) + 16) )
    runtime_morestack_noctxt();
  runtime_newobject(a1, a2);
  v16 = v14;
  *(_QWORD *)&amp;v21 = &amp;unk_4AC9C0;
  *((_QWORD *)&amp;v21 + 1) = &amp;off_4EA530;
  fmt_Fprint(a1, a2, (__int64)&amp;v21, (__int64)&amp;unk_4AC9C0, v2, v3, (__int64)&amp;off_4EBDA0, qword_577550);
  *(_QWORD *)&amp;v20 = &amp;unk_4A96A0;
  *((_QWORD *)&amp;v20 + 1) = v16;
  fmt_Fscanf(
    a1,
    a2,
    (__int64)&amp;off_4EBD80,
    (__int64)&amp;v20,
    v4,
    v5,
    (__int64)&amp;off_4EBD80,
    qword_577548,
    (__int64)&amp;unk_4D07C9,
    2LL);
  v8 = v16[1];
  if ( v8 != 24 )
    goto LABEL_3;
  v13 = *v16;
  runtime_memequal(a1, a2, v6, (unsigned __int64)&amp;unk_4D3C58);
  if ( !v15 )
  &#123;
    v8 = 24LL;
LABEL_3:
    runtime_cmpstring(a1, a2, (__int64)&amp;unk_4D3C58, v8, v7);
    if ( (signed __int64)&amp;v20 &gt;= 0 )
      v11 = 1LL;
    else
      v11 = -1LL;
    goto LABEL_5;
  &#125;
  v11 = 0LL;
LABEL_5:
  if ( v11 )
  &#123;
    *(_QWORD *)&amp;v17 = &amp;unk_4AC9C0;
    *((_QWORD *)&amp;v17 + 1) = &amp;off_4EA550;
    result = fmt_Fprintln(a1, a2, v9, (__int64)&amp;off_4EBDA0, v7, v10, (__int64)&amp;off_4EBDA0, qword_577550);
  &#125;
  else
  &#123;
    v18 = &amp;unk_4AC9C0;
    v19 = &amp;off_4EA540;
    result = fmt_Fprintln(a1, a2, v9, (__int64)&amp;off_4EBDA0, v7, v10, (__int64)&amp;off_4EBDA0, qword_577550);
  &#125;
  return result;
&#125;
</code></pre>
<p>看到了输出提示语，然后输入，最后进行字符串比较，输出正误，没见到有什么特殊的处理，猜测直接<code>flag</code>明文比较，点进去，得到<code>flag</code></p>
<pre><code>flag&#123;hello_world_gogogo&#125;
</code></pre>
<h4 id="junk"><a href="#junk" class="headerlink" title="junk"></a>junk</h4><p>这一题还像是一道正常难度的re……</p>
<p><img src="/2020/03/30/MRCTF-wp/junk-1.png" alt="junk-1"></p>
<p>看起来很正常的流程图，但是接下来就发现<code>F5</code>大法不好使了，猜测题目<code>junk</code>的意思应该是加了混淆，所以干脆直接看汇编</p>
<p>题目需要输入一个字符串并存储到了<code>0x4216A0</code>的位置，在<code>loc_401200</code>内进行判断，通过<code>eax</code>来判别是否正确，直接<code>call</code>一个位置说明在这个判断函数里动了很多手脚，进去看看</p>
<p><del>然后发现简直乱七八糟</del></p>
<pre><code class="asm">.text:00401200 loc_401200:                             ; CODE XREF: sub_401390+1E↓p
.text:00401200                 push    ebp
.text:00401201                 mov     ebp, esp
.text:00401203                 sub     esp, 3Ch
.text:00401206                 push    ebx
.text:00401207                 push    esi
.text:00401208                 push    edi
.text:00401209                 mov     eax, [ebp+4]
.text:0040120C                 sub     esp, 0E9h
.text:00401212                 push    eax
.text:00401213                 mov     dword ptr [ebp-8], offset unk_4216A0
.text:0040121A                 mov     eax, [ebp-8]
.text:0040121D                 add     eax, 1
.text:00401220                 mov     [ebp-1Ch], eax
.text:00401223
.text:00401223 loc_401223:                             ; CODE XREF: .text:00401233↓j
.text:00401223                 mov     ecx, [ebp-8]
.text:00401226                 mov     dl, [ecx]
.text:00401228                 mov     [ebp-1], dl
.text:0040122B                 add     dword ptr [ebp-8], 1
.text:0040122F                 cmp     byte ptr [ebp-1], 0
.text:00401233                 jnz     short loc_401223
.text:00401235                 mov     eax, [ebp-8]
.text:00401238                 sub     eax, [ebp-1Ch]
.text:0040123B                 mov     [ebp-20h], eax
.text:0040123E                 mov     ecx, [ebp-20h]
.text:00401241                 mov     [ebp-24h], ecx
.text:00401244                 cmp     dword ptr [ebp-24h], 2Bh
.text:00401248                 jz      short loc_401251
.text:0040124A                 xor     al, al
.text:0040124C                 jmp     loc_401387
</code></pre>
<p>这段的意思实际上就是判断了一下字符串的长度为<code>0x2B</code>，然后进行了一个跳转，如果长度不为<code>0x2B</code>，跳转到结束部分，如果是，进行下一步的处理，然后发现下一步有个花指令</p>
<pre><code class="asm">loc_401251:                             ; CODE XREF: .text:00401248↑j
.text:00401251                 call    sub_401275
.text:00401256                 call    near ptr 2BFF088Eh
.text:00401256 ; ---------------------------------------------------------------------------
.text:0040125B                 db    0
.text:0040125C                 db    0
.text:0040125D                 db    0
.text:0040125E                 db 33h
.text:0040125F                 db 0C0h
.text:00401260                 db 8Ah
.text:00401261                 db  86h
.text:00401262                 db  9Fh ; OFF32 SEGDEF [_data,42169F]
.text:00401263                 db  16h
.text:00401264                 db  42h ; B
.text:00401265                 db    0
.text:00401266                 db 34h
.text:00401267                 db    3
.text:00401268                 db 88h
.text:00401269                 db  86h
.text:0040126A                 db  9Fh ; OFF32 SEGDEF [_data,42169F]
.text:0040126B                 db  16h
.text:0040126C                 db  42h ; B
.text:0040126D                 db    0
.text:0040126E                 db 4Eh
.text:0040126F                 db 85h
.text:00401270                 db 0F6h
.text:00401271                 db 75h
.text:00401272                 db 0EBh
.text:00401273                 db 0EBh
</code></pre>
<p>开始变得乱七八糟，看一下<code>call</code>的函数内容</p>
<pre><code class="asm">sub_401275      proc near               ; CODE XREF: .text:loc_401251↑p
.text:00401275                 pop     eax
.text:00401276                 add     eax, 1
.text:00401279                 push    eax
.text:0040127A                 retn
.text:0040127A sub_401275      endp
</code></pre>
<p>这就是个典型的花指令，首先<code>call</code>一个函数，相当于<code>push eip+jmp</code>，这个时候栈顶是<code>eip</code>就是函数执行结束之后需要返回的地址，但是进入这个函数之后发现，这个函数的作用就是把栈顶的<code>old eip</code>弹出到<code>eax</code>，然后<code>+1</code>，再<code>push</code>到栈顶，这使得最后返回的时候跳过了<code>call</code>命令紧接着的那个字节，所以手动去一下花，真正的指令应该是</p>
<pre><code class="asm"> xor     esi, esi
.text:00401259                 mov     esi, 2Bh
.text:0040125E
.text:0040125E loc_40125E:                             ; CODE XREF: .text:00401271↓j
.text:0040125E                 xor     eax, eax
.text:00401260                 mov     al, byte ptr (dword_42169C+3)[esi]
.text:00401266                 xor     al, 3
.text:00401268                 mov     byte ptr (dword_42169C+3)[esi], al
.text:0040126E                 dec     esi
.text:0040126F                 test    esi, esi
.text:00401271                 jnz     short loc_40125E
.text:00401273                 jmp     short loc_40127B
</code></pre>
<p>对于输入的字符每一个都和3异或得到了新的字符串，这里用的<code>al</code>取低八位实际上没有什么影响，因为输入的字符都在<code>0~255</code>之间，然后接下来还有一个跳转</p>
<pre><code class="asm">loc_40127B:                             ; CODE XREF: .text:00401273↑j
.text:0040127B                 xor     eax, eax
.text:0040127D                 jz      short near ptr loc_40127F+1
.text:0040127F
.text:0040127F loc_40127F:                             ; CODE XREF: .text:0040127D↑j
.text:0040127F                 call    near ptr 2BFF08B7h
.text:0040127F ; ---------------------------------------------------------------------------
.text:00401284                 db    0
.text:00401285                 db    0
.text:00401286                 db    0
.text:00401287                 db  33h ; 3
.text:00401288                 db 0C0h, 8Ah, 86h
.text:0040128B                 dd offset dword_42169C+3
.text:0040128F                 db 8Bh
.text:00401290                 dd 74DB33CEh, 0E183E801h, 0F98301h, 0C8C00574h, 0C003EB04h
.text:00401290                 dd 868804C0h
.text:004012A8                 dd offset dword_42169C+3
.text:004012AC                 dd 75F6854Eh, 2BBAD6h
.text:004012B4                 db 2 dup(0), 0B9h
.text:004012B7                 dd offset unk_4216A0
</code></pre>
<p>又是一个花指令，这个就比较明显，去花</p>
<pre><code class="asm">loc_401287:                             ; CODE XREF: .text:004012AF↓j
.text:00401287                 xor     eax, eax
.text:00401289                 mov     al, byte ptr (dword_42169C+3)[esi]
.text:0040128F                 mov     ecx, esi
.text:00401291                 xor     ebx, ebx
.text:00401293                 jz      short near ptr loc_401295+1
.text:00401295
.text:00401295 loc_401295:                             ; CODE XREF: .text:00401293↑j
.text:00401295                 call    near ptr 8341F41Dh
.text:0040129A                 stc
.text:0040129B                 add     [ebp+eax-40h], dh
</code></pre>
<p>又是一个明显的花指令，接着去花，之后就没什么阻碍了</p>
<pre><code class="asm">loc_40127B:                             ; CODE XREF: .text:00401273↑j
.text:0040127B                 xor     eax, eax
.text:0040127D                 jz      short loc_401280
.text:0040127D ; ---------------------------------------------------------------------------
.text:0040127F                 db 0E8h
.text:00401280 ; ---------------------------------------------------------------------------
.text:00401280
.text:00401280 loc_401280:                             ; CODE XREF: .text:0040127D↑j
.text:00401280                 xor     esi, esi
.text:00401282                 mov     esi, 2Bh
.text:00401287
.text:00401287 loc_401287:                             ; CODE XREF: .text:004012AF↓j
.text:00401287                 xor     eax, eax
.text:00401289                 mov     al, byte ptr (dword_42169C+3)[esi]
.text:0040128F                 mov     ecx, esi
.text:00401291                 xor     ebx, ebx
.text:00401293                 jz      short loc_401296
.text:00401293 ; ---------------------------------------------------------------------------
.text:00401295                 db 0E8h
.text:00401296 ; ---------------------------------------------------------------------------
.text:00401296
.text:00401296 loc_401296:                             ; CODE XREF: .text:00401293↑j
.text:00401296                 and     ecx, 1
.text:00401299                 cmp     ecx, 0
.text:0040129C                 jz      short loc_4012A3
.text:0040129E                 ror     al, 4
.text:004012A1                 jmp     short loc_4012A6
.text:004012A3 ; ---------------------------------------------------------------------------
.text:004012A3
.text:004012A3 loc_4012A3:                             ; CODE XREF: .text:0040129C↑j
.text:004012A3                 rol     al, 4
.text:004012A6
.text:004012A6 loc_4012A6:                             ; CODE XREF: .text:004012A1↑j
.text:004012A6                 mov     byte ptr (dword_42169C+3)[esi], al
.text:004012AC                 dec     esi
.text:004012AD                 test    esi, esi
.text:004012AF                 jnz     short loc_401287
.text:004012B1                 mov     edx, 2Bh
.text:004012B6                 mov     ecx, offset unk_4216A0
.text:004012BB                 call    sub_401090
.text:004012C0                 mov     dword ptr [ebp-0Ch], offset byte_421708
.text:004012C7                 mov     edx, [ebp-0Ch]
.text:004012CA                 add     edx, 1
.text:004012CD                 mov     [ebp-28h], edx
.text:004012D0
.text:004012D0 loc_4012D0:                             ; CODE XREF: .text:004012E0↓j
.text:004012D0                 mov     eax, [ebp-0Ch]
.text:004012D3                 mov     cl, [eax]
.text:004012D5                 mov     [ebp-2], cl
.text:004012D8                 add     dword ptr [ebp-0Ch], 1
.text:004012DC                 cmp     byte ptr [ebp-2], 0
.text:004012E0                 jnz     short loc_4012D0
.text:004012E2                 mov     edx, [ebp-0Ch]
.text:004012E5                 sub     edx, [ebp-28h]
.text:004012E8                 mov     [ebp-30h], edx
.text:004012EB                 mov     dword ptr [ebp-10h], offset aBuedvshlmfwhpz ; &quot;%BUEdVSHlmfWhpZn!oaWZ(aGBsZ@ZpZn!oaWZ(a&quot;...
.text:004012F2                 mov     eax, [ebp-10h]
.text:004012F5                 add     eax, 1
.text:004012F8                 mov     [ebp-2Ch], eax
.text:004012FB
.text:004012FB loc_4012FB:                             ; CODE XREF: .text:0040130B↓j
.text:004012FB                 mov     ecx, [ebp-10h]
.text:004012FE                 mov     dl, [ecx]
.text:00401300                 mov     [ebp-3], dl
.text:00401303                 add     dword ptr [ebp-10h], 1
.text:00401307                 cmp     byte ptr [ebp-3], 0
.text:0040130B                 jnz     short loc_4012FB
.text:0040130D                 mov     eax, [ebp-10h]
.text:00401310                 sub     eax, [ebp-2Ch]
.text:00401313                 mov     [ebp-34h], eax
.text:00401316                 mov     ecx, [ebp-30h]
.text:00401319                 cmp     ecx, [ebp-34h]
.text:0040131C                 jz      short loc_401322
.text:0040131E                 xor     al, al
.text:00401320                 jmp     short loc_401387
.text:00401322 ; ---------------------------------------------------------------------------
.text:00401322
.text:00401322 loc_401322:                             ; CODE XREF: .text:0040131C↑j
.text:00401322                 mov     dword ptr [ebp-18h], 0
.text:00401329                 jmp     short loc_401334
.text:0040132B ; ---------------------------------------------------------------------------
.text:0040132B
.text:0040132B loc_40132B:                             ; CODE XREF: .text:loc_401383↓j
.text:0040132B                 mov     edx, [ebp-18h]
.text:0040132E                 add     edx, 1
.text:00401331                 mov     [ebp-18h], edx
.text:00401334
.text:00401334 loc_401334:                             ; CODE XREF: .text:00401329↑j
.text:00401334                 mov     dword ptr [ebp-14h], offset byte_421708
.text:0040133B                 mov     eax, [ebp-14h]
.text:0040133E                 add     eax, 1
.text:00401341                 mov     [ebp-38h], eax
.text:00401344
.text:00401344 loc_401344:                             ; CODE XREF: .text:00401354↓j
.text:00401344                 mov     ecx, [ebp-14h]
.text:00401347                 mov     dl, [ecx]
.text:00401349                 mov     [ebp-4], dl
.text:0040134C                 add     dword ptr [ebp-14h], 1
.text:00401350                 cmp     byte ptr [ebp-4], 0
.text:00401354                 jnz     short loc_401344
.text:00401356                 mov     eax, [ebp-14h]
.text:00401359                 sub     eax, [ebp-38h]
.text:0040135C                 mov     [ebp-3Ch], eax
.text:0040135F                 mov     ecx, [ebp-18h]
.text:00401362                 cmp     ecx, [ebp-3Ch]
.text:00401365                 jnb     short loc_401385
.text:00401367                 mov     edx, [ebp-18h]
.text:0040136A                 movsx   eax, byte_421708[edx]
.text:00401371                 mov     ecx, [ebp-18h]
.text:00401374                 movsx   edx, byte ptr aBuedvshlmfwhpz[ecx] ; &quot;%BUEdVSHlmfWhpZn!oaWZ(aGBsZ@ZpZn!oaWZ(a&quot;...
.text:0040137B                 cmp     eax, edx
.text:0040137D                 jz      short loc_401383
.text:0040137F                 xor     al, al
.text:00401381                 jmp     short loc_401387
.text:00401383 ; ---------------------------------------------------------------------------
.text:00401383
.text:00401383 loc_401383:                             ; CODE XREF: .text:0040137D↑j
.text:00401383                 jmp     short loc_40132B
.text:00401385 ; ---------------------------------------------------------------------------
.text:00401385
.text:00401385 loc_401385:                             ; CODE XREF: .text:00401365↑j
.text:00401385                 mov     al, 1
.text:00401387
.text:00401387 loc_401387:                             ; CODE XREF: .text:0040124C↑j
.text:00401387                                         ; .text:00401320↑j ...
.text:00401387                 pop     edi
.text:00401388                 pop     esi
.text:00401389                 pop     ebx
.text:0040138A                 mov     esp, ebp
.text:0040138C                 pop     ebp
.text:0040138D                 retn
</code></pre>
<p>这些都很容易分析，可以看到先分奇偶分别进行了左右循环移位，<del>虽然我看不懂这迷惑的左右移四位是什么情况</del>，实际上就是每个字符前四位和后四位交换位置</p>
<p>然后调用了一个函数进行了处理，处理之后和已知的字符串进行对比，相同就返回正确，逻辑很简单，用来处理的函数如下</p>
<pre><code class="c++">char __fastcall sub_401090(char *a1, int a2)
&#123;
  int v2; // eax
  signed int v3; // esi
  int v4; // edi
  char v5; // al
  unsigned __int8 v6; // ah
  unsigned __int8 v7; // dh
  unsigned __int8 v8; // bh
  unsigned __int8 v9; // dl
  signed int v10; // eax
  bool v11; // cf
  unsigned __int8 v12; // cl
  int i; // ecx
  int v15; // [esp+8h] [ebp-14h]
  char v16; // [esp+10h] [ebp-Ch]
  char v17; // [esp+11h] [ebp-Bh]
  char v18; // [esp+12h] [ebp-Ah]
  char v19; // [esp+13h] [ebp-9h]
  unsigned __int8 v20; // [esp+14h] [ebp-8h]
  unsigned __int8 v21; // [esp+15h] [ebp-7h]
  unsigned __int8 v22; // [esp+16h] [ebp-6h]
  unsigned __int8 v23; // [esp+1Bh] [ebp-1h]

  v2 = a2;
  v3 = 0;
  v4 = 0;
  if ( a2 )
  &#123;
    do
    &#123;
      v15 = v2 - 1;
      v5 = *a1++;
      *(&amp;v20 + v3++) = v5;
      v6 = v22;
      v7 = v21;
      v8 = v20;
      v23 = v22;
      if ( v3 == 3 )
      &#123;
        v9 = (v22 &gt;&gt; 6) + 4 * (v21 &amp; 0xF);
        v17 = (v21 &gt;&gt; 4) + 16 * (v20 &amp; 3);
        v18 = (v22 &gt;&gt; 6) + 4 * (v21 &amp; 0xF);
        v19 = v22 &amp; 0x3F;
        v16 = v20 &gt;&gt; 2;
        byte_421708[v4] = byte_41EA00[v20 &gt;&gt; 2];
        byte_421709[v4] = byte_41EA00[(unsigned __int8)((v7 &gt;&gt; 4) + 16 * (v8 &amp; 3))];
        byte_42170A[v4] = byte_41EA00[v9];
        byte_42170B[v4] = byte_41EA00[v6 &amp; 0x3F];
        v4 += 4;
        v3 = 0;
      &#125;
      v2 = v15;
    &#125;
    while ( v15 );
    if ( v3 )
    &#123;
      v10 = v3;
      if ( v3 &gt;= 3 )
      &#123;
        v12 = v23;
      &#125;
      else
      &#123;
        v11 = (unsigned int)v3 &lt; 3;
        do
        &#123;
          if ( !v11 )
          &#123;
            sub_40150A(a1);
            JUMPOUT(*(_DWORD *)algn_4011F3);
          &#125;
          *(&amp;v20 + v10++) = 0;
          v11 = (unsigned int)v10 &lt; 3;
        &#125;
        while ( v10 &lt; 3 );
        v12 = v22;
        v7 = v21;
        v8 = v20;
      &#125;
      v16 = v8 &gt;&gt; 2;
      v17 = (v7 &gt;&gt; 4) + 16 * (v8 &amp; 3);
      LOBYTE(v2) = v12 &gt;&gt; 6;
      v19 = v12 &amp; 0x3F;
      v18 = (v12 &gt;&gt; 6) + 4 * (v7 &amp; 0xF);
      for ( i = 0; i &lt; v3 + 1; ++v4 )
      &#123;
        v2 = (unsigned __int8)*(&amp;v16 + i++);
        LOBYTE(v2) = byte_41EA00[v2];
        byte_421708[v4] = v2;
      &#125;
      if ( v3 &lt; 3 )
        LOBYTE(v2) = sub_4022E0(&amp;byte_421708[v4], 46, 3 - v3);
    &#125;
  &#125;
  return v2;
&#125;
</code></pre>
<p>这是一个类似于<code>base64</code>的一个编码过程，把三个字符转换成四个字符，只不过索引的计算用了一些位运算，仔细想一下很容易还原，到这里就可以把<code>flag</code>解出来了</p>
<pre><code class="python">target = &#39;%BUEdVSHlmfWhpZn!oaWZ(aGBsZ@ZpZn!oaWZ(aGBsZ@ZpZn!oYGxnZm&#39;#%w&#39;
flag = &#39;&#39;
target1 = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz)!@#$%^&amp;*(+/&#39;
i = 0
tmps = []
# print(chr(0x2e))
# print(len(target))
while i &lt; len(target):
    index0 = target1.index(target[i])
    index1 = target1.index(target[i + 1])
    index2 = target1.index(target[i + 2])
    index3 = target1.index(target[i + 3])
    i += 4
    tmp1 = index0 * 4 + ((index1 &amp; 0x30) &gt;&gt; 4)
    tmp2 = ((index1 &amp; 0xf) &lt;&lt; 4) + ((index2 &amp; 0x3c) &gt;&gt; 2)
    tmp3 = ((index2 &amp; 3) &lt;&lt; 6) + index3
    tmps.append(tmp1)
    tmps.append(tmp2)
    tmps.append(tmp3)

for i in tmps:
    tmp = (((i &amp; 0xf) &lt;&lt; 4) &amp; 0xff) + ((i &amp; 0xf0) &gt;&gt; 4)
    flag += chr(tmp ^ 3)
print(flag+&#39;&#125;&#39;)
</code></pre>
<p>最后凑不齐三个字符，还有下面一套的编码方式，但我懒得看了……反正已经知道最后一个字符是<code>&#39;&#125;&#39;</code>，干脆直接略过，输出<code>flag</code></p>
<pre><code>MRCTF&#123;junkjunkjunkcodejunkjunkcodejunkcode&#125;
</code></pre>
<p><del>也就这题有点意思</del></p>
<h3 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h3><p>就做了两道题，第一题直接溢出，第二题<code>shellcode</code>，第三题看了是格式化字符串任意写也没什么意思，就不多写了</p>

          
            <div class='article_footer'>
              
                
  
    
    



  

  
    
    



  

  
    
    

<section class="widget copyright  desktop mobile">
  <div class='content'>
    
      <blockquote>
        
          
            <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

          
        
          
            <p>本文永久链接是：<a href=http://blog.rycbar.club/2020/03/30/MRCTF-wp/>http://blog.rycbar.club/2020/03/30/MRCTF-wp/</a></p>
          
        
      </blockquote>
    
  </div>
</section>

  

  


              
            </div>
          
        </div>
        
          


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2020-03-30T16:12:40+08:00">
  <a class='notlink'>
    <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：2020年3月30日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/ctf/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>ctf</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/writeup/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>writeup</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/MRCTF/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>MRCTF</p></a></div>


        
      
        
          

        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.rycbar.club/2020/03/30/MRCTF-wp/&title=MRCTF-wp - My Tiny Ideas&summary=最近招新事情实在是有点多，这比赛只打了半天，做了几道re和简单的pwn，随便写一下"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://blog.rycbar.club/2020/03/30/MRCTF-wp/&title=MRCTF-wp - My Tiny Ideas&summary=最近招新事情实在是有点多，这比赛只打了半天，做了几道re和简单的pwn，随便写一下"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.rycbar.club/2020/03/30/MRCTF-wp/&title=MRCTF-wp - My Tiny Ideas&summary=最近招新事情实在是有点多，这比赛只打了半天，做了几道re和简单的pwn，随便写一下"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
          <div class="prev-next">
            
              <a class='prev' href='/2020/04/01/Javis-OJ-wp/'>
                <p class='title'><i class="fas fa-chevron-left" aria-hidden="true"></i>Javis-OJ-wp</p>
                <p class='content'>Javis OJ的题目还是很不错的，可以仔细研究研究


reFindkeyDIE看看发现是pyc文件，试一下uncompyle6发现直接成功没加任何保护，看看代码
import sys
loo...</p>
              </a>
            
            
              <a class='next' href='/2020/03/27/babyunic-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/'>
                <p class='title'>babyunic-攻防世界<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
                <p class='content'>这是第一次接触unicorn的题目，也算是第一次用z3来解决题目，花了好长时间去熟悉z3和unicorn，确实很强大


打开来有个脚本
LD_PRELOAD=./un.so.1 ./babyu...</p>
              </a>
            
          </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  <article class="post white-box reveal comments shadow">
    <section class="article typo">
      <p ct><i class='fas fa-comments'></i> 评论</p>
      
      
      
      
        <section id="comments">
          <div id="gitalk-container"></div>
        </section>
      
      
      
      
    </section>
  </article>


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: 'MRCTF-wp',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
  

  
    
    


  <section class="widget toc-wrapper shadow desktop mobile">
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#re"><span class="toc-text">re</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#transform"><span class="toc-text">transform</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%92%B8%E5%95%8A%E6%92%B8"><span class="toc-text">撸啊撸</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PixelShooter"><span class="toc-text">PixelShooter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#hello-world-go"><span class="toc-text">hello_world_go</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#junk"><span class="toc-text">junk</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pwn"><span class="toc-text">pwn</span></a></li></ol>
    </div>
  </section>


  


</aside>


  
  <footer class="clearfix">
    <br><br>
    
      
        <div class="aplayer-container">
          

  
    <meting-js
      theme='#1BCDFC'
      autoplay='false'
      volume='0.7'
      loop='all'
      order='random'
      fixed='false'
      list-max-height='340px'
      server='netease'
      type='playlist'
      id='555017395'
      list-folded='true'>
    </meting-js>
  


        </div>
      
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="/rycbar17th@gmail.com"
                class="social fas fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://github.com/schrodinger17"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        <div class='copyright'>
        <p><a href="https://blog.rycbar.club/">Copyright © 2017-2020 rycbar</a></p>

        </div>
      
    
  </footer>

<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script>


  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>


  <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.6/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      ScrollReveal().reveal('.l_main .reveal', {
        distance: '8px',
        duration: '800',
        interval: '100',
        scale: '1'
      });
    });
  </script>


  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/BBC19066-E176-47C2-9D22-48C81EE5DF6B.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/35F12181-F0E9-45BD-B134-37E4B4A660CF.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/00E0F0ED-9F1C-407A-9AA6-545649D919F4.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/67239FBB-E15D-4F4F-8EE8-0F1C9F3C4E7C.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B951AE18-D431-417F-B3FE-A382403FF21B.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/AEB33F9D-7294-4CF1-B8C5-3020748A9D45.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/2884F904-F1F3-479E-AE27-5EBC291B63B0.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/10A0FCE5-36A1-4AD0-8CF0-019259A89E03.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/250662D4-5A21-4AAA-BB63-CD25CF97CFF1.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/298468D7-E388-44A8-8CC5-8213BDC33CED.jpeg"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('.cover') {
          $('.cover').backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        }
      });
    </script>
  



  
    
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>

  
    
<script src="https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js"></script>

  






  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
  <script type="text/javascript">
    var gitalk = new Gitalk({
      clientID: "6dbe0fb891585031b176",
      clientSecret: "4407fec5af8e37150b5a4cb82821318d91c07769",
      repo: "comments",
      owner: "schrodinger17",
      admin: "schrodinger17",
      
        id: location.pathname,      // Ensure uniqueness and length less than 50
      
      distractionFreeMode: false  // Facebook-like distraction free mode
    });
    gitalk.render('gitalk-container');
  </script>








  
<script src="/js/app.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.6.5/js/search.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script>




  
    
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
  



<!-- 复制 -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-check-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-check-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-times-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-times-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>




<!-- fancybox -->

  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("div.fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>






  <script>setLoadingBarProgress(100);</script>
</body>
</html>
