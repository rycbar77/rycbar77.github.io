<!DOCTYPE html>
<html>
<head hexo-theme='https://volantis.js.org/#blog'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
    <title>2020-强网杯-wp - My Tiny Ideas</title>
  
    <meta name="keywords" content="writeup">
  
  
    <meta name="description" content="赛题出的很有水平啊，第一天出去玩了一天，第二天才开始做，只做出了这么几题，看了一下firmware是个虚拟机，再多点时间应该也可以出">
  

  <!-- feed -->
  

  <!-- import meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13/css/all.min.css">
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  
  <link rel="shortcut icon" type='image/x-icon' href="https://cdn.jsdelivr.net/gh/xaoxuu/assets@master/favicon/favicon.ico">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
  

  

  <!-- import link -->
  

  
    
      
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.18.1/styles/solarized-light.css">

    
  
  
    
<link rel="stylesheet" href="/css/style.css">

  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128484503-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-128484503-1');
    </script>
  
  
</head>

<body>
  
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<header class="l_header shadow blur">
  <div class='container'>
  <div class='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h'>
        <li><a class="s-comment fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a class="s-toc fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
          
          
          
            RYCBAR'S <b><sup style='color:#3AA757'>blog</sup></b>
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h'>
          
          
          
            
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>

			<ul class='switcher nav-list-h'>
				
					<li><a class="s-search fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li>
          <a class="s-menu fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友链
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>
		</div>
	</div>
  </div>
</header>

<script>setLoadingBarProgress(40);</script>



  <div class="l_body nocover">
    <div class='body-wrapper'>
      

<div class='l_main'>
  

  
    <article id="post" class="post white-box reveal shadow article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h1 class="title">
    <a href="/2020/08/28/2020-08-28-2020-%E5%BC%BA%E7%BD%91%E6%9D%AF-wp/">
      2020-强网杯-wp
    </a>
  </h1>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a href="http://blog.rycbar.club" rel="nofollow">
    <img src="https://q2.qlogo.cn/headimg_dl?dst_uin=595371936&spec=100">
    <p>rycbar</p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/ctf/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>ctf</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2020年8月28日</p>
  </a>
</div>

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <p>赛题出的很有水平啊，第一天出去玩了一天，第二天才开始做，只做出了这么几题，看了一下firmware是个虚拟机，再多点时间应该也可以出</p>
<span id="more"></span>

<h2 id="侧防"><a href="#侧防" class="headerlink" title="侧防"></a>侧防</h2><p>这题比较简单，放在了，没有放在re分类，直接上脚本</p>
<pre><code class="python">byte_4010 = [0x51, 0x57, 0x42, 0x6C, 0x6F, 0x67, 0x73]
target = &quot;Lx|dTUwe\\IvNhCBOLqDNfW&#125;ImFZCtiyxO\\PW^ebD&quot;
f = []
for i in range(0, len(target), 4):
   f.append(target[i + 1])
   f.append(target[i + 2])
   f.append(target[i + 3])
   f.append(target[i])
flag = &quot;&quot;
for i, c in enumerate(f):
   flag += chr((ord(c) - 65) ^ byte_4010[i % 7])
print(flag)
# flag&#123;QWB_water_problem_give_you_the_score&#125;
</code></pre>
<h2 id="xx-warmup-obf"><a href="#xx-warmup-obf" class="headerlink" title="xx_warmup_obf"></a>xx_warmup_obf</h2><p>混淆+花指令+反调，从read或者strlen函数开始找起会比较方便，找到之后发现一位一位计算，为了节省时间，代码跑出一部分之后后面的flag可以直接猜出来</p>
<pre><code class="python">from z3 import *

def RecurOr(flags, models, pos=0):
   if pos &lt;= len(flags) - 1:
       return Or(models[flags[pos]] != flags[pos], RecurOr(flags, models, pos + 1))
   else:
       return Or(models[flags[pos]] != flags[pos])

f = [BitVec(&#39;v%d&#39; % i, 16) for i in range(22)]
flag = []
solver = Solver()
for c in f:
   solver.add(c &gt;= 0x0)
   solver.add(c &lt;= 0xff)
solver.add(f[0] == ord(&#39;f&#39;))
solver.add(f[1] == ord(&#39;l&#39;))
solver.add(f[2] == ord(&#39;a&#39;))
solver.add(f[3] == ord(&#39;g&#39;))
solver.add(f[4] == ord(&#39;&#123;&#39;))
solver.add((f[5] * 0x1eb9d + f[2] * 0x40a8c + f[3] * 0x3fb3f + f[4] * 0xfffb82cd + f[1] * 0xffffea88 + f[0] * 0xfffda7c3) &amp; 0xffffffff == 0xc78321)
solver.add((f[6] * 0xfffd185d + f[5] * 0xfffe032d + f[2] * 0xfffc468a + f[3] * 0xFFFC0EA3 + f[4] * 0xFFFE5277 + f[1] * 0xfffc4328 + f[0] * 0x44DE) &amp; 0xffffffff == 0xF961DAEB)
solver.add((f[6] * 0x35770 + f[5] * 0x1CC39 + f[2] * 0x4851 + f[3] * 0xFFFFE5B9 + f[4] * 0x36D92 + f[1] * 0xFFFCF9E1 + f[0] * 0x37C38 + f[7] * 0x4186D)&amp; 0xffffffff == 0x4B202E4)
solver.add((f[6] * 0xFFFC4AB1 + f[5] * 0x0CB64 + f[2] * 0x1309E + f[3] * 0xFFFB995E + f[4] * 0x2E940 + f[1] * 0xFFFEB612 + f[0] * 0xFFFC631A + f[7] * 0xFFFCAA83 + f[8] * 0x16A0C) &amp; 0xffffffff == 0xFCDE9AB5)
solver.add((f[6] * 0x37EB9 + f[5] * 0xFFFDD238 + f[2] * 0xFFFBE2C0 + f[3] * 0x17977 + f[4] * 0x29D39 + f[1] * 0xFFFBB74E + f[0] * 0xFFFD6E33 + f[7] * 0xFFFF0427 + f[8] * 0xFFFD0153 + f[9] * 0xFFFF66A5) &amp; 0xffffffff == 0xFBC7B90A)
solver.add((f[6] * 0x1DAAC + f[5] * 0xFFFE92AC + f[2] * 0xFFFF9AD4 + f[3] * 0x2C78D + f[4] * 0xFFFC69EE + f[1] * 0xFFFC1736 + f[0] * 0x47762 + f[7] * 0x28557 + f[8] * 0x27B6D + f[9] * 0xFFFF7F4E + f[10] * 0x2F9DF) &amp; 0xffffffff == 0x1AF43AB)
solver.add((f[6] * 0xFFFDFD46 + f[5] * 0xFFFBD6F6 + f[2] * 0x13A87 + f[3] * 0x42997 + f[4] * 0x244E9 + f[1] * 0x20A60 + f[0] * 0x0C3F6 + f[7] * 0xFFFC0F74 + f[8] * 0xFFFE4DC8 + f[9] * 0xFFFE94DC + f[10] * 0xFFFFECB4 + f[11] * 0xFFFD79C6) &amp; 0xffffffff == 0xFEAFEC1F)
solver.add((f[6] * 0xFFFE7848 + f[5] * 0x23EE3 + f[2] * 0xFFFCBAB4 + f[3] * 0x27C92 + f[4] * 0xFFFBFD5C + f[1] * 0xFFFD30C3 + f[0] * 0x5009 + f[7] * 0xFFFE93F1 + f[8] * 0xFFFDE3F3 + f[9] * 0x228DC + f[10] * 0x25EE + f[11] * 0xF242 + f[12] * 0x1160E) &amp; 0xffffffff == 0xFE20EC14)
solver.add((f[6] * 0x648B + f[5] * 0xFFFCF002 + f[2] * 0xFFFE2E15 + f[3] * 0x1E041 + f[4] * 0x594B + f[1] * 0xFFFF3713 + f[0] * 0xFFFED96C + f[7] * 0x1C620 + f[8] * 0xFFFF282A + f[9] * 0xFFFF0E48 + f[10] * 0xFFFEAC54 + f[11] * 0xEA5F + f[12] * 0x35CF4 + f[13] * 0xFFFC920E) &amp; 0xffffffff == 0xFDCA76A0)
solver.add((f[6] * 0x107E1 + f[5] * 0x440D9 + f[2] * 0xFFFFF5C3 + f[3] * 0x30766 + f[4] * 0x21281 + f[1] * 0x235C2 + f[0] * 0x1B2CE + f[7] * 0x16687 + f[8] * 0x493EC + f[9] * 0x26716 + f[0xA] * 0xFFFC84CB + f[0xB] * 0xFFFEA6FA + f[0xC] * 0xFFFC2F98 + f[0xD] * 0xFFFD1A3E + f[0xE] * 0x390BF) &amp; 0xffffffff == 0x5920B01)
solver.add((f[6] * 0x24225 + f[5] * 0xFFFD39FC + f[2] * 0x1EAE2 + f[3] * 0x2F613 + f[4] * 0xFFFC66F9 + f[1] * 0xFFFE0433 + f[0] * 0x3E19 + f[7] * 0x1BDFF + f[8] * 0xFFFC6EAB + f[9] * 0xFFFD810C + f[0xA] * 0x0D519 + f[0xB] * 0x384EC + f[0xC] * 0x197E5 + f[0xD] * 0xFFFFD159 + f[0xE] * 0xFFFF43D9 + f[0xF] * 0xFFFC28DF) &amp; 0xffffffff == 0xFDD0E812)
solver.add((f[6] * 0x111A3 + f[5] * 0xFFFF32EB + f[2] * 0x3E3F9 + f[3] * 0xFFFE9E4B + f[4] * 0xFFFFFB1A + f[1] * 0xFFFF65B9 + f[0] * 0xFFFDF970 + f[7] * 0xFFFB936C + f[8] * 0xFFFEF482 + f[9] * 0x57B6 + f[0xA] * 0x8813 + f[0xB] * 0x25CDC + f[0xC] * 0x12190 + f[0xD] * 0x427BE + f[0xE] * 0xFFFC8358 + f[0xF] * 0xFFFCE4EE + f[0x10] * 0x43BB5) &amp; 0xffffffff == 0xFF9ADC73)
solver.add((f[6] * 0xFFFC313D + f[5] * 0x1023B + f[2] * 0x2E27A + f[3] * 0xFFFDCCD4 + f[4] * 0xFFFE498F + f[1] * 0xFFFFEC0D + f[0] * 0x3A1A3 + f[7] * 0xFFFCC8E2 + f[8] * 0xFFFC37B6 + f[9] * 0xFFFF2FE9 + f[0xA] * 0xFFFE8E68 + f[0xB] * 0x1F45C + f[0xC] * 0xFFFEAC48 + f[0xD] * 0xFFFDBD08 + f[0xE] * 0x2A28 + f[0xF] * 0xD72D + f[0x10] * 0xFFFF70B8 + f[0x11] * 0xFFFFE90F) &amp; 0xffffffff == 0xFCD6008F)
solver.add((f[6] * 0xFFFBB7A0 + f[5] * 0xFFFF0015 + f[2] * 0xFFFD2918 + f[3] * 0x1882D + f[4] * 0xFFFEDE1F + f[1] * 0x2FB77 + f[0] * 0x20D94 + f[7] * 0x14A94 + f[8] * 0xFFFDA0CD + f[9] * 0xDE69 + f[0xA] * 0x2FE8 + f[0xB] * 0x2ABE5 + f[0xC] * 0x26530 + f[0xD] * 0x4C3D + f[0xE] * 0x2383E + f[0xF] * 0x42763 + f[0x10] * 0xE5C9 + f[0x11] * 0x539 + f[0x12] * 0xFFFC5AF3) &amp; 0xffffffff == 0x39F3331)
solver.add((f[6] * 0xFFFD67BD + f[5] * 0xFFFCFC61 + f[2] * 0x21FB1 + f[3] * 0x2AFE7 + f[4] * 0xFFFE2316 + f[1] * 0xFFFDE3DE + f[0] * 0xFFFCF431 + f[7] * 0xFFFF1A07 + f[8] * 0xFFFD1877 + f[9] * 0xFFFBAB46 + f[0xA] * 0xFFFFB7A8 + f[0xB] * 0x44C76 + f[0xC] * 0x3C062 + f[0xD] * 0x26DA8 + f[0xE] * 0x217FE + f[0xF] * 0x27911 + f[0x10] * 0xD484 + f[0x11] * 0x217F6 + f[0x12] * 0xFFFF711C + f[0x13] * 0xFFFE6835) &amp; 0xffffffff == 0x4AF658)
solver.add((f[6] * 0x6C67 + f[5] * 0x4210C + f[2] * 0x24372 + f[3] * 0xFFFF64A1 + f[4] * 0xFFFE83FC + f[1] * 0xFFFC59E3 + f[0] * 0x1A675 + f[7] * 0x29403 + f[8] * 0x122E6 + f[9] * 0x479E1 + f[0xA] * 0xFFFE556B + f[0xB] * 0xFFFEE2E8 + f[0xC] * 0xFFFD0C98 + f[0xD] * 0xF761 + f[0xE] * 0xFFFCF4FD + f[0xF] * 0x24A14 + f[0x10] * 0x2C39B + f[0x11] * 0xFFFF914F + f[0x12] * 0x94F9 + f[0x13] * 0x1F3A9 + f[0x14] * 0xFFFD85A7) &amp; 0xffffffff == 0x2B77651)
solver.add((f[6] * 0x0B245 + f[5] * 0x47951 + f[2] * 0x3C177 + f[3] * 0x2026C + f[4] * 0x2BD3A + f[1] * 0x0AE83 + f[0] * 0xFFFF67E2 + f[7] * 0x0FC81 + f[8] * 0xFFFD1DCD + f[9] * 0xFFFE7D87 + f[0xA] * 0x40428 + f[0xB] * 0x1AC25 + f[0xC] * 0x47B95 + f[0xD] * 0xFFFBD35D + f[0xE] * 0xFFFD55C5 + f[0xF] * 0x255EF + f[0x10] * 0xFFFCA285 + f[0x11] * 0x1B4F2 + f[0x12] * 0xFFFBA306 + f[0x13] * 0x3B929 + f[0x14] * 0xEC4C+f[0x15]*0xFFFCD49C) &amp; 0xffffffff == 0x49F26C9)
while solver.check() == sat:
   flag = &quot;&quot;
   model = solver.model()
   for i in range(len(f)):
       flag += chr(model[f[i]].as_long())
       print(flag)
       solver.add(RecurOr(f, model))
# flag&#123;g0_Fuck_xx_5egm3n
</code></pre>
<p>根据题目描述，<code>先做这个热热身，做完这个再去做xx_segment_obf也不迟</code>，猜测flag为</p>
<pre><code>flag&#123;g0_Fuck_xx_5egm3nt_0bf&#125;
</code></pre>
<p>提交成功</p>
<h2 id="imitation-game"><a href="#imitation-game" class="headerlink" title="imitation_game"></a>imitation_game</h2><p>运行程序，首先输出flag提示，flag有两部分，先过第一部分才会运行第二部分的程序</p>
<p>调试程序，调试过程中发现AES的s-box，发现输入了明文之后在后面pad了32位\x1a，然后进行AES-CBC加密，密钥和iv还有最终运行的结果可以在内存里找到，直接解密</p>
<pre><code class="python">from Crypto.Cipher import AES
from binascii import b2a_hex, a2b_hex

def add_to_16(text):
   if len(text.encode(&#39;utf-8&#39;)) % 16:
       add = 16 - (len(text.encode(&#39;utf-8&#39;)) % 16)
   else:
       add = 0
   text = text + (&#39;\0&#39; * add)
   return text.encode(&#39;utf-8&#39;)

def encrypt(text):
   key = b&quot;\x3E\x2C\x25\x13\x18\xBE\xC3\x6B\xA1\x37\x24\x53\x03\x1E\x51\xEC&quot;
   iv = b&quot;\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2A\x2B\x2C\x2D\x2E\x2F&quot;
   mode = AES.MODE_CBC
   text = add_to_16(text)
   cryptos = AES.new(key, mode, iv)
   cipher_text = cryptos.encrypt(text)
   return b2a_hex(cipher_text)

def decrypt(text):
   key = b&quot;\x3E\x2C\x25\x13\x18\xBE\xC3\x6B\xA1\x37\x24\x53\x03\x1E\x51\xEC&quot;
   iv = b&quot;\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2A\x2B\x2C\x2D\x2E\x2F&quot;
   mode = AES.MODE_CBC
   cryptos = AES.new(key, mode, iv)
   plain_text = cryptos.decrypt(a2b_hex(text))
   return plain_text

if __name__ == &#39;__main__&#39;:
   e = encrypt(&quot;6c8f1d78770fe672122478c6f9a150e8\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a&quot;)
   d = decrypt(b&quot;9D7BA23CB1099A4841D16663D6AE3CAB87ED59C2D3DA2A05BA5129C15D426A9A0514DBBEAE838B6FD3594152344E39C566E1E3EC0618149F4EB770009077D8AE&quot;)
   print(&quot;加密:&quot;, e)
   print(&quot;解密:&quot;, d)

# 6c8f1d78770fe672122478c6f9a150e8
</code></pre>
<p>得到第一部分flag，进入第二部分，调用了game.bin文件，根据提示是一个chip8的模拟器，一共输入10位数，错误则提示dead</p>
<p>有了提示之后好做了很多，根据chip8的指令集解析一下game.bin文件</p>
<pre><code class="python">with open(&#39;game.txt&#39;, &#39;r+&#39;) as f:
   s = f.read()
   # print(s)
j = 0
for i in range(0, len(s), 5):
   t = s[i:i + 4]
   # print(t)
   print(&quot;addr:&quot; + hex(j + 0x200), end=&quot;   &quot;)
   j += 2
   if t[0] == &#39;0&#39;:
       if t[1] == &#39;0&#39; and t[2] == &#39;e&#39;:
          if t[3] == &#39;1&#39;:
              print(&quot;clear screen&quot;)
          elif t[3] == &#39;f&#39;:
              print(&quot;Returns from a subroutine&quot;)
          else:
              print(&quot;call program at addr: &quot; + t[1:])
       else:
           print(&quot;call program at addr: &quot; + t[1:])
   elif t[0] == &#39;1&#39;:
       print(&quot;jmp &quot; + t[1:])
   elif t[0] == &#39;2&#39;:
       print(&quot;call &quot; + t[1:])
   elif t[0] == &#39;3&#39;:
       print(&quot;Skips the next instruction if V&quot; + t[1] + &quot; equals &quot; + t[2:])
   elif t[0] == &#39;4&#39;:
       print(&quot;Skips the next instruction if V&quot; + t[1] + &quot; not equals &quot; + t[2:])
   elif t[0] == &#39;5&#39;:
       print(&quot;Skips the next instruction if V&quot; + t[1] + &quot; equals V&quot; + t[2])
   elif t[0] == &#39;6&#39;:
       print(&quot;V&quot; + t[1] + &quot; = &quot; + t[2:])
   elif t[0] == &#39;7&#39;:
       print(&quot;V&quot; + t[1] + &quot; += &quot; + t[2:])
   elif t[0] == &#39;8&#39;:
       VX = &quot;V&quot; + t[1]
       VY = &quot;V&quot; + t[2]
       if t[-1] == &#39;0&#39;:
           print(VX + &quot; = &quot; + VY)
       elif t[-1] == &#39;1&#39;:
           print(VX + &quot; = &quot; + VX + &quot; | &quot; + VY)
       elif t[-1] == &#39;2&#39;:
           print(VX + &quot; = &quot; + VX + &quot; &amp; &quot; + VY)
       elif t[-1] == &#39;3&#39;:
           print(VX + &quot; = &quot; + VX + &quot; ^ &quot; + VY)
       elif t[-1] == &#39;4&#39;:
           print(VX + &quot; += &quot; + VY, &quot; set VF=1 if VX&gt;=255&quot;)
       elif t[-1] == &#39;5&#39;:
           print(VX + &quot; -= &quot; + VY, &quot; set VF=0 if VX&lt;=0&quot;)
       elif t[-1] == &#39;6&#39;:
           print(VX + &quot; &gt;&gt;= 1&quot;, &quot; the last one to VF&quot;)
       elif t[-1] == &#39;7&#39;:
           print(VX + &quot; = &quot; + VY + &quot; - &quot; + VX, &quot; set VF=0 if VX&amp;lt;0&quot;)
       elif t[-1] == &#39;e&#39;:
           print(VX + &quot; &lt;&lt;= 1&quot;, &quot; the first one to VF&quot;)
       else:
           print(&quot;Invalid instruction: &quot; + t)
   elif t[0] == &#39;9&#39;:
       print(&quot;Skips the next instruction if V&quot; + t[1] + &quot; not equals V&quot; + t[2])
   elif t[0] == &#39;a&#39;:
       print(&quot;set I = &quot; + t[1:])
   elif t[0] == &#39;b&#39;:
       print(&quot;jmp V0+&quot; + t[1:])
   elif t[0] == &#39;c&#39;:
       print(&quot;V&quot; + t[1] + &quot;=rand()&amp;&quot; + t[2:])
   elif t[0] == &#39;d&#39;:
       print(&quot;display at (V&quot; + t[1] + &quot;,&quot; + &quot;V&quot; + t[2] + &quot;) for &quot; + t[3] + &quot;rows&quot;)
   elif t[0] == &#39;e&#39;:
       print(&quot;something about buttons&quot;)
   elif t[0] == &#39;f&#39;:
       if t[2:] == &#39;29&#39;:
           print(&quot;set I=&quot; + &quot;V&quot; + t[1])
       elif t[2:] == &quot;0a&quot;:
           print(&quot;set V&quot; + t[1] + &quot; = button pressed&quot;)
       elif t[2:] == &quot;55&quot;:
           print(&quot;store V0-V&quot; + t[1] + &quot; to addr start at I&quot;)
       elif t[2:] == &quot;65&quot;:
           print(&quot;store addr start at I to V0-V&quot; + t[1])
       elif t[2:] == &quot;33&quot;:
           print(&quot;set BCD(V&quot; + t[1] + &quot;)&quot;)
       else:
           print(t[2:])
   else:
       print(&quot;Invalid instruction: &quot; + t)
</code></pre>
<p>解析之后根据程序的运行流程看一下大概过程，读取按键在屏幕上指定位置显示出来，直到10位都读取完，然后进行一些判断，错误就会显示dead，正确直接退出程序，不会有显示。然后详细看一下程序</p>
<p>程序开始一个跳转从2ce开始，根据chip8内存的排布规律，可执行代码从200开始</p>
<pre><code>addr:0x2ce   Ve = 10
addr:0x2d0   set I=Ve
addr:0x2d2   store V0-Ve to addr start at I
addr:0x2d4   Vf = 03
addr:0x2d6   Ve += Vf  set VF=1 if VX&gt;=255
addr:0x2d8   call 928
addr:0x2da   V0 = Vf
addr:0x2dc   V1 = 05
addr:0x2de   V2 = 08
addr:0x2e0   V3 = V0
addr:0x2e2   set I=Ve
addr:0x2e4   store V0-Ve to addr start at I
addr:0x2e6   Vf = 03
addr:0x2e8   Ve += Vf  set VF=1 if VX&gt;=255
addr:0x2ea   V0 = V1
addr:0x2ec   V1 = V2
addr:0x2ee   V2 = V3
addr:0x2f0   call 938
</code></pre>
<p>首先是10个这样的过程用于输入和显示</p>
<p>其中928用于读取输入，记录按键信息</p>
<pre><code>addr:0x928   V0 = ff
addr:0x92a   set V0 = button pressed
addr:0x92c   Vf = 03
addr:0x92e   Ve -= Vf  set VF=0 if VX&lt;=0
addr:0x930   Vf = V0
addr:0x932   set I=Ve
addr:0x934   store addr start at I to V0-Ve
addr:0x936   Returns from a subroutine
</code></pre>
<p>938用于输出到显示屏上</p>
<pre><code>addr:0x938   V5 = V2
addr:0x93a   V4 = V1
addr:0x93c   V3 = V0
addr:0x93e   V6 = 00
addr:0x940   set BCD(V5)
addr:0x942   store addr start at I to V0-V2
addr:0x944   set I=V5
addr:0x946   display at (V3,V4) for 5rows
addr:0x948   V6 = V6 | Vf
addr:0x94a   Vf = 03
addr:0x94c   Ve -= Vf  set VF=0 if VX&amp;lt;0
addr:0x94e   Vf = V6
addr:0x950   set I=Ve
addr:0x952   store addr start at I to V0-Ve
addr:0x954   Returns from a subroutine
</code></pre>
<p>经过10次这样的操作之后，显示屏上显示出10个输入的数，分别存储在寄存器V0到V9中，接下来对这些输入的数值进行处理</p>
<pre><code>addr:0x436   Va = Vf
addr:0x438   Va = V0
addr:0x43a   Vb = V0
addr:0x43c   Vc = 02
addr:0x43e   Vb += Vc  set VF=1 if VX&gt;=255
addr:0x440   Va = Vb
addr:0x442   V0 = Va
addr:0x444   Va = V1
addr:0x446   Vb = V1
addr:0x448   Vc = 01
addr:0x44a   Vb += Vc  set VF=1 if VX&gt;=255
addr:0x44c   Va = Vb
addr:0x44e   V1 = Va
addr:0x450   Va = V2
addr:0x452   Vb = V2
addr:0x454   Vc = 01
addr:0x456   Vb += Vc  set VF=1 if VX&gt;=255
addr:0x458   Vc = 01
addr:0x45a   Vb = Vb ^ Vc
addr:0x45c   Va = Vb
addr:0x45e   V2 = Va
addr:0x460   Va = V3
addr:0x462   Vb = V3
addr:0x464   Vc = 03
addr:0x466   Vb += Vc  set VF=1 if VX&gt;=255
addr:0x468   Va = Vb
addr:0x46a   V3 = Va
addr:0x46c   Va = V4
addr:0x46e   Vb = V4
addr:0x470   Vc = 02
addr:0x472   Vb += Vc  set VF=1 if VX&gt;=255
addr:0x474   Va = Vb
addr:0x476   V4 = Va
addr:0x478   Va = V5
addr:0x47a   Vb = V5
addr:0x47c   Vc = 02
addr:0x47e   Vb = Vb ^ Vc
addr:0x480   Vc = 01
addr:0x482   Vb += Vc  set VF=1 if VX&gt;=255
addr:0x484   Va = Vb
addr:0x486   V5 = Va
addr:0x488   Va = V6
addr:0x48a   Vb = V6
addr:0x48c   Vc = V6
addr:0x48e   Vb += Vc  set VF=1 if VX&gt;=255
addr:0x490   Va = Vb
addr:0x492   V6 = Va
addr:0x494   Va = V7
addr:0x496   Vb = V7
addr:0x498   Vc = 01
addr:0x49a   Vb += Vc  set VF=1 if VX&gt;=255
addr:0x49c   Va = Vb
addr:0x49e   V7 = Va
addr:0x4a0   Va = V8
addr:0x4a2   Vb = V8
addr:0x4a4   Vc = 01
addr:0x4a6   Vb = Vb ^ Vc
addr:0x4a8   Vc = 01
addr:0x4aa   Vb += Vc  set VF=1 if VX&gt;=255
addr:0x4ac   Va = Vb
addr:0x4ae   V8 = Va
addr:0x4b0   Va = V9
addr:0x4b2   Vb = V9
addr:0x4b4   Vc = 02
addr:0x4b6   Vb += Vc  set VF=1 if VX&gt;=255
addr:0x4b8   Va = Vb
addr:0x4ba   V9 = Va
</code></pre>
<p>就是如下操作</p>
<pre><code class="python">f[0]+=2
f[1]+=1
f[2]=(f[2]+1)^1
f[3]+=3
f[4]+=2
f[5]=(f[5]^2)+1
f[6]=2*f[6]
f[7]+=1
f[8]=(f[8]^1)+1
f[9]+=2
</code></pre>
<p>接下来是10个方程</p>
<pre><code>addr:0x4bc   Va = 00
addr:0x4be   Vb = Va
addr:0x4c0   Vc = V0
addr:0x4c2   Vd = 01
addr:0x4c4   set I=Ve
addr:0x4c6   store V0-Ve to addr start at I
addr:0x4c8   Vf = 03
addr:0x4ca   Ve += Vf  set VF=1 if VX&gt;=255
addr:0x4cc   V0 = Vc
addr:0x4ce   V1 = Vd
addr:0x4d0   call 27a
addr:0x4d2   Vc = Vf
addr:0x4d4   Vb += Vc  set VF=1 if VX&gt;=255
addr:0x4d6   Va = Vb
addr:0x4d8   Vb = Va
addr:0x4da   Vc = V1
addr:0x4dc   Vd = 02
addr:0x4de   set I=Ve
addr:0x4e0   store V0-Ve to addr start at I
addr:0x4e2   Vf = 03
addr:0x4e4   Ve += Vf  set VF=1 if VX&gt;=255
addr:0x4e6   V0 = Vc
addr:0x4e8   V1 = Vd
addr:0x4ea   call 27a
addr:0x4ec   Vc = Vf
addr:0x4ee   Vb += Vc  set VF=1 if VX&gt;=255
addr:0x4f0   Va = Vb
addr:0x4f2   Vb = Va
addr:0x4f4   Vc = V2
addr:0x4f6   Vd = 01
addr:0x4f8   set I=Ve
addr:0x4fa   store V0-Ve to addr start at I
addr:0x4fc   Vf = 03
addr:0x4fe   Ve += Vf  set VF=1 if VX&gt;=255
addr:0x500   V0 = Vc
addr:0x502   V1 = Vd
addr:0x504   call 27a
addr:0x506   Vc = Vf
addr:0x508   Vb += Vc  set VF=1 if VX&gt;=255
addr:0x50a   Va = Vb
addr:0x50c   Vb = Va
addr:0x50e   Vc = 21
addr:0x510   Vf = 00
addr:0x512   Skips the next instruction if Vb equals Vc
addr:0x514   Vf = 01
addr:0x516   Vb = Vf
addr:0x518   Skips the next instruction if Vb not equals 00
addr:0x51a   jmp 52e
addr:0x51c   clear screen
addr:0x51e   Vb = Vf
addr:0x520   set I=Ve
addr:0x522   store V0-Ve to addr start at I
addr:0x524   Vf = 03
addr:0x526   Ve += Vf  set VF=1 if VX&gt;=255
addr:0x528   call 202
</code></pre>
<p>202函数为输出dead函数，需要跳过，传入27a中寄存器Vd的值表示多项式前该项的系数，三个三个一组可以列出10个方程，写脚本z3求解</p>
<pre><code class="python">from z3 import *

def RecurOr(flags, models, pos=0):
    if pos &lt;= len(flags) - 1:
        return Or(models[flags[pos]] != flags[pos], RecurOr(flags, models, pos + 1))
    else:
        return Or(models[flags[pos]] != flags[pos])

f = [Int(&#39;v%d&#39; % i) for i in range(9)]
flag = []
solver = Solver()

for c in f:
    solver.add(c &gt;= 0x0)
    solver.add(c &lt;= 0xff)

solver.add(f[0] + 2 * f[1] + f[2] == 0x21)
solver.add(2 * f[0] + f[1] + f[2] == 0x2a)
solver.add(f[0] + 2 * f[1] + 2 * f[2] == 0x30)
solver.add(f[3] + 2 * f[4] + f[5] == 0x37)
solver.add(2 * f[3] + f[4] + f[5] == 0x37)
solver.add(f[3] + 2 * f[4] + 2 * f[5] == 0x3b)
solver.add(f[6] + 2 * f[7] + f[8] == 0x1f)
solver.add(2 * f[6] + f[7] + f[8] == 0x16)
solver.add(f[6] + 2 * f[7] + 2 * f[8] == 0x20)

while solver.check() == sat:
    model = solver.model()
    ff = [model[f[0]].as_long() - 2, model[f[1]].as_long() - 1, (model[f[2]].as_long() ^ 1) - 1,
          model[f[3]].as_long() - 3, model[f[4]].as_long() - 2, (model[f[5]].as_long() - 1) ^ 2,
          model[f[6]].as_long() // 2, model[f[7]].as_long() - 1, (model[f[8]].as_long() - 1) ^ 1, 5 - 2]

    print(ff)
    solver.add(RecurOr(f, model))
# a2def12c13
</code></pre>
<p>两部分都得到，拼起来提交正确</p>
<pre><code>flag&#123;6c8f1d78770fe672122478c6f9a150e8a2def12c13&#125;
</code></pre>

          
            <div class='article_footer'>
              
                
  
    
    



  

  
    
    



  

  
    
    

<section class="widget copyright  desktop mobile">
  <div class='content'>
    
      <blockquote>
        
          
            <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

          
        
          
            <p>本文永久链接是：<a href=http://blog.rycbar.club/2020/08/28/2020-08-28-2020-%E5%BC%BA%E7%BD%91%E6%9D%AF-wp/>http://blog.rycbar.club/2020/08/28/2020-08-28-2020-%E5%BC%BA%E7%BD%91%E6%9D%AF-wp/</a></p>
          
        
      </blockquote>
    
  </div>
</section>

  

  


              
            </div>
          
        </div>
        
          


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2021-05-03T19:51:08+08:00">
  <a class='notlink'>
    <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：2021年5月3日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/writeup/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>writeup</p></a></div>


        
      
        
          

        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.rycbar.club/2020/08/28/2020-08-28-2020-%E5%BC%BA%E7%BD%91%E6%9D%AF-wp/&title=2020-强网杯-wp - My Tiny Ideas&summary=赛题出的很有水平啊，第一天出去玩了一天，第二天才开始做，只做出了这么几题，看了一下firmware是个虚拟机，再多点时间应该也可以出"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://blog.rycbar.club/2020/08/28/2020-08-28-2020-%E5%BC%BA%E7%BD%91%E6%9D%AF-wp/&title=2020-强网杯-wp - My Tiny Ideas&summary=赛题出的很有水平啊，第一天出去玩了一天，第二天才开始做，只做出了这么几题，看了一下firmware是个虚拟机，再多点时间应该也可以出"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.rycbar.club/2020/08/28/2020-08-28-2020-%E5%BC%BA%E7%BD%91%E6%9D%AF-wp/&title=2020-强网杯-wp - My Tiny Ideas&summary=赛题出的很有水平啊，第一天出去玩了一天，第二天才开始做，只做出了这么几题，看了一下firmware是个虚拟机，再多点时间应该也可以出"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
          <div class="prev-next">
            
              <a class='prev' href='/2020/08/28/2020-08-28-2020-%E9%92%93%E9%B1%BC%E5%9F%8E%E6%9D%AF-wp/'>
                <p class='title'><i class="fas fa-chevron-left" aria-hidden="true"></i>2020-钓鱼城杯-wp</p>
                <p class='content'>2020-钓鱼城杯


rereg打开程序发现调用方式很奇怪，调试直接运行然后暂停通过stack trace找到输入函数，以宽字符输入然后处理成字符串，接着生成了两串数据，在这里绕了很久，总在找...</p>
              </a>
            
            
              <a class='next' href='/2020/08/28/2020-08-28-2020-%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B%E5%88%9B%E6%96%B0%E5%AE%9E%E8%B7%B5%E8%B5%9B-wp/'>
                <p class='title'>2020-信息安全竞赛创新实践赛-wp<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
                <p class='content'>这国赛出的没什么意思，re就给了两道然后被打穿了，等了一天最后放出来一道智能合约……


z3直接解方程组得到flag
target = [0x00004F17, 0x00009CF6, 0x0...</p>
              </a>
            
          </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  <article class="post white-box reveal comments shadow">
    <section class="article typo">
      <p ct><i class='fas fa-comments'></i> 评论</p>
      
      
      
      
        <section id="comments">
          <div id="gitalk-container"></div>
        </section>
      
      
      
      
    </section>
  </article>


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: '2020-强网杯-wp',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
  

  
    
    


  <section class="widget toc-wrapper shadow desktop mobile">
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%A7%E9%98%B2"><span class="toc-text">侧防</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xx-warmup-obf"><span class="toc-text">xx_warmup_obf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#imitation-game"><span class="toc-text">imitation_game</span></a></li></ol>
    </div>
  </section>


  


</aside>


  
  <footer class="clearfix">
    <br><br>
    
      
        <div class="aplayer-container">
          

  
    <meting-js
      theme='#1BCDFC'
      autoplay='false'
      volume='0.7'
      loop='all'
      order='random'
      fixed='false'
      list-max-height='340px'
      server='netease'
      type='playlist'
      id='555017395'
      list-folded='true'>
    </meting-js>
  


        </div>
      
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="/rycbar17th@gmail.com"
                class="social fas fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://github.com/schrodinger17"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://music.163.com/#/user/home?id=391265665"
                class="social fas fa-headphones-alt flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        <div class='copyright'>
        <p><a href="https://blog.rycbar.club/">Copyright © 2017-2020 rycbar</a></p>

        </div>
      
    
  </footer>

<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script>


  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>


  <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.6/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      ScrollReveal().reveal('.l_main .reveal', {
        distance: '8px',
        duration: '800',
        interval: '100',
        scale: '1'
      });
    });
  </script>


  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/BBC19066-E176-47C2-9D22-48C81EE5DF6B.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/35F12181-F0E9-45BD-B134-37E4B4A660CF.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/00E0F0ED-9F1C-407A-9AA6-545649D919F4.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/67239FBB-E15D-4F4F-8EE8-0F1C9F3C4E7C.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B951AE18-D431-417F-B3FE-A382403FF21B.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/AEB33F9D-7294-4CF1-B8C5-3020748A9D45.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/2884F904-F1F3-479E-AE27-5EBC291B63B0.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/10A0FCE5-36A1-4AD0-8CF0-019259A89E03.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/250662D4-5A21-4AAA-BB63-CD25CF97CFF1.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/298468D7-E388-44A8-8CC5-8213BDC33CED.jpeg"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('.cover') {
          $('.cover').backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        }
      });
    </script>
  



  
    
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>

  
    
<script src="https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js"></script>

  






  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
  <script type="text/javascript">
    var gitalk = new Gitalk({
      clientID: "6dbe0fb891585031b176",
      clientSecret: "4407fec5af8e37150b5a4cb82821318d91c07769",
      repo: "comments",
      owner: "schrodinger17",
      admin: "schrodinger17",
      
        id: location.pathname,      // Ensure uniqueness and length less than 50
      
      distractionFreeMode: false  // Facebook-like distraction free mode
    });
    gitalk.render('gitalk-container');
  </script>








  
<script src="/js/app.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.6.5/js/search.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script>




  
    
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
  



<!-- 复制 -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-check-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-check-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-times-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-times-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>




<!-- fancybox -->

  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("div.fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>






  <script>setLoadingBarProgress(100);</script>
</body>
</html>
